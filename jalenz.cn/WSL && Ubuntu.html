<h2>åŸæ–‡ï¼š<a href="https://jalenz.cn/wsl-and-ubuntu">WSL &amp;&amp; Ubuntu</a></h2>
<hr/>
<h2>title: "WSL &amp;&amp; Ubuntu"
date: 2023-11-29 15:17:41+08:00
tags: ["WSL", "Ubuntu"]
published: true
license: true
slug: wsl-and-ubuntu
cate: tech
cover_image: "./images/wsl-and-ubuntu.png"
canonical_url: false
description: "è™½ç„¶ Windows æ˜¯ä¸€å¨ğŸ’© ä½† WSL è¿˜æ˜¯ä¸é”™çš„"</h2>
<h1>WSL</h1>
<p>é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿ</p>
<p>é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿå¯è®©å¼€å‘äººå‘˜æŒ‰åŸæ ·è¿è¡Œ GNU/Linux ç¯å¢ƒ - åŒ…æ‹¬å¤§å¤šæ•°å‘½ä»¤è¡Œå·¥å…·ã€å®ç”¨å·¥å…·å’Œåº”ç”¨ç¨‹åº - ä¸”ä¸ä¼šäº§ç”Ÿä¼ ç»Ÿè™šæ‹Ÿæœºæˆ–åŒå¯åŠ¨è®¾ç½®å¼€é”€ã€‚</p>
<p>è¯´äººè¯ï¼šé€šè¿‡ WSL æˆ‘ä»¬å¯ä»¥åœ¨ Windows ä½¿ç”¨å®Œæ•´çš„ Linux ç³»ç»Ÿ</p>
<blockquote>
<p><a href="https://learn.microsoft.com/zh-cn/windows/wsl/about">ä»€ä¹ˆæ˜¯é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿï¼Ÿ</a></p>
</blockquote>
<h2>WSL and WSL2</h2>
<p>WSL 2 æ˜¯é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿä½“ç³»ç»“æ„çš„ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œå®ƒæ”¯æŒé€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿåœ¨ Windows ä¸Šè¿è¡Œ ELF64 Linux äºŒè¿›åˆ¶æ–‡ä»¶ã€‚å®ƒçš„ä¸»è¦ç›®æ ‡æ˜¯æé«˜æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½ï¼Œä»¥åŠæ·»åŠ å®Œå…¨çš„ç³»ç»Ÿè°ƒç”¨å…¼å®¹æ€§ã€‚</p>
<p>| åŠŸèƒ½                                | WSL 1 | WSL 2 |
| --------------------------------- | ----- | ----- |
| Windows å’Œ Linux ä¹‹é—´çš„é›†æˆ             | âœ…     | âœ…     |
| å¯åŠ¨æ—¶é—´çŸ­                             | âœ…     | âœ…     |
| ä¸ä¼ ç»Ÿè™šæ‹Ÿæœºç›¸æ¯”ï¼Œå ç”¨çš„èµ„æºé‡å°‘                  | âœ…     | âœ…     |
| å¯ä»¥ä¸å½“å‰ç‰ˆæœ¬çš„ VMware å’Œ VirtualBox ä¸€èµ·è¿è¡Œ | âœ…     | âœ…     |
| æ‰˜ç®¡ VM                             | âŒ     | âœ…     |
| å®Œæ•´çš„ Linux å†…æ ¸                      | âŒ     | âœ…     |
| å®Œå…¨çš„ç³»ç»Ÿè°ƒç”¨å…¼å®¹æ€§                        | âŒ     | âœ…     |
| è·¨ OS æ–‡ä»¶ç³»ç»Ÿçš„æ€§èƒ½                      | âœ…     | âŒ     |
| systemd æ”¯æŒ                        | âŒ     | âœ…     |
| IPv6 æ”¯æŒ                           | âŒ     | âœ…     |</p>
<blockquote>
<p>è¯¦è§ <a href="https://learn.microsoft.com/zh-cn/windows/wsl/compare-versions">æ¯”è¾ƒ WSL ç‰ˆæœ¬</a></p>
</blockquote>
<h2>WSL 2 çš„å®‰è£…</h2>
<p>ä»¥ Ubuntu 22.04 ä¸ºä¾‹</p>
<h3>å¼€å¯ Windows é™„åŠ åŠŸèƒ½ã€Œé€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿã€</h3>
<p>ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€ PowerShell ç»ˆç«¯å¹¶è¿è¡Œ</p>
<pre><code class="language-powershell">Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux
</code></pre>
<p>é‡å¯ç”µè„‘</p>
<h3>å®‰è£… Ubuntu 22.04</h3>
<h4>é€šè¿‡å¾®è½¯å•†åº—å®‰è£…</h4>
<p>å¾®è½¯å®˜æ–¹æ”¯æŒçš„ WSL Linux å‘è¡Œç‰ˆå¯ä»¥ç›´æ¥ä»å¾®è½¯å•†åº—ä¸‹è½½</p>
<p>æŸ¥çœ‹å¯é€šè¿‡åœ¨çº¿å•†åº—è·å¾—çš„ Linux å‘è¡Œç‰ˆåˆ—è¡¨</p>
<pre><code class="language-powershell">wsl --list --online
</code></pre>
<p>å¯ä»¥ç›´æ¥åœ¨ å¾®è½¯å•†åº— ä¸­æœç´¢å¯¹åº”å‘è¡Œç‰ˆè¿›è¡Œå®‰è£…</p>
<p>&lt;!-- ![]() --&gt;</p>
<p>ä¹Ÿå¯ä»¥åœ¨é€šè¿‡å‘½ä»¤è¡Œå®‰è£…æŒ‡å®šç‰ˆæœ¬ï¼ˆé»˜è®¤å®‰è£… Ubuntuï¼‰</p>
<pre><code class="language-powershell">wsl --install
</code></pre>
<p>å¦‚éœ€æŒ‡å®šå‘è¡Œç‰ˆæœ¬</p>
<pre><code class="language-powershell">wsl --install -d Ubuntu-22.04
</code></pre>
<h4>é€šè¿‡è”æœºæ¸ é“å®‰è£…</h4>
<p>ä½¿ç”¨ <code>--web-download</code> é€šè¿‡è”æœºæ¸ é“å®‰è£…ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ Microsoft Store å®‰è£…</p>
<pre><code class="language-powershell">wsl --install -d Ubuntu-22.04 --web-download
</code></pre>
<p>~~éƒ½æ˜¯å¾®è½¯å®¶çš„æœåŠ¡å™¨ï¼Œä¸‹è½½é€Ÿåº¦éƒ½æ˜¯ä¸€å¨~~</p>
<p>&lt;!-- ![]() --&gt;</p>
<p>æˆåŠŸå®‰è£…ä¹‹åï¼Œå¼€å§‹èœå•ä¸­åº”è¯¥å·²ç»å‡ºç°äº† Ubuntu çš„å›¾æ ‡ï¼Œç‚¹å‡»æ‰“å¼€è¿›è¡Œåˆå§‹åŒ–</p>
<h3>å°† WSL ç‰ˆæœ¬è®¾ç½®ä¸º 2</h3>
<p>å¦‚æœæ˜¯å¾®è½¯å•†åº—å®‰è£…çš„ Ubuntuï¼Œé»˜è®¤æ˜¯ WSL 2ï¼Œä¸éœ€è¦æ‰‹åŠ¨è®¾ç½®</p>
<p>å¯ä»¥é€šè¿‡åœ¨ PowerShell ä¸­è¾“å…¥ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„ WSL ç‰ˆæœ¬</p>
<pre><code class="language-powershell">wsl --list --verbose
</code></pre>
<p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°†å‘è¡Œç‰ˆè®¾ç½®ä¸º WSL 2 æ”¯æŒï¼Œ<code>&lt;Distro&gt;</code>Â ä¸º Linux å‘è¡Œç‰ˆåç§°</p>
<pre><code class="language-powershell">wsl --set-version &lt;Distro&gt; 2
</code></pre>
<p>ä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è®¾ç½®é»˜è®¤ WSL ç‰ˆæœ¬</p>
<p>å¯¹äºå®‰è£…æ–°çš„ Linux å‘è¡Œç‰ˆï¼Œé»˜è®¤ä½¿ç”¨ WSL 2</p>
<pre><code class="language-powershell">wsl --set-default-version 2
</code></pre>
<h2>WLS ä»£ç†é…ç½®</h2>
<p>WSL 2.0 æ”¯æŒå’Œ Windows ä½¿ç”¨ç›¸åŒçš„ç½‘ç»œï¼Œåªéœ€è¦åœ¨ <code>%userprofile%\.wslconfig</code> ä¸­è®¾ç½®ï¼ˆæ²¡æœ‰çš„è¯æ–°å»ºä¸€ä¸ªï¼Œ<code>%userprofile%</code> æ˜¯ <code>C:\User\ç”¨æˆ·å</code>ï¼‰</p>
<pre><code class="language-sh">[experimental]
networkingMode=mirrored
dnsTunneling=true
firewall=true
autoProxy=true
</code></pre>
<blockquote>
<p>WSL 2.0 ä»¥å‰ç‰ˆæœ¬å‚è€ƒ <a href="https://cat.ms/wsl2-network-tricks">WSL2 çš„ä¸€äº›ç½‘ç»œè®¿é—®é—®é¢˜ - é‡å£° (cat.ms)</a></p>
</blockquote>
<h2>ç»ˆç«¯</h2>
<p>æ¨è Windows Terminalï¼Œå¾®è½¯åœ¨ 2019 å¹´å‘å¸ƒçš„æ–°ä¸€ä»£ Windows ç»ˆç«¯å·¥å…·ï¼Œå¥½çœ‹å¥½ç”¨è¿˜èƒ½ç›´æ¥è¯†åˆ«æœ¬æœºå®‰è£…çš„å…¨éƒ¨ WSL ç¯å¢ƒ</p>
<p>&lt;!-- ![]() --&gt;</p>
<p>Windows 11 åº”è¯¥é»˜è®¤å®‰è£…ï¼Œå¦‚æœæ²¡æœ‰ä¹Ÿå¯ä»¥é€šè¿‡å¾®è½¯å•†åº—å®‰è£…</p>
<h2>APT æ¢æº</h2>
<p>å¤‡ä»½æºæ–‡ä»¶</p>
<pre><code class="language-bash">sudo cp /etc/apt/sources.list /etc/apt/sources.list.bac
</code></pre>
<p>ä¿®æ”¹ <code>/etc/apt/sources.list</code> ä¸ºä»¥ä¸‹å†…å®¹ï¼ˆ22.04 ç‰ˆæœ¬ï¼‰</p>
<pre><code class="language-sh"># é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse

deb http://security.ubuntu.com/ubuntu/ jammy-security main restricted universe multiverse
# deb-src http://security.ubuntu.com/ubuntu/ jammy-security main restricted universe multiverse

# é¢„å‘å¸ƒè½¯ä»¶æºï¼Œä¸å»ºè®®å¯ç”¨
# deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-proposed main restricted universe multiverse
# # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-proposed main restricted universe multiverse
</code></pre>
<blockquote>
<p>å…¶ä»–ç‰ˆæœ¬è¯¦è§ <a href="https://mirror.tuna.tsinghua.edu.cn/help/ubuntu/">ubuntu | é•œåƒç«™ä½¿ç”¨å¸®åŠ© | æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™</a></p>
</blockquote>
<p>æ›´æ–° apt ç¼“å­˜</p>
<pre><code class="language-bash">sudo apt update
</code></pre>
<h2>zsh</h2>
<p>Ubuntu é»˜è®¤ shell ç¯å¢ƒ <code>bash</code> æä¾›äº†åŸºç¡€çš„å‘½ä»¤è¡Œäº¤äº’åŠŸèƒ½ï¼Œè¿™è¾¹éå¸¸æ¨è <code>zsh</code>ï¼Œæœ‰ä¸°å¯Œçš„æ’ä»¶å’Œä¸»é¢˜ ~~ï¼ˆå¥½çœ‹æ˜¯ç¬¬ä¸€ç”Ÿäº§åŠ›ï¼‰~~</p>
<p>å®‰è£…Â <code>zsh</code></p>
<pre><code class="language-bash">sudo apt install zsh
</code></pre>
<p>å®‰è£…Â <a href="https://ohmyz.sh/">oh-my-zsh</a>ï¼Œ<code>zsh</code>Â é…ç½®ç®¡ç†å·¥å…·ï¼š</p>
<pre><code class="language-bash">sh -c "$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
</code></pre>
<p>å¦‚æœå®‰è£… <code>oh-my-zsh</code> æ—¶æ²¡æœ‰å°† <code>zsh</code> è®¾ä¸ºé»˜è®¤ shell ç¯å¢ƒï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤</p>
<pre><code class="language-bash">chsh -s $(which zsh)
</code></pre>
<p>&lt;!-- ![]() --&gt;</p>
<h3>æ’ä»¶</h3>
<blockquote>
<p>ä¿®æ”¹ <code>.zshrc</code> ä¹‹åè®°å¾— <code>source ~/.zshrc</code></p>
</blockquote>
<h4>zsh-autosuggestions</h4>
<p>æ ¹æ®å†å²è®°å½•å’Œå®Œæˆæƒ…å†µåœ¨è¾“å…¥æ—¶æç¤ºå‘½ä»¤ï¼Œéå¸¸éå¸¸å¥½ç”¨ï¼</p>
<pre><code class="language-bash">git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions
</code></pre>
<p>åœ¨ <code>~/.zshrc</code> ä¸­æ·»åŠ </p>
<pre><code class="language-bash">plugins=( 
    # other plugins...
    zsh-autosuggestions
)
</code></pre>
<h4>zsh-syntax-highlighting</h4>
<p>ä¸º <code>zsh</code> å‘½ä»¤æä¾›é«˜äº®</p>
<pre><code class="language-sh">git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting
</code></pre>
<p>åœ¨ <code>~/.zshrc</code> ä¸­æ·»åŠ </p>
<pre><code class="language-bash">plugins=( 
    # other plugins...
    zsh-syntax-highlighting
)
</code></pre>
<h4>autojump</h4>
<p><a href="https://github.com/wting/autojump">autojump</a> - å¿«é€Ÿè·³è½¬ä¸åŒçš„ç›®å½•ã€è·¯å¾„ã€æ–‡ä»¶å¤¹</p>
<p>å°† <code>python</code> æŒ‡å‘ <code>pyhton3</code></p>
<pre><code class="language-sh">sudo ln -s /usr/bin/python3 /usr/bin/python
</code></pre>
<p>å®‰è£…</p>
<pre><code class="language-bash">git clone https://github.com/wting/autojump.git
cd autojump
./install.py
</code></pre>
<p>åœ¨ <code>~/.zshrc</code> ä¸­æ·»åŠ ï¼ˆ<code>${username}</code> æ›¿æ¢ä¸ºä½ çš„ç”¨æˆ·åï¼‰</p>
<pre><code class="language-sh">[[ -s /home/${username}/.autojump/etc/profile.d/autojump.sh ]] &amp;&amp; source /home/${username}/.autojump/etc/profile.d/autojump.sh

autoload -U compinit &amp;&amp; compinit -u
</code></pre>
<h4>fzf</h4>
<p><a href="https://github.com/junegunn/fzf">fzf</a> æ˜¯ä¸€ä¸ªé€šç”¨çš„å‘½ä»¤è¡Œæ¨¡ç³ŠæŸ¥æ‰¾å™¨</p>
<pre><code class="language-sh">sudo apt install fzf bat
</code></pre>
<p>åœ¨ <code>.zshrc</code> ä¸­æ·»åŠ </p>
<pre><code class="language-sh">source /usr/share/doc/fzf/examples/key-bindings.zsh
source /usr/share/doc/fzf/examples/completion.zsh
# Preview file content using bat (https://github.com/sharkdp/bat)
export FZF_CTRL_T_OPTS="
  --preview 'batcat -n --color=always {}'
    --bind 'ctrl-/:change-preview-window(down|hidden|)'"
</code></pre>
<ul>
<li><code>CTRL+T</code> - å°†é€‰å®šçš„æ–‡ä»¶å’Œç›®å½•ç²˜è´´åˆ°å‘½ä»¤è¡Œä¸Š</li>
<li><code>CTRL+R</code> - å°†å†å²è®°å½•ä¸­é€‰å®šçš„å‘½ä»¤ç²˜è´´åˆ°å‘½ä»¤è¡Œä¸Š</li>
<li><code>ALT+C</code> - è¿›å…¥é€‰å®šçš„ç›®å½•</li>
</ul>
<p>è¿˜å¯ä»¥åœ¨ <code>cd **</code> ä¹‹åæŒ‰ <code>tab</code> æ¨¡ç³Šæœç´¢æ–‡ä»¶å¤¹</p>
<h4>thefuck</h4>
<p><a href="https://github.com/nvbn/thefuck">The Fuck</a> æ˜¯ä¸€æ¬¾å‡ºè‰²çš„åº”ç”¨ç¨‹åºï¼Œå¯ä»¥çº æ­£ä¹‹å‰æ§åˆ¶å°å‘½ä»¤ä¸­çš„é”™è¯¯</p>
<pre><code class="language-sh">sudo apt update
sudo apt install python3-dev python3-pip python3-setuptools
pip3 install thefuck --user
</code></pre>
<p>åœ¨ <code>.zshrc</code> ä¸­æ·»åŠ </p>
<pre><code class="language-sh">export PATH="$PATH:$HOME/.local/bin"
eval $(thefuck --alias FUCK)
</code></pre>
<p>ç°åœ¨ï¼Œä½ è¾“å‘½ä»¤ä¹‹åå°±å¯ä»¥è¾“å…¥ <code>fuck</code> æ¥è‡ªåŠ¨çº é”™äº†ï¼Œå¦‚æœä½ è¿˜æƒ³åœ¨è¾“é”™å‘½ä»¤ä¹‹åé€šè¿‡åŒå‡» <code>ESC</code> æ¥çº é”™ï¼Œå¯ä»¥åœ¨ <code>.zshrc</code> ä¸­æ·»åŠ </p>
<pre><code class="language-sh">plugins=( 
    # other plugins...
    thefuck
)

</code></pre>
<h3>ä¸»é¢˜</h3>
<p><code>oh-my-zsh</code> æä¾›äº†éå¸¸å¤šæ¼‚äº®çš„ä¸»é¢˜</p>
<p><a href="https://github.com/ohmyzsh/ohmyzsh/wiki/Themes">Themes Â· ohmyzsh/ohmyzsh Wiki (github.com)</a></p>
<p>å¯ä»¥ç›´æ¥åœ¨ <code>~/.zshrc</code> æ–‡ä»¶ä¸­ä¿®æ”¹ï¼ˆ<code>${theme-name}</code> æ›¿æ¢ä¸ºä¸Šé¢é“¾æ¥ä¸­çš„ä¸»é¢˜åï¼‰</p>
<pre><code class="language-bashag-0-1hgd329akag-1-1hgd329ak">ZSH_THEME="${theme-name}"
</code></pre>
<h5>Starship</h5>
<p><code>oh-my-zsh</code> æä¾›çš„ä¸»é¢˜æŒºå¤šçš„ï¼Œä¸è¿‡æˆ‘é€‰æ‹©æ›´å¥½çœ‹çš„ <a href="https://starship.rs/">Starship: Cross-Shell Prompt</a></p>
<p>å®‰è£…</p>
<pre><code class="language-bash">curl -sS https://starship.rs/install.sh | sh
</code></pre>
<p>åœ¨ <code>~/.zshrc</code> æœ«å°¾æ·»åŠ </p>
<pre><code class="language-bash">eval "$(starship init zsh)"
</code></pre>
<h2>fcitx5</h2>
<p>å®‰è£… fcitx5 å’Œ ä¸­æ–‡è¾“å…¥æ³•å¼•æ“</p>
<pre><code class="language-bash">sudo apt install fcitx5 fcitx5-chinese-addons
</code></pre>
<p><code>è®¾ç½® &gt; åŒºåŸŸä¸è¯­è¨€ &gt; ç®¡ç†å·²å®‰è£…çš„è¯­è¨€ &gt; é”®ç›˜è¾“å…¥æ³•ç³»ç»Ÿ</code> è®¾ç½®ä¸º fcitx5</p>
<p>è®¾ç½® fcitx5 å¼€æœºè‡ªå¯åŠ¨ï¼Œå¯ä»¥åœ¨ gnome-tweaksï¼ˆä¸­æ–‡å ä¼˜åŒ–ï¼‰ä¸­ç›´æ¥å°† Fcitx 5 æ·»åŠ åˆ°ã€Œå¼€æœºå¯åŠ¨ç¨‹åºã€åˆ—è¡¨ä¸­</p>
<pre><code class="language-bash">sudo apt install gnome-tweaks
</code></pre>
<h2>ROS</h2>
<p>äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨å°é±¼çš„ä¸€é”®å®‰è£…</p>
<pre><code class="language-bash">wget http://fishros.com/install -O fishros &amp;&amp; sh ./fishros
</code></pre>
<p>å°é±¼çš„ä¸€é”®å®‰è£…è¿˜å¯ä»¥å¹²æŒºå¤šå…¶ä»–äº‹æƒ…çš„ï¼Œå…·ä½“è¯·çœ‹ <a href="https://fishros.org.cn/forum/topic/20/%E5%B0%8F%E9%B1%BC%E7%9A%84%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85%E7%B3%BB%E5%88%97?lang=zh-CN">å°é±¼çš„ä¸€é”®å®‰è£…ç³»åˆ—</a></p>
<hr/>
<blockquote>
<p>æˆ‘çš„é…ç½®æ–‡ä»¶ <a href="https://github.com/jalenzz/dotfiles">jalenzz/dotfiles</a></p>
</blockquote>
