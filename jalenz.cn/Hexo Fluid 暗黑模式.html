<h2>åŸæ–‡ï¼š<a href="https://jalenz.cn/hexo-dark-mode">Hexo Fluid æš—é»‘æ¨¡å¼</a></h2>
<hr/>
<h2>title: "Hexo Fluid æš—é»‘æ¨¡å¼"
date: 2020-04-02
published: true
license: true
slug: hexo-dark-mode
tags: ['DarkMode', 'Hexo']
cate: tech
cover_image: "./images/hexo-dark-mode.png"
canonical_url: false
description: "é€‚ç”¨äº Hexo çš„æš—é»‘æ¨¡å¼ï¼Œæ¨èåœ¨ä¸»é¢˜æ²¡æœ‰æš—è‰²æ¨¡å¼çš„æƒ…å†µä¸‹ä½¿ç”¨"</h2>
<p>:::warning ğŸš¨
<a href="https://github.com/fluid-dev/hexo-theme-fluid/releases/tag/v1.8.2">Fluid v1.8.2</a> å·²å®˜æ–¹æ”¯æŒæš—é»‘æ¨¡å¼
:::</p>
<p>å¤§æ¦‚èŠ±äº†ä¸€ä¸ªæ™šä¸Šææš—é»‘æ¨¡å¼ï¼Œä¹‹åå‡ å¤©é™†ç»­ä¼˜åŒ–äº†ä¸‹
ç›®å‰åšå®¢å·²ç»åŸºæœ¬ä¸Šé€‚é…å®Œæˆäº†
ç›®å‰æ˜¯ä¸‰ç§æ–¹æ¡ˆï¼ˆä¼˜å…ˆçº§é€’å‡ï¼‰</p>
<ol>
<li>åª’ä½“æŸ¥è¯¢</li>
<li>å®šæ—¶å¼€å¯</li>
<li>localStorage/sessionStorage æŸ¥è¯¢</li>
</ol>
<p>&lt;!--more--&gt;</p>
<p><code>åª’ä½“æŸ¥è¯¢</code>ï¼Œåˆ¤æ–­ç³»ç»Ÿæ˜¯å¦å¤„äºæš—é»‘æ¨¡å¼ï¼Œæ”¯æŒå¤§éƒ¨åˆ†ç³»ç»Ÿ
Win10 éœ€è¦æµè§ˆå™¨å¼€å¯æ·±è‰²æ¨¡å¼
Android åŒç†ï¼Œéœ€è¦æµè§ˆå™¨æ”¯æŒæ‰‹æœºå¼€å¯å¤œé—´æ¨¡å¼çš„æ—¶å€™å°†è‡ªèº«åˆ‡æ¢åˆ°ç¥è‰²æ¨¡å¼ï¼Œç›®å‰ Chrome æ”¯æŒï¼ŒEdge ä¸æ”¯æŒï¼Œå…¶ä»–æ²¡æµ‹
iOSã€MacOS ä¸Šçš„ Safari ä¹Ÿæ”¯æŒ</p>
<p><code>å®šæ—¶å¼€å¯</code>ï¼Œåœ¨è§„å®šæ—¶é—´è‡ªåŠ¨å¼€å¯ï¼Œå¦‚æœåœ¨è¯¥æ—¶é—´æ®µå†…å–æ¶ˆäº†æš—é»‘æ¨¡å¼ï¼Œèƒ½ä¸€ç›´ä¿æŒ</p>
<p><code>localStorage/sessionStorage æŸ¥è¯¢</code>ï¼Œèƒ½ä¸€ç›´ä¿æŒæŸä¸€ä¸ªæ¨¡å¼çš„ä¾èµ–</p>
<h3>HTML</h3>
<p>åœ¨ <code>\themes\fluid\layout\layout.ejs</code> ä¸­æ‰¾åˆ° <code>&lt;body&gt;</code>ï¼Œåœ¨å…¶ä¹‹ååŠ å…¥å¦‚ä¸‹ä»£ç </p>
<pre><code class="language-html">&lt;div id="dark" onclick="switchDarkMode()"&gt;&lt;/div&gt;
&lt;script&gt;
  var isNight = new Date().getHours() &gt;= 22 || new Date().getHours() &lt; 7;
  if( matchMedia('(prefers-color-scheme: dark)').matches || isNight || localStorage.getItem('dark') === '1') {
    if(!(isNight&amp;&amp;localStorage.getItem('noDark') === '1')) {
      document.body.classList.add('dark');
    }
  }
  document.getElementById('dark').innerHTML = document.querySelector("body").classList.contains("dark")?"ğŸŒ™":"ğŸŒ";
&lt;/script&gt;
</code></pre>
<p>:::warning æ³¨æ„
ä¸€å®šç´§è·Ÿåœ¨ <code>body</code> æ ‡ç­¾ä¹‹åï¼Œå¦åˆ™ä¼šå‡ºç°é—ªçƒ
:::</p>
<h3>JS</h3>
<p>ç„¶åéšä¾¿æ‰¾ä¸ª JS æŠŠä¸‹é¢ä»£ç åŠ è¿›å»ï¼Œç›´æ¥åŠ åˆ° <code>&lt;/body&gt;</code> ä¹‹å‰ä¹Ÿè¡Œ</p>
<pre><code class="language-js">//ç‚¹å‡»äº‹ä»¶
function switchDarkMode() {
  if ($('body').hasClass('dark')) {
    $("#dark").html("ğŸŒ");
    document.body.classList.remove('dark');
    localStorage.setItem('noDark', '1');
    localStorage.setItem('dark', '0');
  } else {
    $("#dark").html("ğŸŒ™");
    document.body.classList.add('dark');
    localStorage.setItem('dark', '1');
    localStorage.setItem('noDark', '0');
  }
}
</code></pre>
<h3>CSS</h3>
<p>åœ¨è‡ªå®šä¹‰ CSS ä¸­åŠ å…¥ä»£ç </p>
<p>:::tip
å¯ä»¥ç”¨ <code>stylus</code>ï¼Œèƒ½å°‘äº›å†™
ä½†æ˜¯å¼•å…¥æ—¶è®°å¾—åç¼€è¿˜æ˜¯ <code>.css</code> ä¸è¦å˜
:::</p>
<p>ä¸‹é¢æ˜¯æˆ‘çš„æ ·å¼ä»£ç ï¼ŒåŸºæœ¬è¦†ç›–æ‰€æœ‰å†…å®¹ï¼Œæ ¹æ®è‡ªèº«æƒ…å†µä¿®æ”¹</p>
<pre><code class="language-stylus">/* åˆ‡æ¢æŒ‰é’® */
#dark
  cursor pointer
  position fixed
  right 40px
  bottom 98px
  width 16px
  height 14px
  z-index 100
  font-size 20px

/*æš—é»‘æ¨¡å¼*/
.dark

  /* ä¸»ä½“ */
  #board
    background-color #282c34
    color #a09c9c
  
  img  
    filter brightness(50%)

  p
  .index-info a  
    color #a09c9c !important

  .markdown-body
    h1,h2,h3,h4,h5,h6,s,li  
      color:#a09c9c !important

  /* é¡¶æ  */
  .navbar-col-show
  .top-nav-collapse  
    background-color #282c34

  .navbar a
    color #a09c9c !important

  .animated-icon span   /* æ‰‹æœºç«¯ */
    background-color #a09c9c


  /* page-number */
  .pagination a:hover
  .pagination .current  
    background-color #6b6b6b73;


  /* æ‰“å­—æœº */
  #subtitle
  .dark.typed-cursor--blink
  .scroll-down-arrow
    color #dfdfdf


  /* back to top */
  #scroll-top-button
    background-color #282c34

    i
      color #a09c9c


  /* Toc */
  .tocbot-list a
    color #a09c9c

  .tocbot-active-link
  footer a:hover
    color #1abc9c !important


  /* footer */
  footer
  footer a
    color #a09c9c


  /* å½’æ¡£é¡µ */
  .list-group-item
    color #a09c9c
    background-color #282c34

  .list-group-item:hover
  .tagcloud a:hover
    background-color #46484d


  /* å‹é“¾é¡µ */
  .links
    .card  
      background-color #282c34

    .card-body:hover  
      background-color #46484d

    .link-title
    .link-intro  
      color #a09c9c


  /* noteæ ‡ç­¾ å¯èƒ½è¿™é…è‰²æœ‰ç‚¹ä¸‘ */
  .note-info
    background-color #3b5359
    border-color #006d80

  .note-danger
    background-color #783f42
    border-color #670009

  .note-success
    background-color #2a3e2e
    border-color #005915

  .note-warning
    background-color #5b543e
    border-color #846500

  .note-primary
    background-color #455a6f
    border-color #004188
</code></pre>
<h3>localStorage è¿˜æ˜¯ sessionStorage</h3>
<p>ä»”ç»†è§‚å¯Ÿåˆšåˆšçš„ js ä»£ç ï¼Œåœ¨å…¶ä¸­ç”¨çš„æ˜¯ localStorage
é™¤äº† localStorageï¼Œä½ è¿˜å¯ä»¥ç”¨ sessionStorage
ä¸¤è€…çš„åŒºåˆ«ä¹Ÿéå¸¸ç®€å•</p>
<blockquote>
<p>localStorageï¼šé™¤éè¢«æ‰‹åŠ¨æ¸…é™¤ï¼Œå¦åˆ™å°†ä¼šæ°¸ä¹…ä¿å­˜ã€‚
sessionStorageï¼š ä»…åœ¨å½“å‰ç½‘é¡µä¼šè¯ä¸‹æœ‰æ•ˆï¼Œå…³é—­é¡µé¢æˆ–æµè§ˆå™¨åå°±ä¼šè¢«æ¸…é™¤ã€‚</p>
</blockquote>
<p>ä¸¾ä¸ªç®€å•ä¾‹å­ï¼Œå¦‚æœç°åœ¨æ˜¯ç™½å¤©ï¼ˆå³æ²¡æœ‰è§¦å‘å¤œé—´è‡ªåŠ¨å¼€å¯æš—é»‘æ¨¡å¼ï¼‰
ä½ æ‰‹åŠ¨ç‚¹å‡»åˆ‡æ¢æˆäº†æš—é»‘æ¨¡å¼ï¼Œå½“ä½ å…³é—­å½“å‰ç½‘é¡µå†æ¬¡è¿›å…¥æ—¶
å¦‚æœä½ ç”¨çš„æ˜¯ localStorageï¼Œé‚£ä¹ˆæ­¤æ—¶å°±è¿˜æ˜¯æš—é»‘æ¨¡å¼
è€Œå¦‚æœä½ ç”¨çš„æ˜¯ sessionStorageï¼Œæ­¤æ—¶å°±ä¸æ˜¯æš—é»‘æ¨¡å¼äº†</p>
<p>ä¸¤è€…çš„ä½¿ç”¨æ–¹æ³•ç›¸åŒ
ç›´æ¥æ›¿æ¢å°±å¯ä»¥äº†</p>
<p>:::caution <a href="https://crosschannel.cc">track13</a> æŒ‡å‡º
sessionStorage åœ¨æ‰‹æœºæµè§ˆå™¨ä¸Šé—®é¢˜å¾ˆå¤šï¼Œä¸æ¨èä½¿ç”¨
:::</p>
<p>ä¸‹é¢æ˜¯æ”¯æŒè¯¥ç‰¹æ€§çš„æœ€ä½ç‰ˆæœ¬
<img alt="æ”¯æŒæƒ…å†µ" src="https://u.jalenz.cn/hexo-dark-mode/01.png?blog"/></p>
<p>å¯ä»¥åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­æŸ¥çœ‹ä»–ä»¬çš„å€¼
<img alt="æŸ¥çœ‹" src="https://u.jalenz.cn/hexo-dark-mode/02.png?blog"/></p>
<hr/>
<h3>å‚è€ƒ</h3>
<ol>
<li><a href="https://crosschannel.cc/daily/hexo%E6%B7%BB%E5%8A%A0%E6%9A%97%E8%89%B2%E6%A8%A1%E5%BC%8F.html">é¢å‘å°ç™½çš„Hexoæ·»åŠ æš—è‰²æ¨¡å¼æ•™ç¨‹ | å®…æ—¥è®°</a></li>
</ol>
