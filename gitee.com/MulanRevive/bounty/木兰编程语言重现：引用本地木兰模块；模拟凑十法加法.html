<h2><a href="https://gitee.com/MulanRevive/bounty/blob/master/%E8%BF%9B%E5%B1%95%E5%B0%8F%E7%BB%93/2020-08-13-%E6%9C%A8%E5%85%B0%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E9%87%8D%E7%8E%B0%EF%BC%9A%E5%BC%95%E7%94%A8%E6%9C%AC%E5%9C%B0%E6%9C%A8%E5%85%B0%E6%A8%A1%E5%9D%97%EF%BC%9B%E6%A8%A1%E6%8B%9F%E5%87%91%E5%8D%81%E6%B3%95%E5%8A%A0%E6%B3%95.markdown">仓库源文</a></h2>
<p>之前一直没重现本地包内的木兰模块引用，导致提取出的模块只能放在项目根目录下。</p>
<p>上周终于搞定。于是将上次的摆放规划应用的源码拆分成几个模块，比如<code>测试/实用/规划/点.ul</code>，在主模块中可以如此引用<code>using 点 in 测试.实用.规划.点</code>。不需要在包中放置类似<code>__init__.py</code>。</p>
<h2>其他新添功能</h2>
<h3>字符串拼接时的报错信息</h3>
<pre><code>(..•˘_˘•..) 字符串只能拼接字符串，请将"int"先用 str() 转换
见第1行：print("1" + 2)
</code></pre>
<h3>对匿名函数指定返回类型</h3>
<pre><code class="language-javascript">type 形状 {
{}
}
print(func (边长) : 形状 {
  return 形状()
}(1) != nil)
</code></pre>
<h3>查询字典中是否包含某个键</h3>
<p>之前是用<code>__contains__</code>，一直觉得不爽，现在用<code>get</code>代替，比如：<code>字集.get(字) != nil</code></p>
<h2>新实例</h2>
<p>最近看到幼儿数学启蒙时的一种“凑十法”，比如求 9+7，先把 7 拆为 1 和 6，而 9+1 = 10，最终得出 16。感觉小孩似乎不需要真正用“加法”运算。模拟解题过程如下：</p>
<pre><code class="language-javascript">拆分 = {
  2 : [[1, 1]],
  3 : [[1, 2]],
  4 : [[1, 3], [2, 2]],
  5 : [[1, 4], [2, 3]],
  6 : [[1, 5], [2, 4], [3, 3]],
  7 : [[1, 6], [2, 5], [3, 4]],
  8 : [[1, 7], [2, 6], [3, 5], [4, 4]],
  9 : [[1, 8], [2, 7], [3, 6], [4, 5]],
  10 : [[1, 9], [2, 8], [3, 7], [4, 6], [5, 5]]
}

func 取剩余(整体, 部分) {
  for 两部分 in 拆分[整体] {
    if 两部分[0] == 部分 {
      return 两部分[1]
    } elif 两部分[1] == 部分 {
      return 两部分[0]
    }
  }
}

func 凑十法求和(基数, 被拆数) {
  凑数 = 取剩余(10, 基数)
  拆得数 = 取剩余(被拆数, 凑数)
  return "1" + str(拆得数)
}

println(凑十法求和(9, 7))
</code></pre>
<p>本来可以用<code>index</code>取列表中元素所在位置，但由于尚未支持捕获异常，只得用原始搜索。</p>
<h2>代码统计</h2>
<p>下面是几个主要部分的代码行数统计，格式为：上次-&gt;现在。</p>
<ul>
<li><p>测试</p>
<ul>
<li>木兰测试用例：1590 -&gt; 1700</li>
<li><code>运行测试.py</code>，检验所有木兰测试代码片段：154 -&gt; 156</li>
<li>未变<ul>
<li><code>test语法树.py</code>，确保生成的语法树与原始版本一致：67</li>
</ul>
</li>
</ul>
</li>
<li><p>实现：2183 -&gt; 2169</p>
<ul>
<li><code>分析器/语法分析器.py</code>：944 -&gt; 881</li>
<li><code>分析器/语法树.py</code> 对 ast 库的中文封装，进行了重构简化代码：234 -&gt; 178</li>
<li><code>环境.py</code>，加载木兰模块：97 -&gt; 123</li>
<li><code>分析器/语法成分.py</code>，从语法分析器中提取出来的枚举常量：77</li>
<li><code>功用/反馈信息.py</code>：45 -&gt; 49</li>
<li>未变<ul>
<li><code>分析器/词法分析器.py</code>：190</li>
<li><code>演示高亮.py</code>：100</li>
<li><code>中.py</code>，主程序：36</li>
</ul>
</li>
</ul>
</li>
</ul>
