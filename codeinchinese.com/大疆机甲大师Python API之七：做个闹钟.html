<h2><a href="https://github.com/program-in-chinese/team_website/blob/master/_posts/2019-10-25-大疆机甲大师Python API之七：做个闹钟.markdown">仓库源文</a>，<a href="http://codeinchinese.com/2019/10/25/大疆机甲大师Python-API之七：做个闹钟.markdown">站点原文</a></h2>
<hr/>
<p>layout: post
comments: true
title:  大疆机甲大师Python API之七：做个闹钟
description: 
date:   2019-10-25 00:00:00 -0700</p>
<h2>categories: Python 机甲大师</h2>
<h3>视频演示</h3>
<p>使用了”取当前时间“API。等到10：35分就会响起熟悉的声音。
<a href="https://v.qq.com/x/page/t3018bor71r.html">大材小用：大疆机甲大师做闹钟</a></p>
<h3>例程主体</h3>
<p>由用户指定时、分之后，每20秒检查一次时间是否到了，如果是，就放《两只老虎》（放歌函数内容取自前文<a href="https://zhuanlan.zhihu.com/p/87072890">大疆机甲大师Python开发: 两只老虎</a> ）。完整源码<a href="https://github.com/program-in-chinese/robomaster-python-samples-zh/blob/master/%E5%88%86%E7%B1%BB%E4%BE%8B%E7%A8%8B%E5%BA%93/%E6%97%B6%E9%97%B4/%E9%97%B9%E9%92%9F.py">在此</a>。</p>
<pre><code class="lang-python">def start():
    闹钟时刻 = {'时': 10, '分': 35}
    # 省电
    LED灯.熄灭(常量.装甲所有)
    while True:
        当前时间 = 取当前时间()
        # 仅作演示, 并不严谨
        if 当前时间['时'] == 闹钟时刻['时'] and 当前时间['分'] == 闹钟时刻['分']:
            放歌()
            break
        时间.睡眠(20)

def 取当前时间():
    年 = 工具.取本地时间(常量.本地年)
    月 = 工具.取本地时间(常量.本地月)
    日 = 工具.取本地时间(常量.本地日)
    时 = 工具.取本地时间(常量.本地时)
    分 = 工具.取本地时间(常量.本地分)
    秒 = 工具.取本地时间(常量.本地秒)
    print(str(年) + '/' + str(月) + '/' + str(日) + ' '
        + str(时) + ':' + str(分) + ':' + str(秒))
    return {
        '年': 年,
        '月': 月,
        '日': 日,
        '时': 时,
        '分': 分,
        '秒': 秒
    }
</code></pre>
<h3>关于耗电</h3>
<p>因为看到了他人反馈电池续航时间，自己做了点测试。从入手到今天将近两周，除去周末，几乎每天至少充一次电，大概20次左右，应该电池状态算新的。</p>
<p>首先尝试了开机后不连接，处于待连接状态，35分钟后电量从100%到78%，按此预计续航160分钟，实际好像不到一点（再两小时后看已经关机了）。这个过程中所有六处LED一直在呼吸灯效。</p>
<p>接着尝试了开机连接开发环境后不操作，1分钟后进入待机模式（在“系统”选项中设置），35分钟后电量从100%到80%，按此预计175分钟。此过程中所有LED关闭，云台也无制动（自然俯头）。</p>
<p>再就是运行上面例程。关所有LED后，定时检查时间输出到控制台，没有任何其他部件的操作。粗测10分钟电量降低5%。按此预计200分钟。比较好奇为何会比上一种更省电，因为云台并不是俯头状态。</p>
<p>换言之，上面的闹钟只能最多定200分钟之内的时刻：）</p>
<p>脑洞：要是有“自运行”模式能够进入更省电的类似“休眠”模式，然后到某个时刻自唤醒后执行代码，也许跨度时间就可以久的多？</p>
