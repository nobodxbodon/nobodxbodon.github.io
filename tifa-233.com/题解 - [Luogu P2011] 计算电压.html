<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/luogu-p2011.md">仓库源文</a>，<a href="https://tifa-233.com/archives/luogu-p2011">站点原文</a></h2>
<p><a href="https://www.luogu.com.cn/problem/P2011">题目链接</a></p>
&lt;!-- more --&gt;

<h2>原始题面</h2>
<h3>题目背景</h3>
<p>相信不少人轻松灭掉 1,2 两题 (蒟蒻无视此句), 我相信, 大家对物理也是很有兴趣的 (众人: 我们对揍人也是很有兴趣的), 那么, 再奉上 100 分给 Physicaler 们</p>
<h3>题目描述</h3>
<p>现给定一个电阻网络, 已知其中每条边上的电阻, 和若干个点和负极之间的电压 (电源电压不变), 现在求任意两点之间的电压</p>
<h3>输入输出格式</h3>
<h4>输入格式</h4>
<p>第一行三个数 $n,m,k,q$, 表示 $n$ 个节点 (可能是几个点用导线相连接, 与一个点等价, 编号为 $1-n$, $0$ 号节点为电源负极), $m$ 个定值电阻, 每个定值电阻连接两个点, $k$ 表示电源正极有 $k$ 个接口, 有 $q$ 个询问</p>
<p>以下 $k$ 行, 每行两整数, 表示电源这 $k$ 个正极的编号与该接线柱与电源负极负极之间的电压 $U_i$</p>
<p>以下 $m$ 行, 每行三个数, $V_i,W_i,R_i$, 表示 $U_i$ 与 $V_i$ 之间添加一条阻值为 $R$ 的电阻丝</p>
<p>以下 $q$ 行, 每行两个整数 $A_i,B_i$, 表示要求 $A_i$ $B_i$ 之间的电压</p>
<h4>输出格式</h4>
<p>$q$ 行, 每行一个实数, 保留小数点后两位. (若 $A$ 点电压低于 $B$ 点, 输出负值)</p>
<h3>输入输出样例</h3>
<h4>输入样例 #1</h4>
<pre><code class="lang-input1">3 5 1 3
1 18
1 2 6
1 3 2
2 3 6
3 0 6
2 0 2
1 0
2 3
1 2
</code></pre>
<h4>输出样例 #1</h4>
<pre><code class="lang-output1">18.00
-6.00
12.00
</code></pre>
<h3>说明</h3>
<p>【数据范围】</p>
<p>对于 $10\%$ 的数据, $q=1$</p>
<p>对于 $20\%$ 的数据, $1\leq n\leq 10$,保证电路为串联,并联或混联</p>
<p>对于 $40\%$ 的数据, $1\leq n\leq 40,k\leq 5$</p>
<p>对于 $100\%$ 的数据, $1\leq k\leq n\leq 200,1\leq m\leq 200,000,1\leq R_i,U_i\leq 10,000,1\leq q\leq 1,000,000$</p>
<p>【限制】</p>
<p>时间限制: 2s, 内存限制: 256M</p>
<p>【注释】</p>
<p>样例如图所示</p>
<p><img alt="" src="/Users/xuanwu/work/聚聚/中文博客集锦/源数据/博客聚合/tifa-233.com/source/_posts/1.webp"/></p>
<h2>解题思路</h2>
<blockquote><p>首先 % 罗神</p>
</blockquote>
<p>显然直接用 Kirchhoff 第一定律 (KCL) 即可, 设</p>
<ul>
<li>点 $i$ 的电势为 $\varphi_i$</li>
<li>已知电势的点 (即与电源正负极直接相连的点) 的指标集为 $\Lambda$</li>
<li>电阻网络构成的图为 $G$</li>
</ul>
<p>则有</p>
<p>$$
\begin{cases}
  \varphi_i=U<em>i,&amp;i\in\Lambda\
  \displaystyle\sum</em>{\lang i,j\rang\in G}{\varphi_i-\varphi<em>j\over R</em>{ij}}=0,&amp;i\notin\Lambda
\end{cases}
$$</p>
<p>另外注意两点</p>
<ul>
<li>加电阻时候是并联, 所以不用处理重边</li>
<li>原题的部分数据点有错误 (截至笔者撰此文前), 详见 <a href="https://www.luogu.com.cn/discuss/show/180830">此处</a></li>
</ul>
<h2>复杂度</h2>
<p>$O(n^3+m+q)$</p>
<h2>代码参考</h2>
<p>{% icodeweb cpa_cpp title:Luogu_P2011 Luogu/P2011/0.cpp %}</p>
