<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/luogu-p1829.md">仓库源文</a>，<a href="https://tifa-233.com/archives/luogu-p1829">站点原文</a></h2>
<p><a href="https://www.luogu.com.cn/problem/P1829">题目链接</a></p>
&lt;!-- more --&gt;

<h2>原始题面</h2>
<h3>题目描述</h3>
<p>今天的数学课上, Crash 小朋友学习了最小公倍数 (Least Common Multiple). 对于两个正整数 $a$ 和 $b$, $\text{lcm}(a,b)$ 表示能同时整除 $a$ 和 $b$ 的最小正整数. 例如, $\text{lcm}(6, 8) = 24$</p>
<p>回到家后, Crash 还在想着课上学的东西, 为了研究最小公倍数, 他画了一张 $ n \times m$ 的表格. 每个格子里写了一个数字, 其中第 $i$ 行第 $j$ 列的那个格子里写着数为 $\text{lcm}(i, j)$</p>
<p>看着这个表格, Crash 想到了很多可以思考的问题. 不过他最想解决的问题却是一个十分简单的问题: 这个表格中所有数的和是多少. 当 $n$ 和 $m$ 很大时, Crash 就束手无策了, 因此他找到了聪明的你用程序帮他解决这个问题. 由于最终结果可能会很大, Crash 只想知道表格里所有数的和 $\bmod 20101009$ 的值</p>
<h3>输入输出格式</h3>
<h4>输入格式</h4>
<p>输入包含一行两个整数, 分别表示 $n$ 和 $m$</p>
<h4>输出格式</h4>
<p>输出一个正整数, 表示表格中所有数的和 $\bmod 20101009$ 的值</p>
<h3>输入输出样例</h3>
<h4>输入样例 #1</h4>
<pre><code class="lang-input1">4 5
</code></pre>
<h4>输出样例 #1</h4>
<pre><code class="lang-output1">122
</code></pre>
<h3>说明</h3>
<h4>样例输入输出 1 解释</h4>
<p>该表格为:</p>
<table>
<thead><tr>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$2$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center">$6$</td>
<td style="text-align:center">$4$</td>
<td style="text-align:center">$10$</td>
</tr>
<tr>
<td style="text-align:center">$3$</td>
<td style="text-align:center">$6$</td>
<td style="text-align:center">$3$</td>
<td style="text-align:center">$12$</td>
<td style="text-align:center">$15$</td>
</tr>
<tr>
<td style="text-align:center">$4$</td>
<td style="text-align:center">$4$</td>
<td style="text-align:center">$12$</td>
<td style="text-align:center">$4$</td>
<td style="text-align:center">$20$</td>
</tr>
</tbody>
</table>
<h4>数据规模与约定</h4>
<ul>
<li>对于 $30\%$ 的数据, 保证 $n, m \le 10^3$</li>
<li>对于 $70\%$ 的数据, 保证 $n, m \le 10^5$</li>
<li>对于 $100\%$ 的数据, 保证 $1\le n,m \le 10^7$</li>
</ul>
<h2>解题思路</h2>
<p>推式子, 不妨设 $n\leqslant m$</p>
<p>$$
\begin{aligned}
  \sum<em>{i=1}^n\sum</em>{j=1}^m\frac{ij}{(i,j)}&amp;=\sum<em>{d=1}^nd\sum</em>{i=1}^{\lfloor\frac{n}{d}\rfloor}\sum<em>{j=1}^{\lfloor\frac{m}{d}\rfloor}[(i,j)=1]ij\
  &amp;=\sum</em>{d=1}^nd\sum_{e=1}^{\lfloor\frac{n}{d}\rfloor}\mu(e)e^2{\lfloor\frac{n}{de}\rfloor(\lfloor\frac{n}{de}\rfloor+1)\over 2}{\lfloor\frac{m}{de}\rfloor(\lfloor\frac{m}{de}\rfloor+1)\over 2}\
\end{aligned}
$$</p>
<p>懒得继续推了, 现在已经可以两次数论分块解决了, 要是接着推就是令 $D=de$ 然后一次数论分块</p>
<h2>代码参考</h2>
<p>{% icodeweb cpa_cpp title:Luogu_P1829 Luogu/P1829/0.cpp %}</p>
