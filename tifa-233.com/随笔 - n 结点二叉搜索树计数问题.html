<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/draft-011.md">仓库源文</a>，<a href="https://tifa-233.com/archives/draft-011">站点原文</a></h2>
<hr/>
<p>title: "随笔 - n 结点二叉搜索树计数问题"
date: 2021-12-16 02:43:17
categories:</p>
<ul>
<li>随笔</li>
<li>数学
tags:</li>
<li>随笔</li>
<li>数学</li>
<li>数据结构</li>
<li>二叉树</li>
<li>二叉搜索树</li>
<li>生成函数</li>
<li>组合数学</li>
<li>Catalan数</li>
</ul>
<hr/>
<p>求 $n$ 个结点构成的二叉搜索树的形态总数</p>
&lt;!-- more --&gt;

<p>我们知道对于相同的数组 ${a_i}$, 由其构建的二叉搜索树的中序遍历结果唯一, 故本问题等价于求 $n$ 个结点构成的二叉树的形态总数</p>
<p>设 $n$ 个结点构成的二叉树的形态总数为 $f_n$, 首先 $f(0)=1$</p>
<p>当 $n&gt;0$ 时, 不难得出如下结论</p>
<p>$$
f<em>n=\sum</em>{i=0}^{n-1}f<em>if</em>{n-i-1}
$$</p>
<p>即枚举左子树的结点个数递推即可</p>
<p>接下来我们计算 $f_n$ 的通项公式</p>
<p>设序列 ${f_n}$ 的生成函数为 $F(x)$, 则</p>
<p>$$
\begin{aligned}
    F(x)&amp;=\sum_{n=0}^{\infty}f<em>nx^n\
    &amp;=1+\sum</em>{n=1}^{\infty}\sum_{i=0}^{n-1}f<em>if</em>{n-i-1}x^n\
    &amp;=1+x\left(\sum_{i=0}^{\infty}f<em>ix^i\right)\left(\sum</em>{n=0}^{\infty}f_nx^n\right)\
    &amp;=1+xF^2(x)
\end{aligned}\tag{1}
$$</p>
<p>从而得到</p>
<p>$$
\begin{aligned}
    F(x)={1\pm\sqrt{1-4x}\over 2x}={2\over 1\mp\sqrt{1-4x}}
\end{aligned}\tag{2}
$$</p>
<p>考虑 $F(0)$, 一方面, $F(0)=f_0=1$, 另一方面, 当且仅当</p>
<p>$$
F(x)={2\over 1+\sqrt{1-4x}}
$$</p>
<p>时, $F(x)$ 在 $x=0$ 处收敛, 因此</p>
<p>$$
F(x)={2\over 1+\sqrt{1-4x}}={1-\sqrt{1-4x}\over 2x}\tag{3}
$$</p>
<p>即为 ${f_n}$ 生成函数的封闭形式</p>
<p>接下来我们求其展开形式. 首先我们有</p>
<p>$$
\begin{aligned}
    (1-4x)^{1\over 2}&amp;=\sum<em>{n=0}^{\infty}{ {1\over 2}\choose n}(-4x)^n\
    &amp;=1+\sum</em>{n=1}^{\infty}(-1)^{n-1}{(2n-3)!!\over 2^nn!}(-4x)^n\
    &amp;=1-2\sum_{n=1}^{\infty}{(2n-2)!\over n!(n-1)!}x^n
\end{aligned}\tag{4}
$$</p>
<p>将 $(4)$ 式代入 $(3)$ 式, 有</p>
<p>$$
\begin{aligned}
    F(x)&amp;={1-\sqrt{1-4x}\over 2x}\
    &amp;=\sum<em>{n=1}^{\infty}{(2n-2)!\over n!(n-1)!}x^{n-1}\
    &amp;=\sum</em>{n=0}^{\infty}{(2n)!\over n!(n+1)!}x^n
\end{aligned}\tag{5}
$$</p>
<p>故</p>
<p>$$
f_n={(2n)!\over n!(n+1)!}={ {2n\choose n}\over n+1}\tag{6}
$$</p>
<p>即为所求. 本数列为 Catalan 数列</p>
