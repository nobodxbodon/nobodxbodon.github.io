<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/luogu-p3200.md">仓库源文</a>，<a href="https://tifa-233.com/archives/luogu-p3200">站点原文</a></h2>
<hr/>
<p>title: "题解 - [Luogu P3200] [HNOI2009] 有趣的数列"
categories:</p>
<ul>
<li>算法竞赛</li>
<li>题解
tags:</li>
<li>算法竞赛</li>
<li>题解</li>
<li>洛谷</li>
<li>省选</li>
<li>HNOI</li>
<li>递推</li>
<li>数学</li>
<li>数论</li>
<li>素数/质数</li>
<li>筛法</li>
<li>Euler筛</li>
<li>组合数学</li>
<li>Catalan数
date: 2021-11-03 17:56:45</li>
</ul>
<hr/>
<p><a href="https://www.luogu.com.cn/problem/P3200">题目链接</a></p>
&lt;!-- more --&gt;

<h2>原始题面</h2>
<h3>题目描述</h3>
<p>我们称一个长度为 $2n$ 的数列是有趣的, 当且仅当该数列满足以下三个条件:</p>
<ul>
<li>它是从 $1 \sim 2n$ 共 $2n$ 个整数的一个排列 ${a<em>n}</em>{n=1}^{2n}$;</li>
<li>所有的奇数项满足 $a_1&lt;a<em>3&lt; \dots &lt; a</em>{2n-1}$, 所有的偶数项满足 $a_2&lt;a<em>4&lt; \dots &lt;a</em>{2n}$;</li>
<li>任意相邻的两项 $a<em>{2i-1}$ 与 $a</em>{2i}$ 满足: $a<em>{2i-1}&lt;a</em>{2i}$</li>
</ul>
<p>对于给定的 $n$, 请求出有多少个不同的长度为 $2n$ 的有趣的数列. 因为最后的答案可能很大, 所以只要求输出答案对 $p$ 取模</p>
<h3>输入输出格式</h3>
<h4>输入格式</h4>
<p>一行两个正整数 $n,p$</p>
<h4>输出格式</h4>
<p>输出一行一个整数表示答案</p>
<h3>输入输出样例</h3>
<h4>输入样例 #1</h4>
<pre><code class="lang-input1">3 10
</code></pre>
<h4>输出样例 #1</h4>
<pre><code class="lang-output1">5
</code></pre>
<h3>说明</h3>
<p>【数据范围】</p>
<p>对于 $50\%$ 的数据, $1\le n \le 1000$;</p>
<p>对于 $100\%$ 的数据, $1\le n \le 10^6$, $1\le p \le 10^9$</p>
<p>【样例解释】</p>
<p>对应的 5 个有趣的数列分别为 (1,2,3,4,5,6), (1,2,3,5,4,6), (1,3,2,4,5,6), (1,3,2,5,4,6), (1,4,2,5,3,6)</p>
<h2>题意简述</h2>
<p>求</p>
<p>$$
H_{n-1}\bmod p={ \binom{2n}{n}\over n+1}\bmod p
$$</p>
<h2>解题思路</h2>
<p>首先筛出所有素数, 然后计算答案唯一分解式的各个幂次即可</p>
<p>注意到 $(ab)^c=a^cb^c$, 故这些幂次可以逆序线性递推得到</p>
<h2>复杂度</h2>
<p>$O(n)$</p>
<h2>代码参考</h2>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:Luogu_P3200 Luogu/P3200/0.cpp %}

&lt;/details&gt;