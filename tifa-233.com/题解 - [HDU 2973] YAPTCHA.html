<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/hdu-2973.md">仓库源文</a>，<a href="https://tifa-233.com/archives/hdu-2973">站点原文</a></h2>
<p><a href="https://vjudge.net/problem/HDU-2973/origin">题目链接</a></p>
&lt;!-- more --&gt;

<h2>题意简述</h2>
<p>给定 $n$, 计算</p>
<p>$$
\sum_{k=1}^n\left\lfloor\frac{(3k+6)!+1}{3k+7}-\left\lfloor\frac{(3k+6)!}{3k+7}\right\rfloor\right\rfloor
$$</p>
<h2>解题思路</h2>
<ul>
<li><p>若 $3k+7$ 是质数, 则由 Wilson 定理可知</p>
<p>$$
(3k+6)!\equiv-1\pmod{3k+7}
$$</p>
<p>设 $(3k+6)!+1=k(3k+7)$</p>
<p>则</p>
<p>$$
\left\lfloor\frac{(3k+6)!+1}{3k+7}-\left\lfloor\frac{(3k+6)!}{3k+7}\right\rfloor\right\rfloor=\left\lfloor k-\left\lfloor k-\frac{1}{3k+7}\right\rfloor\right\rfloor=1
$$</p>
</li>
<li><p>若 $3k+7$ 不是质数,则有 $(3k+7)\mid(3k+6)!$, 即</p>
<p>$$
(3k+6)!\equiv 0\pmod{3k+7}
$$</p>
<p>设 $(3k+6)!=k(3k+7)$</p>
<p>则</p>
<p>$$
\left\lfloor\frac{(3k+6)!+1}{3k+7}-\left\lfloor\frac{(3k+6)!}{3k+7}\right\rfloor\right\rfloor=\left\lfloor k+\frac{1}{3k+7}-k\right\rfloor=0
$$</p>
</li>
</ul>
<p>因此</p>
<p>$$
\sum<em>{k=1}^n\left\lfloor\frac{(3k+6)!+1}{3k+7}-\left\lfloor\frac{(3k+6)!}{3k+7}\right\rfloor\right\rfloor=\sum</em>{k=1}^n[3k+7\in\text{Prime}^+]
$$</p>
<h2>代码</h2>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:HDU_2973 HDU/2973/0.cpp %}

&lt;/details&gt;