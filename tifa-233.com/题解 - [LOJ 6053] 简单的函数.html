<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/loj-6053.md">仓库源文</a>，<a href="https://tifa-233.com/archives/loj-6053">站点原文</a></h2>
<hr/>
<p>title: "题解 - [LOJ 6053] 简单的函数"
categories:</p>
<ul>
<li>算法竞赛</li>
<li>题解
tags:</li>
<li>算法竞赛</li>
<li>题解</li>
<li>LibreOJ</li>
<li>数学</li>
<li>数论</li>
<li>素数/质数</li>
<li>筛法</li>
<li>杜教筛</li>
<li>Powerful number筛</li>
<li>Euler函数
date: 2021-04-27 22:52:08</li>
</ul>
<hr/>
<p><a href="https://loj.ac/p/6053">题目链接</a></p>
&lt;!-- more --&gt;

<h2>题意简述</h2>
<p>求积性函数 $f$ 的前缀和, 其中 $f(p^q)=p\oplus q,~p\in\text{Prime}^+$</p>
<h2>解题思路</h2>
<p>不难发现</p>
<p>$$
f(p)=p+(-1)^{[p\ne2]},~\forall p\in\text{Prime}^+
$$</p>
<p>我们令</p>
<p>$$
g(n)=\varphi(n)
$$</p>
<p>注意到 $f(2)\ne g(2)$, 但 $f(p)=g(p),~\forall p\in\text{Prime}^+\setminus{2}$, 看似直接暴力会使得求解的 $h$ 会大幅增加</p>
<p>实际上要暴力的所有值的集合只是变成了</p>
<p>$$
{x\in[1,n]<em>{\mathbb{N}}:x~\text{is}~\text{powerful}~\text{number}}\cup 2{x\in[1,n]</em>{\mathbb{N}}:x~\text{is}~\text{powerful}~\text{number}}
$$</p>
<p>复杂度不变</p>
<h2>复杂度</h2>
<p>$O(n^r+\sqrt n\log n)$, 其中</p>
<ul>
<li>$\frac{2}{3}\leqslant r\leqslant\frac{3}{4}$, 由杜教筛预处理的长度决定</li>
<li>$\log n$ 来自于 <code>map</code></li>
</ul>
<h2>代码参考</h2>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:LibreOJ_6053 LibreOJ/6053/0.cpp %}

&lt;/details&gt;