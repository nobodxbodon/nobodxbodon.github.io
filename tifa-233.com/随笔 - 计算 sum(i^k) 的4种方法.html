<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/draft-015.md">仓库源文</a>，<a href="https://tifa-233.com/archives/draft-015">站点原文</a></h2>
<hr/>
<p>title: 随笔 - 计算 sum(i^k) 的4种方法
categories:</p>
<ul>
<li>随笔</li>
<li>数学
tags:</li>
<li>数学</li>
<li>随笔</li>
<li>数学
date: 2021-10-22 22:57:59</li>
</ul>
<hr/>
<p>只是存个代码, 阅读意义不大</p>
<p>&lt;!-- more --&gt;</p>
<h2>法一</h2>
<p>暴力</p>
<h3>复杂度</h3>
<ul>
<li>时间复杂度: $O(n\log k)$</li>
<li>空间复杂度: $O(1)$</li>
</ul>
<h2>法二</h2>
<p>对于 $k$ 极小的情况我们可以用已知的公式, 如</p>
<ul>
<li>$$
\sum_{i=1}^n i^2\equiv\frac{n(n+1)}{2}\pmod p
$$</li>
<li>$$
\sum_{i=1}^n i^3\equiv\frac{n(n+1)(2n+1)}{6}\pmod p
$$</li>
<li>$$
\sum_{i=1}^n i^4\equiv\frac{n^2(n+1)^2}{4}\pmod p
$$</li>
</ul>
<h3>复杂度</h3>
<ul>
<li>时间复杂度: $O(\log n)$</li>
<li>空间复杂度: $O(1)$</li>
</ul>
<h2>法三</h2>
<p>对于 $p$ 较小的情况, 由</p>
<p>$$
\sum_{i=1}^n i^k\equiv\sum_{i=1}^n (i\bmod p)^k\pmod p
$$</p>
<p>我们可以开个长度为 $p$ 的数组记录前缀和, 之后便可以 $O(1)$ 求得答案</p>
<h3>复杂度</h3>
<ul>
<li>时间复杂度: $O(p\log p)$</li>
<li>空间复杂度: $O(p)$</li>
</ul>
<h2>法四</h2>
<p>利用递推式</p>
<p>$$
\sum_{i=1}^n i^k\equiv\frac{1}{k+1}\left((n+1)^{k+1}-1-\sum_{t=0}^{k-1}{ \binom{k+1}{t}\over k+1}\sum_{i=1}^n i^t\right)\pmod p
$$</p>
<h3>复杂度</h3>
<ul>
<li>时间复杂度: $O(k)$</li>
<li>空间复杂度: $O(k)$</li>
</ul>
<h2>代码</h2>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% icodeweb blog lang:cpp draft-015/main.cpp %}</p>
<p>&lt;/details&gt;</p>
