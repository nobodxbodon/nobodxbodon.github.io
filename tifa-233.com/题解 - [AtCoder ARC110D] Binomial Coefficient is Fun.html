<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/arc110d.md">仓库源文</a>，<a href="https://tifa-233.com/arc110d">站点原文</a></h2>
<hr/>
<p>title: "题解 - [AtCoder ARC110D] Binomial Coefficient is Fun"
categories:</p>
<ul>
<li>算法竞赛</li>
<li>题解
tags:</li>
<li>算法竞赛</li>
<li>题解</li>
<li>AtCoder</li>
<li>数学</li>
<li>组合数学
date: 2020-12-06 19:02:01</li>
</ul>
<hr/>
<p><a href="https://atcoder.jp/contests/arc110/tasks/arc110_d">题目链接</a></p>
<p>&lt;!-- more --&gt;</p>
<h2>原始题面</h2>
<p>Time Limit: 2 sec / Memory Limit: 1024 MB</p>
<p>Score : 600 points</p>
<h3>Problem Statement</h3>
<p>We have a sequence $A$ of $N$ non-negative integers</p>
<p>Compute the sum of $\prod_{i=1}^N\binom{B_i}{A_i}$
over all sequences $B$ of $N$ non-negative integers whose sum is at most $M$, and print it modulo ($10^9+7$)</p>
<p>Here, $\binom{B_i}{A_i}$
, the binomial coefficient, denotes the number of ways to choose $A_i$ objects from $B_i$ objects, and is 0 when $B_i&lt;A_i$</p>
<h3>Constraints</h3>
<ul>
<li>All values in input are integers</li>
<li>$1≤N≤2000$</li>
<li>$1≤M≤10^9$</li>
<li>$0≤A_i≤2000$</li>
</ul>
<h3>Input</h3>
<p>Input is given from Standard Input in the following format:</p>
<p>$N\ M\A_1\ A_2\ ...\ A_N$</p>
<h3>Output</h3>
<p>Print the sum of $\prod_{i=1}^N\binom{B_i}{A_i}$, modulo ($10^9+7$)</p>
<h3>Sample Input 1</h3>
<pre><code class="language-input1">3 5
1 2 1
</code></pre>
<h3>Sample Output 1</h3>
<pre><code class="language-output1">8
</code></pre>
<p>There are four sequences B
such that $\prod_{i=1}^N\binom{B_i}{A_i}$ is at least 1:</p>
<ul>
<li>$B={1,2,1}$, where $\prod_{i=1}^N\binom{B_i}{A_i}=\binom{1}{1}×\binom{2}{2}×\binom{1}{1}=1$</li>
<li>$B={2,2,1}$, where $\prod_{i=1}^N\binom{B_i}{A_i}=\binom{2}{1}×\binom{2}{2}×\binom{1}{1}=2$</li>
<li>$B={1,3,1}$, where $\prod_{i=1}^N\binom{B_i}{A_i}=\binom{1}{1}×\binom{3}{2}×\binom{1}{1}=3$</li>
<li>$B={1,2,2}$, where $\prod_{i=1}^N\binom{B_i}{A_i}=\binom{1}{1}×\binom{2}{2}×\binom{2}{1}=2$</li>
</ul>
<p>The sum of these is $1+2+3+2=8$</p>
<h3>Sample Input 2</h3>
<pre><code class="language-input2">10 998244353
31 41 59 26 53 58 97 93 23 84
</code></pre>
<h3>Sample Output 2</h3>
<pre><code class="language-output2">642612171
</code></pre>
<h2>题意简述</h2>
<p>给定正整数 $n,m$ 和 $a_1,a_2,\dots,a_n$, 求</p>
<p>$$
\sum_{\begin{smallmatrix}
b_1,b_2,...,b_n&gt;0\\
\sum_{i=1}^nb_i\leqslant m
\end{smallmatrix}}\prod_{i=1}^n\binom{b_i}{a_i}
$$</p>
<h2>解题思路</h2>
<p>不难发现该问题等价于如下问题</p>
<p>给出 $m$ 个相同的小球和 $n$ 个盒子, 盒子编号为 $1,2,...,n$, 将小球放入盒子中, 要求第 $i$ 个盒子至少放 $a_i$ 个球, 接下来给每个盒子中的小球标号, 并分别在第 $i$ 个盒子里取出 $a_i$ 种, 问一共有多少种取法</p>
<p>先取出 $\sum_{i=1}^na_i$ 个球放进盒子里, 此时问题可转化为</p>
<p>将 $m-\sum_{i=1}^na_i$ 个相同的球放入 $n+\sum_{i=1}^na_i$ 个有编号盒子(允许盒子为空)的方案数 (考虑插空法易得)</p>
<p>所以最终答案即为</p>
<p>$$
{m+n\choose m-\sum_{i=1}^na_i}={m+n\choose\sum_{i=1}^na_i+n}
$$</p>
