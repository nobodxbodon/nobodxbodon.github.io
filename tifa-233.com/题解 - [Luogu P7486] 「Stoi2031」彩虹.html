<p>ç‰ˆæƒå£°æ˜ï¼š æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ BY-NC-SA è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/luogu-p7486.md">ä»“åº“æºæ–‡</a>ï¼Œ<a href="https://tifa-233.com/archives/luogu-p7486">ç«™ç‚¹åŸæ–‡</a></h2>
<hr/>
<p>title: "é¢˜è§£ - [Luogu P7486] ã€ŒStoi2031ã€å½©è™¹"
categories:</p>
<ul>
<li>ç®—æ³•ç«èµ›</li>
<li>é¢˜è§£
tags:</li>
<li>ç®—æ³•ç«èµ›</li>
<li>é¢˜è§£</li>
<li>æ´›è°·</li>
<li>æ•°å­¦</li>
<li>æ•°è®º</li>
<li>Iversonæ‹¬å·</li>
<li>MÃ¶biusåæ¼”</li>
<li>ç´ æ•°/è´¨æ•°</li>
<li>ç­›æ³•</li>
<li>Eulerç­›</li>
<li>æ•°è®ºåˆ†å—/æ•´é™¤åˆ†å—
date: 2023-05-16 08:25:11</li>
</ul>
<hr/>
<p>å–œæ¬¢æˆ‘ $\prod_i\prod_j [i,j]^{[i,j]}$ å— ğŸ˜</p>
<p><a href="https://www.luogu.com.cn/problem/P7486">é¢˜ç›®é“¾æ¥</a></p>
&lt;!-- more --&gt;

<h2>åŸå§‹é¢˜é¢</h2>
<h3>é¢˜ç›®èƒŒæ™¯</h3>
<blockquote><p>ä½ è¦ç¦»å¼€ æˆ‘çŸ¥é“å¾ˆç®€å• ä½ è¯´ä¾èµ– æ˜¯æˆ‘ä»¬çš„é˜»ç¢ å°±ç®—æ”¾å¼€ é‚£èƒ½ä¸èƒ½åˆ«æ²¡æ”¶æˆ‘çš„çˆ± å°±å½“æˆ‘æœ€åæ‰æ˜ç™½ â€”â€”ã€Šå½©è™¹ã€‹</p>
</blockquote>
<h3>é¢˜ç›®æè¿°</h3>
<p>è™¹æ˜¯ä¸€ä¸ªå–œæ¬¢å¹»æƒ³çš„å¥³å­©å­. å¥¹è®¤ä¸ºä¸¤ä¸ªæ­£æ•´æ•° $i,j$ çš„ <strong>ä¾èµ–å€¼</strong> ä¸º $\operatorname{lcm}(i,j)^{\operatorname{lcm}(i,j)}$. å¥¹å®šä¹‰æ‰€æœ‰æ»¡è¶³ $l \le i \le r,l \le j \le r$ çš„ $i,j$ çš„ <strong>ä¾èµ–å€¼</strong> ä¹‹ç§¯ä¸ºä¸¤ä¸ªæ­£æ•´æ•° $l,r$ çš„ <strong>é˜»ç¢å€¼</strong>. ç°åœ¨å¥¹ç»™äº†ä½ ä¸€ä¸ªæ­£æ•´æ•° $n$, å¹¶ $t$ æ¬¡è¯¢é—®ä½ ä¸¤ä¸ªæ»¡è¶³ $1 \le l \le r \le n$ çš„æ­£æ•´æ•° $l,r$ çš„ <strong>é˜»ç¢å€¼</strong> $ans\bmod{32465177}$</p>
<h3>è¾“å…¥æ ¼å¼</h3>
<p>ç¬¬ä¸€è¡Œä¸¤ä¸ªæ­£æ•´æ•° $t,n$</p>
<p>æ¥ä¸‹æ¥ $t$ è¡Œ, æ¯è¡Œä¸¤ä¸ªæ­£æ•´æ•° $l_i,r_i$, è¡¨ç¤ºä¸€æ¬¡è¯¢é—®</p>
<h3>è¾“å‡ºæ ¼å¼</h3>
<p>å¯¹äºæ¯ç»„è¯¢é—®è¾“å‡ºä¸€ä¸ªæ•´æ•°è¡¨ç¤ºç­”æ¡ˆ</p>
<h3>æ ·ä¾‹ #1</h3>
<h4>æ ·ä¾‹è¾“å…¥ #1</h4>
<pre><code class="lang-input1">3 7
1 3
2 3
7 7
</code></pre>
<h4>æ ·ä¾‹è¾“å‡º #1</h4>
<pre><code class="lang-output1">21072733
12145631
823543
</code></pre>
<h3>æç¤º</h3>
<h4>ç®€è¿°ç‰ˆé¢˜æ„</h4>
<p>ç»™å®š $l,r$, æ±‚ $\prod\limits<em>{i=l}^{r}\prod\limits</em>{j=l}^{r}\operatorname{lcm}(i,j)^{\operatorname{lcm}(i,j)} \bmod{32465177}$. å¤šæ¬¡è¯¢é—®</p>
<h4>æ ·ä¾‹è§£é‡Š</h4>
<p>å¯¹äºç¬¬ $1$ æ¬¡è¯¢é—®, $ans=1^1 \times (2^2)^3 \times (3^3)^3 \times (6^6)^2$, $ans \bmod{32465177}=21072733$;</p>
<p>å¯¹äºç¬¬ $2$ æ¬¡è¯¢é—®, $ans=2^2 \times 3^3 \times (6^6)^2$, $ans \bmod{32465177}=12145631$;</p>
<p>å¯¹äºç¬¬ $3$ æ¬¡è¯¢é—®, $ans=7^7=823543$</p>
<h4>æ•°æ®èŒƒå›´</h4>
<p>å¯¹äº $30\%$ çš„æ•°æ®, $1 \le n \le 10^3,t=1$;</p>
<p>å¯¹äº $60\%$ çš„æ•°æ®, $1 \le n \le 10^5,t=1$;</p>
<p>å¯¹äº $100\%$ çš„æ•°æ®, $1 \le n \le 10^6,1 \le t \le 10,1 \le l_i \le r_i \le n$</p>
<h2>è§£é¢˜æ€è·¯</h2>
<p>è®¾</p>
<p>$$
S(n,m)=\prod<em>{i=1}^n\prod</em>{j=1}^m[i,j]^{[i,j]}
$$</p>
<p>ä¸å¦¨è®¾ $n\leq m$, æ‰€æ±‚å³ä¸º</p>
<p>$$
\frac{S(r,r)S(l-1,l-1)}{S(l-1,r)^2}
$$</p>
<p>æ¨å¼å­</p>
<p>$$
\begin{aligned}
  S(n,m)&amp;=\prod<em>{i=1}^n\prod</em>{j=1}^m[i,j]^{[i,j]}\
  &amp;=\prod<em>{i=1}^n\prod</em>{j=1}^m\left(\frac{ij}{(i,j)}\right)^{\frac{ij}{(i,j)}}\
  &amp;=\prod<em>{d=1}^n\prod</em>{i=1}^{\lfloor\frac{n}{d}\rfloor}\prod<em>{j=1}^{\lfloor\frac{m}{d}\rfloor}(ijd)^{ijd[(i,j)=1]}\
  &amp;=\prod</em>{d=1}^n\prod<em>{e=1}^{\lfloor\frac{n}{d}\rfloor}\prod</em>{i=1}^{\lfloor\frac{n}{de}\rfloor}\prod<em>{j=1}^{\lfloor\frac{m}{de}\rfloor}(ijde^2)^{ijde^2\mu(e)}\
  &amp;\xlongequal{D=de}\prod</em>{D=1}^n\prod<em>{e\mid D}\prod</em>{i=1}^{\lfloor\frac{n}{D}\rfloor}\prod_{j=1}^{\lfloor\frac{m}{D}\rfloor}(ijDe)^{ijDe\mu(e)}
\end{aligned}
$$</p>
<p>å³</p>
<p>$$
S(n,m)=\prod<em>{d=1}^n\prod</em>{e\mid d}\prod<em>{i=1}^{\lfloor\frac{n}{d}\rfloor}\prod</em>{j=1}^{\lfloor\frac{m}{d}\rfloor}(ijde)^{ijde\mu(e)}
$$</p>
<p>æ¥ç€æ¨</p>
<p>$$
\begin{aligned}
  S(n,m)&amp;=\prod<em>{d=1}^n\prod</em>{e\mid d}\prod<em>{i=1}^{\lfloor\frac{n}{d}\rfloor}\prod</em>{j=1}^{\lfloor\frac{m}{d}\rfloor}(ijde)^{ijde\mu(e)}\
  &amp;=\prod<em>{d=1}^n\prod</em>{e\mid d}\left(\prod<em>{i=1}^{\lfloor\frac{n}{d}\rfloor}\prod</em>{j=1}^{\lfloor\frac{m}{d}\rfloor}(ij)^{ij}\right)^{de\mu(e)}\prod<em>{d=1}^n\prod</em>{e\mid d}(de)^{de\mu(e)\sum<em>{i=1}^{\lfloor\frac{n}{d}\rfloor}\sum</em>{j=1}^{\lfloor\frac{m}{d}\rfloor}ij}\
  &amp;\xlongequal[s(n)=\sum<em>{i=1}^n i=\frac{n(n+1)}{2}]{H(n)=\prod</em>{i=1}^n i^i}\prod<em>{d=1}^n\prod</em>{e\mid d}\left(H\left(\left\lfloor\frac{n}{d}\right\rfloor\right)^{s\left(\left\lfloor\frac{m}{d}\right\rfloor\right)}H\left(\left\lfloor\frac{m}{d}\right\rfloor\right)^{s\left(\left\lfloor\frac{n}{d}\right\rfloor\right)}\right)^{de\mu(e)}\prod<em>{d=1}^n\prod</em>{e\mid d}(de)^{de\mu(e)s\left(\left\lfloor\frac{n}{d}\right\rfloor\right)s\left(\left\lfloor\frac{m}{d}\right\rfloor\right)}\
  &amp;\xlongequal[h(n)=({\operatorname{id}\mu}*{1})(n)]{g(m,n)=H(n)^{s(m)}H(m)^{s(n)}}\prod<em>{d=1}^ng\left(\left\lfloor\frac{n}{d}\right\rfloor,\left\lfloor\frac{m}{d}\right\rfloor\right)^{dh(d)}\prod</em>{d=1}^nd^{dh(d)s\left(\left\lfloor\frac{n}{d}\right\rfloor\right)s\left(\left\lfloor\frac{m}{d}\right\rfloor\right)}\prod<em>{d=1}^n\prod</em>{e\mid d}e^{de\mu(e)s\left(\left\lfloor\frac{n}{d}\right\rfloor\right)s\left(\left\lfloor\frac{m}{d}\right\rfloor\right)}\
  &amp;\xlongequal{k(n)=\prod<em>{e\mid n}e^{e\mu(e)}}\prod</em>{d=1}^ng\left(\left\lfloor\frac{n}{d}\right\rfloor,\left\lfloor\frac{m}{d}\right\rfloor\right)^{dh(d)}\prod<em>{d=1}^nd^{dh(d)s\left(\left\lfloor\frac{n}{d}\right\rfloor\right)s\left(\left\lfloor\frac{m}{d}\right\rfloor\right)}\prod</em>{d=1}^nk(d)^{ds\left(\left\lfloor\frac{n}{d}\right\rfloor\right)s\left(\left\lfloor\frac{m}{d}\right\rfloor\right)}\
  &amp;=\prod<em>{d=1}^n\left(g\left(\left\lfloor\frac{n}{d}\right\rfloor,\left\lfloor\frac{m}{d}\right\rfloor\right)^{h(d)}\left(d^{h(d)}k(d)\right)^{s\left(\left\lfloor\frac{n}{d}\right\rfloor\right)s\left(\left\lfloor\frac{m}{d}\right\rfloor\right)}\right)^{d}\
  &amp;=\prod</em>{d=1}^ng\left(\left\lfloor\frac{n}{d}\right\rfloor,\left\lfloor\frac{m}{d}\right\rfloor\right)^{dh(d)}\prod_{d=1}^n\left(d^{dh(d)}k(d)^d\right)^{s\left(\left\lfloor\frac{n}{d}\right\rfloor\right)s\left(\left\lfloor\frac{m}{d}\right\rfloor\right)}
\end{aligned}
$$</p>
<p>ä¹‹åé¢„å¤„ç†ä¸€ä¸‹åæ•´é™¤åˆ†å—å³å¯</p>
<h2>æ—¶é—´å¤æ‚åº¦</h2>
<p>$O(n\log n+t\sqrt{n}\log n)$</p>
<h2>ä»£ç å‚è€ƒ</h2>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:Luogu_P7486 Luogu/P7486/0.cpp %}

&lt;/details&gt;