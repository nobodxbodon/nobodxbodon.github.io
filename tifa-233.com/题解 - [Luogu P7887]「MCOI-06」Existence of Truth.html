<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/luogu-p7887.md">仓库源文</a>，<a href="https://tifa-233.com/archives/luogu-p7887">站点原文</a></h2>
<hr/>
<p>title: 题解 - [Luogu P7887]「MCOI-06」Existence of Truth
categories:</p>
<ul>
<li>算法竞赛</li>
<li>题解
tags:</li>
<li>算法竞赛</li>
<li>题解</li>
<li>洛谷</li>
<li>数学</li>
<li>数论</li>
<li>逆元</li>
<li>递推
date: 2021-10-05 23:23:44</li>
</ul>
<hr/>
<p><a href="https://www.luogu.com.cn/problem/P7887">题目链接</a></p>
<p>&lt;!-- more --&gt;</p>
<h2>原始题面</h2>
<h3>题目描述</h3>
<p>可能存在一个非负整数数序列 $a_1,a_2,\dots,a_n$ 使得 $0\le a_i&lt;10^9+7$</p>
<p>给定 $x_1,x_2,\dots,x_n$, $y_1,y_2,\dots,y_n$, $z_1,z_2,\dots,z_n$, 已知对于 $1\le i\le n$ 满足:</p>
<p>$$
x_i\left(\sum_{j=1}^ia_j\right)+y_i\left(\sum_{j=i}^na_j\right)\equiv z_i\pmod{10^9+7}
$$</p>
<p>求 $a_1,a_2,\dots,a_n$</p>
<h3>输入输出格式</h3>
<h4>输入格式</h4>
<blockquote>
<p><strong>本题有多组数据</strong></p>
</blockquote>
<p>第一行一个正整数 $T$, 表示表示数据的组数. 对于每一组数据:</p>
<p>第一行一个正整数 $n$</p>
<p>接下来 $n$ 行, 每行三个正整数 $x_i,y_i,z_i$</p>
<h4>输出格式</h4>
<p>对于每一组数据, 依次输出:</p>
<p>第一行一个非负整数 $k$, 为合法解数量</p>
<p>如果 $k=1$, 第二行输出 $n$ 个非负整数, 依次为 $a_1,a_2,\dots,a_n$</p>
<h3>输入输出样例</h3>
<h4>输入样例 #1</h4>
<pre><code class="language-input1">2
3
3 1 9
2 2 16
1 3 15
6
3 6 246
5 7 283
2 7 179
4 6 214
8 7 337
3 5 151
</code></pre>
<h4>输出样例 #1</h4>
<pre><code class="language-output1">1
1 2 3
1
8 8 0 6 7 8
</code></pre>
<h4>说明</h4>
<h5>数据规模与约定</h5>
<blockquote>
<p><strong>本题采用捆绑测试</strong></p>
</blockquote>
<ul>
<li>Subtask 1 (10 pts): $n=1$</li>
<li>Subtask 2 (19 pts): $\sum n\le100$</li>
<li>Subtask 3 (19 pts): $x_i=y_i=1$</li>
<li>Subtask 4 (22 pts): 保证有<strong>唯一解</strong></li>
<li>Subtask 5 (30 pts): 无特殊限制</li>
</ul>
<p>对于所有数据:</p>
<ul>
<li>$1\le n,\sum n\le 2\times10^5$;</li>
<li>$1\le x_i,y_i&lt;10^9+7$;</li>
<li>$0\le z_i&lt;10^9+7$</li>
</ul>
<h2>解题思路</h2>
<p>令</p>
<ul>
<li>$A_0=0$</li>
<li>$A_n=\sum_{i=1}^na_i$</li>
<li>$Y_i=-y_ix_i^{-1}$</li>
<li>$Z_i=z_ix_i^{-1}$</li>
</ul>
<p>则原式变为</p>
<p>$$
x_iA_i+y_i(A_n-A_{i-1})\equiv z_i\pmod{10^9+7}
$$</p>
<p>有</p>
<p>$$
A_i\equiv Z_i+Y_i(A_n-A_{i-1})\pmod{10^9+7}
$$</p>
<p>不难观察出 $\exists {Z'_n},{Y'_n}$ 使得</p>
<p>$$
A_i=Z'_i+Y'_iA_n
$$</p>
<p>顺次递推求出 ${Z'_n}$, ${Y'_n}$ 之后求出 ${A_n}$, ${a_n}$ 即可</p>
<p>另外注意由 $A_n=Z'_n+Y'_nA_n$ 来判断解的个数</p>
<h2>时间复杂度</h2>
<p>$O(n+\log p)=O(n)$, 其中 $p=1e9+7$</p>
<h2>代码参考</h2>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% icodeweb cpa_cpp title:Luogu_P7887 Luogu/P7887/0.cpp %}</p>
<p>&lt;/details&gt;</p>
