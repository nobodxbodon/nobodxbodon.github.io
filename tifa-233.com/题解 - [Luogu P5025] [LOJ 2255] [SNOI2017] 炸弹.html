<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/luogu-p5025.md">仓库源文</a>，<a href="https://tifa-233.com/luogu-p5025">站点原文</a></h2>
<hr/>
<p>title: "题解 - [Luogu P5025] [LOJ 2255] [SNOI2017] 炸弹"
categories:</p>
<ul>
<li>算法竞赛</li>
<li>题解
tags:</li>
<li>算法竞赛</li>
<li>题解</li>
<li>省选</li>
<li>SNOI</li>
<li>洛谷</li>
<li>LibreOJ</li>
<li>数据结构</li>
<li>图论</li>
<li>单调栈</li>
<li>线段树</li>
<li>Tarjan算法
date: 2022-06-28 22:01:58</li>
</ul>
<hr/>
<h2>题面</h2>
<ul>
<li><a href="https://www.luogu.com.cn/problem/P4205">洛谷 P5025</a></li>
<li><a href="https://loj.ac/p/2255">LOJ 2255</a></li>
</ul>
<p>&lt;!-- more --&gt;</p>
<h2>原始题面</h2>
<p>1000 ms / 125.00 MB</p>
<h3>题目描述</h3>
<p>在一条直线上有 $n$ 个炸弹, 每个炸弹的坐标是 $x_i$, 爆炸半径是 $r_i$, 当一个炸弹爆炸时, 如果另一个炸弹所在位置 $x_j$ 满足: $|x_j-x_i| \le r_i$, 那么, 该炸弹也会被引爆.</p>
<p>现在, 请你帮忙计算一下, 先把第 $i$ 个炸弹引爆, 将引爆多少个炸弹呢?</p>
<p>答案对 $10^9 + 7$ 取模</p>
<h3>输入格式</h3>
<p>第一行, 一个数字 $n$, 表示炸弹个数
第 $2 \sim n+1$ 行, 每行两个整数, 表示 $x_i$, $r_i$, 保证 $x_i$ 严格递增</p>
<h3>输出格式</h3>
<p>一个数字, 表示 $\sum \limits_{i=1}^n i\times$ 炸弹 $i$ 能引爆的炸弹个数</p>
<h3>样例 #1</h3>
<h4>样例输入 #1</h4>
<pre><code>4
1 1
5 1
6 5
15 15
</code></pre>
<h4>样例输出 #1</h4>
<pre><code>32
</code></pre>
<h3>提示</h3>
<p>【数据范围】</p>
<p>对于 $20%$ 的数据: $n\leq 100$</p>
<p>对于 $50%$ 的数据: $n\leq 1000$</p>
<p>对于 $80%$ 的数据: $n\leq 100000$</p>
<p>对于 $100%$ 的数据: $1\le n\leq 500000$, $-10^{18}\leq x_{i}\leq 10^{18}$, $0\leq r_{i}\leq 2\times 10^{18}$</p>
<h2>解题思路</h2>
<p>线段树优化建图然后 Tarjan 跑强连通分量的做法比较显然, 这里介绍一个基于单调栈维护边界的线性做法</p>
<p>首先我们假设炸弹只能引爆左边的炸弹, 此时可以很容易地按顺序求出左边界 <code>l[i]</code></p>
<p>之后我们把右边的炸弹纳入考虑中, 右边界 <code>r[i]</code> 可以按左边界一样的方法逆序得出</p>
<p>注意考虑右边界后, 左边界会变动 (即右边炸弹的引爆范围覆盖的当前炸弹的左边界)</p>
<h2>复杂度</h2>
<p>$O(n)$</p>
<h2>代码参考</h2>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% icodeweb cpa_cpp title:Luogu_P5025 Luogu/P5025/0.cpp %}</p>
<p>&lt;/details&gt;</p>
