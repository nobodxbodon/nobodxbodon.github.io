<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/luogu-p2508.md">仓库源文</a>，<a href="https://tifa-233.com/archives/luogu-p2508">站点原文</a></h2>
<hr/>
<p>title: "题解 - [Luogu P2508] [HAOI2008] 圆上的整点"
categories:</p>
<ul>
<li>算法竞赛</li>
<li>题解
tags:</li>
<li>算法竞赛</li>
<li>题解</li>
<li>洛谷</li>
<li>省选</li>
<li>HAOI</li>
<li>数学</li>
<li>数论</li>
<li>Fermat二平方和定理</li>
<li>Gauss整数
date: 2021-10-29 03:09:51</li>
</ul>
<hr/>
<p><a href="https://www.luogu.com.cn/problem/P2508">题目链接</a></p>
&lt;!-- more --&gt;

<h2>原始题面</h2>
<h3>题目描述</h3>
<p>求一个给定的圆 $(x^2+y^2=r^2)$, 在圆周上有多少个点的坐标是整数</p>
<h3>输入格式</h3>
<p>r</p>
<h3>输出格式</h3>
<p>整点个数</p>
<h3>样例 #1</h3>
<h4>样例输入 #1</h4>
<pre><code class="lang-input1">4
</code></pre>
<h4>样例输出 #1</h4>
<pre><code class="lang-output1">4
</code></pre>
<h3>提示</h3>
<p>$r\leq 2000 000 000$</p>
<h2>解题思路</h2>
<p>显然我们只需要考虑第一象限的情况, 设</p>
<p>$$
r^2=2^{2\alpha<em>2}\prod</em>{p\in{x\in\text{Prime}^+|x=4k+3}}p^{2\alpha<em>p}\prod</em>{q=\in{x\in\text{Prime}^+|x=4k+1}}q^{2\alpha_q}
$$</p>
<p>我们知道任意素数都能分解为一对共轭的 Gauss 整数的乘积, 且由 <a href="https://en.wikipedia.org/wiki/Fermat's_theorem_on_sums_of_two_squares">Fermat 二平方和定理</a>, 只有 $q$ ($4k+1$ 型素数) 能分解为两正整数的平方和</p>
<p>不难发现答案即为</p>
<p>$$
\prod_{q=\in{x\in\text{Prime}^+|x=4k+1}}(2\alpha_q+1)
$$</p>
<p>最后乘 4 即为所求</p>
<h2>复杂度</h2>
<p>$O\left(\sqrt{r}\right)$</p>
<h2>代码参考</h2>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:Luogu_P2508 Luogu/P2508/1.cpp %}

&lt;/details&gt;