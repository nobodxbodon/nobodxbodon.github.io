<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/namomo2022s1-week13.md">仓库源文</a>，<a href="https://tifa-233.com/archives/namomo2022s1-week13">站点原文</a></h2>
<p>Namomo Spring Camp 2022 Div1 每日一题记录 (2022.05.21-2022.05.27)</p>
&lt;!-- more --&gt;

<h2>序列中 ab 的个数 (CF908D)</h2>
<p><a href="https://oj.daimayuan.top/problem/915">题目链接</a></p>
<p>5 s, 1024 MB</p>
<h3>题目描述</h3>
<p>给三个整数 $k,pa,pb$, 最初有一个空序列,每一秒都可以执行以下操作, 以 $pa$ $/$ $(pa+pb)$ 的概率将 $a$ 添加到末尾或者以 $pb$ $/$ $(pa+pb)$ 的概率将 $b$ 添加到末尾, 一旦至少出现 k 个子序列 $ab$, 就停止操作, 求最终子序列 $ab$ 的期望次数, 输出一个整数 $mod$ $(1e9+7)$</p>
<h3>输入格式</h3>
<p>一行输入三个整数 $k,pa,pb$</p>
<h3>输出格式</h3>
<p>一个数, 表示答案</p>
<h3>样例 1 输入</h3>
<pre><code class="lang-input1">3 1 4
</code></pre>
<h3>样例 1 输出</h3>
<pre><code class="lang-output1">370000006
</code></pre>
<h3>样例 2 输入</h3>
<pre><code class="lang-input2">1 1 1
</code></pre>
<h3>样例 2 输出</h3>
<pre><code class="lang-output2">2
</code></pre>
<h3>数据规模</h3>
<p>所有数据保证 $1 \le k \le 1000 ,1 \le pa,pb \le 1e6$</p>
<h3>解题思路</h3>
<blockquote><p>概率 DP</p>
</blockquote>
<p>设 $f(x,y)$ 表示有 $x$ 个 <code>a</code>, 且有 $y$ 个子串 <code>ab</code> 时的概率, 则</p>
<p>$$
f(x,y)=\frac{p_a}{p_a+p_b}f(x-1,y)+\frac{p_b}{p_a+p_b}f(x,y-x)
$$</p>
<p>另外, 若 $x+y&gt;k$, 则期望应为 $\sum_{i=0}^{\infty}(\frac{p_a}{p_a+p_b})^i\frac{p_b}{p_a+p_b}(x+y+i)$</p>
<p>然后倒着推即可</p>
<h3>代码参考</h3>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:CodeForces_908D CodeForces/908D/0.cpp %}

&lt;/details&gt;<h2>谁才是最终赢家?</h2>
<p><a href="https://oj.daimayuan.top/problem/931">题目链接</a></p>
<p>1 s, 256 MB</p>
<h3>题目描述</h3>
<p>小明和小红经常玩一个博弈游戏. 给定一个 $n \times n$ 的棋盘, 一个石头被放指定位置. 他们轮流移动石头. 每一回合, 选手只能把石头向上, 下, 左, 右四个方向移动一格, 并且要求移动到的格子之前不能被访问过. 谁不能移动石头了就算输</p>
<p>假如小明先移动石头, 而且两个选手都以最优策略走步, 问最后谁能赢？</p>
<p>如果小明赢则输出 <code>Alice</code>, 否则输出 <code>Bob</code></p>
<h3>输入格式</h3>
<p>第一行一个整数 $n$,表示一个 $n \times n$ 的棋盘</p>
<p>第二行两个整数 $x, y$ 表示起点的位置</p>
<h3>输出格式</h3>
<p>一行一个字符串</p>
<h3>样例输入</h3>
<pre><code class="lang-input1">2
1 1
</code></pre>
<h3>样例输出</h3>
<pre><code class="lang-output1">Alice
</code></pre>
<h3>数据限制</h3>
<p>$1 \le n \le 10000, 1 \le x, y \le n$</p>
<h3>解题思路</h3>
<p>&gt;</p>
<h3>代码参考</h3>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

&lt;/details&gt;<h2>矩阵游戏 (BZOJ4766)</h2>
<p><a href="https://oj.daimayuan.top/problem/956">题目链接</a></p>
<p>1 s, 1024 MB</p>
<h3>题目描述</h3>
<p>小 $s$ 正在玩一个游戏: 他有一个长为 $N$, 宽为 $M$ 的棋盘, 其中有一些格子是黑色的 (其余的格子是白色的)</p>
<p>每次操作他可以选择一个长度和宽度均大于 $1$ 的矩形区域, 如果其中 3 个角落的格子是黑色的, 那么他可以把剩余那个角落的白色格子涂成黑色</p>
<p>试求出有多少种不同的长为 $N$, 宽为 $M$ 的棋盘, 满足小 $s$ 可以通过有限次操作把整个棋盘变成黑色, 并且黑色格子个数最少. 两个棋盘不同当且仅当存在一个格子在两个棋盘中的颜色不同</p>
<p>你只需要输出这个数字对 $998244353$ 取模后的结果</p>
<h3>输入格式</h3>
<p>第一行一个正整数 $T$, 表示数据组数. 对于每组测试数据, 第一行输入两个正整数 $N$ 和 $M$</p>
<p>数据范围: 对于所有数据, 满足 $1 \leq T \leq 100$, $1 \leq N \leq 100$, $1 \leq M \leq 100$</p>
<h3>输出格式</h3>
<p>对于每组数据, 输出一行一个整数表示答案</p>
<h3>样例输入</h3>
<pre><code class="lang-input1">2
1 1
2 2
</code></pre>
<h3>样例输出</h3>
<pre><code class="lang-output1">1
4
</code></pre>
<h3>解题思路</h3>
<blockquote><p>矩阵树定理</p>
</blockquote>
<p>题目所求等价于 $K_{n,m}$ 的最小生成树个数, 即 $m^{n-1}n^{m-1}$</p>
<h3>代码参考</h3>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:BZOJ_4766 BZOJ/4766/0.cpp %}

&lt;/details&gt;<h2>最大化深度和 (POI2008 STA-Station)</h2>
<p><a href="https://oj.daimayuan.top/problem/921">题目链接</a></p>
<p>1 s, 1024 MB</p>
<h3>题目描述</h3>
<p>给定一个 $n$ 个点的树, 请求出一个结点, 使得以这个结点为根时, 所有结点的深度之和最大, 输出最大的深度之和即可</p>
<p><strong>注意</strong>: 根的深度为 $1$</p>
<h3>输入格式</h3>
<p>第一行有一个整数, 表示树的结点个数 $n$</p>
<p>接下来 $(n−1)$ 行, 每行两个整数 $u, v$, 表示存在一条连接 $u, v$ 的边</p>
<h3>输出格式</h3>
<p>一个正整数, 表示最大的深度之和</p>
<h3>样例输入</h3>
<pre><code class="lang-input1">8
1 4
5 6
4 5
6 7
6 8
2 4
3 4
</code></pre>
<h3>样例输出</h3>
<pre><code class="lang-output1">28
</code></pre>
<h3>数据规模</h3>
<p>$0 \leq n \leq 10^6$. 即可能存在空树</p>
<p>$1 \leq u, v \leq n$, 保证给出的是一棵树</p>
<h3>解题思路</h3>
<blockquote><p>换根 DP</p>
</blockquote>
<p>典中典, 设 $f(x)$ 是以 $x$ 为根时的结果, 先随便取个根 $r$ DFS 出结果, 然后</p>
<p>$$
f(x)=f(y)-s(x)+n-s(x)
$$</p>
<p>其中</p>
<ul>
<li>$s(x)$ 代表以 $r$ 为根时 $x$ 的子树大小</li>
<li>$y$ 是以 $r$ 为根时 $x$ 的父结点</li>
</ul>
<h3>复杂度</h3>
<p>$O(n)$</p>
<h3>代码参考 (洛谷 P3478)</h3>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:Luogu_P3478 Luogu/P3478/0.cpp %}

&lt;/details&gt;<h2>稳定数组 (CF1547F)</h2>
<p><a href="https://oj.daimayuan.top/problem/923">题目链接</a></p>
<p>2 s, 1024 MB</p>
<h3>题目描述</h3>
<p>给定 $n$ 个正整数 $a_1,a_2,\dots ,a_n$, 每次操作对所有的 $i,1\leq i \leq n$,令 $a_i=gcd(a<em>i,a</em>{(i+1)\% n})$, 求最少执行多少次操作, 使得 $a_1=a_2=\dots =a_n$</p>
<h3>输入格式</h3>
<p>第一行一个正整数 $n$</p>
<p>第二行 $n$ 个正整数 $a_1,a_2,\dots ,a_n$</p>
<h3>输出格式</h3>
<p>一个非负整数, 表示最少操作数</p>
<h3>样例输入</h3>
<pre><code class="lang-input1">4
16 24 10 5
</code></pre>
<h3>样例输出</h3>
<pre><code class="lang-output1">3
</code></pre>
<h3>数据规模</h3>
<p>$2\leq n \leq 10^6$</p>
<p>$1\leq a_i \leq 10^6$</p>
<h3>解题思路</h3>
<blockquote><p>RMQ + 二分/双指针</p>
</blockquote>
<p>这里写的 ST 表 + 二分, 因为好写</p>
<p>要注意因为要断环成链所以要开 2 倍空间</p>
<h3>复杂度</h3>
<p>$O(n\log^2 n)$</p>
<h3>代码参考</h3>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:CodeForces_1547F CodeForces/1547F/0.cpp %}

&lt;/details&gt;<h2>序列和 (CF1373D)</h2>
<p><a href="https://oj.daimayuan.top/problem/970">题目链接</a></p>
<p>1 s, 1024 MB</p>
<h3>题目描述</h3>
<p>给定一个长度为 $n$ 序列 $a_0 , a<em>1 , \dots , a</em>{n - 1}$ , 你可以翻转它的一个连续子段(可以为空) , 使得所有偶数下标的数字之和最大</p>
<h3>输入格式</h3>
<p>第一行一个整数 $n$ , 表示序列的长度 $(1 \leq n \leq 2 \times 10^5)$</p>
<p>第二行 $n$ 个整数 $a_0 , a<em>1 , \dots , a</em>{n - 1}$ 表示序列 $a$ $( 1 \leq a_i \leq 10^9 )$</p>
<h3>输出格式</h3>
<p>输出一个整数表示偶数下标之和的最大值</p>
<h3>样例输入</h3>
<pre><code class="lang-input1">8
1 7 3 4 7 6 2 9
</code></pre>
<h3>样例输出</h3>
<pre><code class="lang-output1">26
</code></pre>
<h3>解题思路</h3>
<p>不难发现选择即是将一段偶数下标的和变为奇数下标的和, 所以取一下差值最大区间和即可</p>
<h3>复杂度</h3>
<p>$O(n)$</p>
<h3>代码参考</h3>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:CodeForces_1373D CodeForces/1373D/0.cpp %}

&lt;/details&gt;<h2>变量</h2>
<p><a href="https://oj.daimayuan.top/problem/138">题目链接</a></p>
<p>1 s, 1024 MB</p>
<h3>题目描述</h3>
<p>给定 $n$ 个整数常数 $c_1, c_2, \dots, c_n$ 和一个整数 $k$. 现在需要给 $2k$ 个整数变量 $x_1, x_2, \dots, x_k, y_1, y_2, \dots, y_k$ 赋值, 满足</p>
<ol>
<li>对于所有 $1 \leq i \leq k$, 都有 $x_i \leq y_i$</li>
<li>对于所有 $1 \leq i \leq n$, 都存在至少一个 $j (1 \leq j \leq k)$, 使得 $x_j \leq c_i \leq y_j$</li>
</ol>
<p>求出 $S=(y_1 + y_2 + \dots + y_k) - (x_1 + x_2 + \dots + x_k)$ 的最小值</p>
<h3>输入格式</h3>
<p>第一行两个整数 $n, k$</p>
<p>接下来一行, 共 $n$ 个整数 $c_1, c_2, \dots, c_n$</p>
<h3>输出格式</h3>
<p>一个整数表示 $S$ 的最小值</p>
<h3>样例输入 1</h3>
<pre><code class="lang-input1">5 2
-5 0 10 4 0
</code></pre>
<h3>样例输出 1</h3>
<pre><code class="lang-output1">9
</code></pre>
<h3>样例输入输出 2</h3>
<p>见下发文件</p>
<h3>数据规模</h3>
<p>共 10 个测试点</p>
<p>测试点 $1, 2$ 满足 $n\leq 5, -5\leq c_i\leq 5$</p>
<p>测试点 $3, 4, 5$ 满足 $n\leq 100$</p>
<p>对于所有数据, 满足 $1\leq n, k\leq 10^5,-10^9\leq c_i\leq 10^9$</p>
<h3>解题思路</h3>
<p>直接做就行, 没啥值得说的</p>
<h3>复杂度</h3>
<p>$O(n\log n)$</p>
<h3>代码参考</h3>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:Daimayuan_138 Daimayuan/138/0.cpp %}

&lt;/details&gt;