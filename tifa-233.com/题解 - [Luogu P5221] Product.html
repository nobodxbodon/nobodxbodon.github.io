<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/luogu-p5221.md">仓库源文</a>，<a href="https://tifa-233.com/archives/luogu-p5221">站点原文</a></h2>
<p><a href="https://www.luogu.com.cn/problem/P5221">题目链接</a></p>
&lt;!-- more --&gt;

<h2>原始题面</h2>
<h3>题目背景</h3>
<p>${\rm CYJian}$: "听说 $gcd$ 和 $\sum$ 套起来比较好玩？？那我就......"</p>
<h3>题目描述</h3>
<p>${\rm CYJian}$ 最近闲的玩起了 $gcd$. 他想到了一个非常简单而有意思的式子:</p>
<p>$$
\prod<em>{i=1}^N\prod</em>{j=1}^N\frac{lcm(i,j)}{gcd(i,j)}\ (\bmod\ 104857601)
$$</p>
<p>${\rm CYJian}$ 已经算出来这个式子的值了. 现在请你帮他验算一下吧. ${\rm CYJian}$ 只给你 $0.2s$ 的时间哦</p>
<h3>输入输出格式</h3>
<h4>输入格式</h4>
<p>一行一个正整数 $N$</p>
<h4>输出格式</h4>
<p>一行一个正整数, 表示答案模 $104857601$ 的值</p>
<h3>输入输出样例</h3>
<h4>输入样例 #1</h4>
<pre><code class="lang-input1">5
</code></pre>
<h4>输出样例 #1</h4>
<pre><code class="lang-output1">585494
</code></pre>
<h3>说明</h3>
<p>样例解释:</p>
<table>
<thead><tr>
<th style="text-align:center">$\frac{lcm}{gcd}$</th>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
<th style="text-align:center">4</th>
<th style="text-align:center">5</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>1</strong></td>
<td style="text-align:center">1</td>
<td style="text-align:center">2</td>
<td style="text-align:center">3</td>
<td style="text-align:center">4</td>
<td style="text-align:center">5</td>
</tr>
<tr>
<td style="text-align:center"><strong>2</strong></td>
<td style="text-align:center">2</td>
<td style="text-align:center">1</td>
<td style="text-align:center">6</td>
<td style="text-align:center">2</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:center"><strong>3</strong></td>
<td style="text-align:center">3</td>
<td style="text-align:center">6</td>
<td style="text-align:center">1</td>
<td style="text-align:center">12</td>
<td style="text-align:center">15</td>
</tr>
<tr>
<td style="text-align:center"><strong>4</strong></td>
<td style="text-align:center">4</td>
<td style="text-align:center">2</td>
<td style="text-align:center">12</td>
<td style="text-align:center">1</td>
<td style="text-align:center">20</td>
</tr>
<tr>
<td style="text-align:center"><strong>5</strong></td>
<td style="text-align:center">5</td>
<td style="text-align:center">10</td>
<td style="text-align:center">15</td>
<td style="text-align:center">20</td>
<td style="text-align:center">1</td>
</tr>
</tbody>
</table>
<p>对于 $30\%$ 的数据: $1 \leq N \leq 5000$</p>
<p>对于 $100\%$ 的数据: $1 \leq N \leq 1000000$</p>
<h2>解题思路</h2>
<p>推式子</p>
<p>$$
\begin{aligned}
  \prod<em>{i=1}^n\prod</em>{j=1}^n \frac{ij}{(i,j)^2} &amp; =\frac{(n!)^{2n}}{\prod<em>{i=1}^n\prod</em>{j=1}^n(i,j)^2} \
  &amp; =\frac{(n!)^{2n}}{\prod<em>{d=1}^nd^{2\sum</em>{i=1}^{\lfloor\frac{n}{d}\rfloor}\sum<em>{j=1}^{\lfloor\frac{n}{d}\rfloor}[(i,j)=1]}} \
  &amp; =\frac{(n!)^{2n}}{\prod</em>{d=1}^nd^{2\sum_{e=1}^{\lfloor\frac{n}{d}\rfloor}\mu(e)\lfloor\frac{n}{de}\rfloor^2}} \
\end{aligned}
$$</p>
<p>两层整除分块即可</p>
<h2>时间复杂度</h2>
<p>$O(n)$</p>
<h2>代码参考</h2>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:Luogu_P5221 Luogu/P5221/0.cpp %}

&lt;/details&gt;