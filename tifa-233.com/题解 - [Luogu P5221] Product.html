<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/luogu-p5221.md">仓库源文</a>，<a href="https://tifa-233.com/luogu-p5221">站点原文</a></h2>
<hr/>
<p>title: "题解 - [Luogu P5221] Product"
categories:</p>
<ul>
<li>算法竞赛</li>
<li>题解
tags:</li>
<li>算法竞赛</li>
<li>题解</li>
<li>洛谷</li>
<li>数学</li>
<li>数论</li>
<li>Iverson括号</li>
<li>Möbius反演
date: 2021-06-02 13:25:23</li>
</ul>
<hr/>
<p><a href="https://www.luogu.com.cn/problem/P5221">题目链接</a></p>
<p>&lt;!-- more --&gt;</p>
<h2>原始题面</h2>
<h3>题目背景</h3>
<p>${\rm CYJian}$: "听说 $gcd$ 和 $\sum$ 套起来比较好玩？？那我就......"</p>
<h3>题目描述</h3>
<p>${\rm CYJian}$ 最近闲的玩起了 $gcd$. 他想到了一个非常简单而有意思的式子:</p>
<p>$$
\prod_{i=1}^N\prod_{j=1}^N\frac{lcm(i,j)}{gcd(i,j)}\ (\bmod\ 104857601)
$$</p>
<p>${\rm CYJian}$ 已经算出来这个式子的值了. 现在请你帮他验算一下吧. ${\rm CYJian}$ 只给你 $0.2s$ 的时间哦</p>
<h3>输入输出格式</h3>
<h4>输入格式</h4>
<p>一行一个正整数 $N$</p>
<h4>输出格式</h4>
<p>一行一个正整数, 表示答案模 $104857601$ 的值</p>
<h3>输入输出样例</h3>
<h4>输入样例 #1</h4>
<pre><code class="language-input1">5
</code></pre>
<h4>输出样例 #1</h4>
<pre><code class="language-output1">585494
</code></pre>
<h3>说明</h3>
<p>样例解释:</p>
<p>| $\frac{lcm}{gcd}$ |  1  |  2  |  3  |  4  |  5  |
| :---------------: | :-: | :-: | :-: | :-: | :-: |
|       <strong>1</strong>       |  1  |  2  |  3  |  4  |  5  |
|       <strong>2</strong>       |  2  |  1  |  6  |  2  | 10  |
|       <strong>3</strong>       |  3  |  6  |  1  | 12  | 15  |
|       <strong>4</strong>       |  4  |  2  | 12  |  1  | 20  |
|       <strong>5</strong>       |  5  | 10  | 15  | 20  |  1  |</p>
<p>对于 $30%$ 的数据: $1 \leq N \leq 5000$</p>
<p>对于 $100%$ 的数据: $1 \leq N \leq 1000000$</p>
<h2>解题思路</h2>
<p>推式子</p>
<p>$$
\begin{aligned}
\prod_{i=1}^n\prod_{j=1}^n \frac{ij}{(i,j)^2} &amp; =\frac{(n!)^{2n}}{\prod_{i=1}^n\prod_{j=1}^n(i,j)^2} \
&amp; =\frac{(n!)^{2n}}{\prod_{d=1}^nd^{2\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}\sum_{j=1}^{\lfloor\frac{n}{d}\rfloor}[(i,j)=1]}} \
&amp; =\frac{(n!)^{2n}}{\prod_{d=1}^nd^{2\sum_{e=1}^{\lfloor\frac{n}{d}\rfloor}\mu(e)\lfloor\frac{n}{de}\rfloor^2}} \
\end{aligned}
$$</p>
<p>两层整除分块即可</p>
<h2>时间复杂度</h2>
<p>$O(n)$</p>
<h2>代码参考</h2>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% icodeweb cpa_cpp title:Luogu_P5221 Luogu/P5221/0.cpp %}</p>
<p>&lt;/details&gt;</p>
