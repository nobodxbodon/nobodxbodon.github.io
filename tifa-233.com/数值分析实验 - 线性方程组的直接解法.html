<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/numanaexp-05.md">仓库源文</a>，<a href="https://tifa-233.com/archives/numanaexp-05">站点原文</a></h2>
<hr/>
<p>title: 数值分析实验 - 线性方程组的直接解法
categories:</p>
<ul>
<li>笔记</li>
<li>数学</li>
<li>数值分析</li>
<li>实验报告
tags:</li>
<li>笔记</li>
<li>数学</li>
<li>数值分析</li>
<li>实验报告</li>
<li>MATLAB</li>
<li>线性方程组</li>
<li>Gauss消元</li>
<li>Gauss列主元消去法</li>
<li>平方根法</li>
<li>改进平方根法</li>
<li>追赶法
date: 2021-06-09 00:22:44</li>
</ul>
<hr/>
<p>数值分析实验 5 - 线性方程组的直接解法</p>
<p>&lt;!-- more --&gt;</p>
<h2>目的和意义</h2>
<p>给出下列几个不同类型的线性方程组, 请用适当算法计算其解</p>
<ol>
<li><p>线性方程组</p>
<p>$$
\begin{bmatrix}
4&amp;2&amp;-3&amp;-1&amp;2&amp;1&amp;0&amp;0&amp;0&amp;0\
8&amp;6&amp;-5&amp;-3&amp;6&amp;5&amp;0&amp;1&amp;0&amp;0\
4&amp;2&amp;-2&amp;-1&amp;3&amp;2&amp;-1&amp;0&amp;3&amp;1\
0&amp;-2&amp;1&amp;5&amp;-1&amp;3&amp;-1&amp;1&amp;9&amp;4\
-4&amp;2&amp;6&amp;-1&amp;6&amp;7&amp;-3&amp;3&amp;2&amp;3\
8&amp;6&amp;-8&amp;5&amp;7&amp;17&amp;2&amp;6&amp;-3&amp;5\
0&amp;2&amp;-1&amp;3&amp;-4&amp;2&amp;5&amp;3&amp;0&amp;1\
16&amp;10&amp;-11&amp;-9&amp;17&amp;34&amp;2&amp;-1&amp;2&amp;2\
4&amp;6&amp;2&amp;-7&amp;13&amp;9&amp;2&amp;0&amp;12&amp;4\
0&amp;0&amp;-1&amp;8&amp;-3&amp;-24&amp;-8&amp;6&amp;3&amp;-1\
\end{bmatrix}\begin{bmatrix}
x_1\x_2\x_3\x_4\x_5\x_6\x_7\x_8\x_9\x_{10}
\end{bmatrix}=\begin{bmatrix}
5\12\3\2\3\46\13\38\19\-21
\end{bmatrix}
$$</p>
</li>
<li><p>对称正定阵系数阵线方程组</p>
<p>$$
\begin{bmatrix}
4&amp;2&amp;-4&amp;0&amp;2&amp;4&amp;0&amp;0\
2&amp;2&amp;-1&amp;-2&amp;1&amp;3&amp;2&amp;0\
-4&amp;-1&amp;14&amp;1&amp;-8&amp;-3&amp;5&amp;6\
0&amp;-2&amp;1&amp;6&amp;-1&amp;-4&amp;-3&amp;3\
2&amp;1&amp;-8&amp;-1&amp;22&amp;4&amp;-10&amp;-3\
4&amp;3&amp;-3&amp;-4&amp;4&amp;11&amp;1&amp;-4\
0&amp;2&amp;5&amp;-3&amp;-10&amp;1&amp;14&amp;2\
0&amp;0&amp;6&amp;3&amp;-3&amp;-4&amp;2&amp;19\
\end{bmatrix}\begin{bmatrix}
x_1\x_2\x_3\x_4\x_5\x_6\x_7\x_8
\end{bmatrix}=\begin{bmatrix}
0\-6\20\23\9\-22\-15\45
\end{bmatrix}
$$</p>
</li>
<li><p>三对角形线性方程组</p>
<p>$$
\begin{bmatrix}
4&amp;-1&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;\
-1&amp;4&amp;-1&amp;&amp;&amp;&amp;&amp;&amp;&amp;\
&amp;-1&amp;4&amp;-1&amp;&amp;&amp;&amp;&amp;&amp;\
&amp;&amp;-1&amp;4&amp;-1&amp;&amp;&amp;&amp;&amp;\
&amp;&amp;&amp;-1&amp;4&amp;-1&amp;&amp;&amp;&amp;\
&amp;&amp;&amp;&amp;-1&amp;4&amp;-1&amp;&amp;&amp;\
&amp;&amp;&amp;&amp;&amp;-1&amp;4&amp;-1&amp;&amp;\
&amp;&amp;&amp;&amp;&amp;&amp;-1&amp;4&amp;-1&amp;\
&amp;&amp;&amp;&amp;&amp;&amp;&amp;-1&amp;4&amp;-1\
&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;-1&amp;4\
\end{bmatrix}\begin{bmatrix}
x_1\x_2\x_3\x_4\x_5\x_6\x_7\x_8\x_9\x_{10}
\end{bmatrix}=\begin{bmatrix}
7\5\-13\2\6\-12\14\-4\5\-5
\end{bmatrix}
$$</p>
</li>
</ol>
<h3>要求</h3>
<ol>
<li>对上述三个方程组分别利用 Gauss 顺序消去法与 Gauss 列主元消去法; 平方根法与改进平方根法; 追赶法求解 (选择其一)</li>
<li>应用结构程序设计编出通用程序</li>
<li>比较计算结果, 分析数值解误差的原因</li>
<li>尽可能利用相应模块输出系数矩阵的三角分解式</li>
</ol>
<h3>目的和意义</h3>
<ol>
<li>通过该课题的实验, 体会模块化结构程序设计方法的优点</li>
<li>运用所学的计算方法, 解决各类线性方程组的直接算法</li>
<li>提高分析和解决问题的能力, 做到学以致用</li>
<li>通过三对角形线性方程组的解法, 体会稀疏线性方程组解法的特点</li>
</ol>
<h2>计算公式</h2>
<h3>Gauss 消元法</h3>
<p>任意情况均可使用</p>
<p>过程即将系数矩阵通过初等行变换化为上三角矩阵或下三角矩阵, 之后回代即可</p>
<h3>平方根法</h3>
<p>当系数矩阵为<strong>对称正定矩阵</strong>时可以使用</p>
<p>设方程组为 $Ax=b$</p>
<p>对系数矩阵 $A$ 做分解</p>
<p>$$
A=LL^T
$$</p>
<p>其中 $L=(l_{ij})$ 为下三角矩阵,</p>
<p>$$
l_{ij}=\begin{cases}
\sqrt{a_{ii}-\sum_{k=1}^{i-1}l_{ik}^2},&amp;i=j\
\displaystyle{a_{ij}-\sum_{k=1}^{j-1}l_{ik}l_{jk}\over l_{jj}},&amp;i\ne j
\end{cases}
$$</p>
<p>接下来计算</p>
<p>$$
\begin{cases}
Ly=b\
L^Tx=y
\end{cases}
$$</p>
<p>即可</p>
<h3>改进平方根法</h3>
<p>当系数矩阵为<strong>对称正定矩阵</strong>时可以使用</p>
<p>设方程组为 $Ax=b$</p>
<p>对系数矩阵 $A$ 做分解</p>
<p>$$
A=LDL^T
$$</p>
<p>其中 $L=(l_{ij})$ 为下三角矩阵, $D=(d_{i})$ 为对角矩阵, 令 $t_{ij}=l_{ij}d_j$, 有</p>
<p>$$
t_{ij}=a_{ij}-\sum_{k=1}^{j-1}t_{ik}l_{jk}
$$</p>
<p>$$
d_{i}=a_{ii}-\sum_{k=1}^{i-1}t_{ik}l_{ik}
$$</p>
<p>接下来计算</p>
<p>$$
\begin{cases}
Ly=b\
L^Tx=D^{-1}y
\end{cases}
$$</p>
<p>即可</p>
<h3>追赶法</h3>
<p>当系数矩阵为<strong>三对角矩阵</strong>时可以使用</p>
<p>设方程组为 $Ax=d$</p>
<p>对系数矩阵做分解</p>
<p>$$
A=\begin{bmatrix}
b_1&amp;c_1&amp;&amp;&amp;\
a_2&amp;b_2&amp;c_2&amp;&amp;\
&amp;\ddots&amp;\ddots&amp;\ddots&amp;\
&amp;&amp;a_{n-1}&amp;b_{n-1}&amp;c_{n-1}\
&amp;&amp;&amp;a_n&amp;b_n
\end{bmatrix}=\begin{bmatrix}
\alpha_1&amp;&amp;&amp;&amp;\
\gamma_2&amp;\alpha_2&amp;&amp;&amp;\
&amp;\ddots&amp;\ddots&amp;&amp;\
&amp;&amp;\gamma_{n-1}&amp;\alpha_{n-1}&amp;\
&amp;&amp;&amp;\gamma_n&amp;\alpha_n
\end{bmatrix}\begin{bmatrix}
1&amp;\beta_1&amp;&amp;&amp;\
&amp;1&amp;\beta_2&amp;&amp;\
&amp;&amp;\ddots&amp;\ddots&amp;\
&amp;&amp;&amp;1&amp;\beta_{n-1}\
&amp;&amp;&amp;&amp;1
\end{bmatrix}
$$</p>
<p>有</p>
<p>$$
\alpha_i=b_i-a_i\beta_{i-1}
$$</p>
<p>$$
\beta_i=\frac{c_i}{\alpha_i}
$$</p>
<p>$$
\gamma_i=a_i
$$</p>
<p>令</p>
<p>$$
L=\begin{bmatrix}
\alpha_1&amp;&amp;&amp;&amp;\
\gamma_2&amp;\alpha_2&amp;&amp;&amp;\
&amp;\ddots&amp;\ddots&amp;&amp;\
&amp;&amp;\gamma_{n-1}&amp;\alpha_{n-1}&amp;\
&amp;&amp;&amp;\gamma_n&amp;\alpha_n
\end{bmatrix},~U=\begin{bmatrix}
1&amp;\beta_1&amp;&amp;&amp;\
&amp;1&amp;\beta_2&amp;&amp;\
&amp;&amp;\ddots&amp;\ddots&amp;\
&amp;&amp;&amp;1&amp;\beta_{n-1}\
&amp;&amp;&amp;&amp;1
\end{bmatrix}
$$</p>
<p>接下来计算</p>
<p>$$
\begin{cases}
Ly=d\
Ux=y
\end{cases}
$$</p>
<p>即可</p>
<h2>程序设计</h2>
<h3>主程序</h3>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% include_code lang:matlab numanaexp-05/main.m %}</p>
<p>&lt;/details&gt;</p>
<h3>输入数据检查</h3>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% include_code lang:matlab numanaexp-05/input_check.m %}</p>
<p>&lt;/details&gt;</p>
<h3>Gauss 顺序消去法</h3>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% include_code lang:matlab numanaexp-05/gauss_basic.m %}</p>
<p>&lt;/details&gt;</p>
<h3>Gauss 列主元消去法</h3>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% include_code lang:matlab numanaexp-05/gauss_advanced.m %}</p>
<p>&lt;/details&gt;</p>
<h3>平方根法</h3>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% include_code lang:matlab numanaexp-05/sqrt_basic.m %}</p>
<p>&lt;/details&gt;</p>
<h3>改进平方根法</h3>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% include_code lang:matlab numanaexp-05/sqrt_advanced.m %}</p>
<p>&lt;/details&gt;</p>
<h3>追赶法</h3>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% include_code lang:matlab numanaexp-05/chase.m %}</p>
<p>&lt;/details&gt;</p>
<h2>结果讨论和分析</h2>
<h3>结果</h3>
<ul>
<li><p>解</p>
<ul>
<li><p>方程组 1</p>
<pre><code class="language-text">[1, -1, 0, 1, 2, 0, 3, 1, -1, 2]
</code></pre>
</li>
<li><p>方程组 2</p>
<pre><code class="language-text">[3271/27, -9948/71, 4790/161, -4331/72, 2357/216, -1447/54, 293/54, -109/54]
</code></pre>
</li>
<li><p>方程组 3</p>
<pre><code class="language-text">[2, 1, -3, 0, 1, -2, 3, 0, 1, -1]
</code></pre>
</li>
</ul>
</li>
<li><p>系数矩阵的 LU 分解</p>
<ul>
<li><p>方程组 1</p>
<pre><code class="language-text">L =

[  1,  0,  0,  0,  0,     0,   0,   0,        0, 0]
[  2,  1,  0,  0,  0,     0,   0,   0,        0, 0]
[  1,  0,  1,  0,  0,     0,   0,   0,        0, 0]
[  0, -1,  2,  1,  0,     0,   0,   0,        0, 0]
[ -1,  2,  1,  0,  1,     0,   0,   0,        0, 0]
[  2,  1, -3,  2,  2,     1,   0,   0,        0, 0]
[  0,  1, -2,  1, -1,  -2/5,   1,   0,        0, 0]
[  4,  1,  0, -1,  2,  29/5,   3,   1,        0, 0]
[  1,  2,  3, -1,  1,   2/5,  19,  -6,        1, 0]
[  0,  0, -1,  2,  0, -31/5, -12, 3/2, -131/250, 1]

U =

[ 4, 2, -3, -1,  2, 1,   0,   0,    0,       0]
[ 0, 2,  1, -1,  2, 3,   0,   1,    0,       0]
[ 0, 0,  1,  0,  1, 1,  -1,   0,    3,       1]
[ 0, 0,  0,  4, -1, 4,   1,   2,    3,       2]
[ 0, 0,  0,  0,  3, 1,  -2,   1,   -1,       2]
[ 0, 0,  0,  0,  0, 5,   1,  -1,    2,       0]
[ 0, 0,  0,  0,  0, 0, 2/5, 3/5, 14/5,       3]
[ 0, 0,  0,  0,  0, 0,   0,   2,  -13,      -9]
[ 0, 0,  0,  0,  0, 0,   0,   0, -125,    -110]
[ 0, 0,  0,  0,  0, 0,   0,   0,    0, -607/50]
</code></pre>
</li>
<li><p>方程组 2</p>
<pre><code class="language-text">L =

[   1,  0,    0,  0,    0,  0,   0, 0]
[ 1/2,  1,    0,  0,    0,  0,   0, 0]
[  -1,  1,    1,  0,    0,  0,   0, 0]
[   0, -2,  1/3,  1,    0,  0,   0, 0]
[ 1/2,  0, -2/3,  1,    1,  0,   0, 0]
[   1,  1,    0, -2,  1/4,  1,   0, 0]
[   0,  2,  1/3,  0, -1/2,  1,   1, 0]
[   0,  0,  2/3,  1,    0, -2, 1/2, 1]

U =

[ 4, 2, -4,  0,  2,  4,  0,  0]
[ 0, 1,  1, -2,  0,  1,  2,  0]
[ 0, 0,  9,  3, -6,  0,  3,  6]
[ 0, 0,  0,  1,  1, -2,  0,  1]
[ 0, 0,  0,  0, 16,  4, -8,  0]
[ 0, 0,  0,  0,  0,  1,  1, -2]
[ 0, 0,  0,  0,  0,  0,  4,  2]
[ 0, 0,  0,  0,  0,  0,  0,  9]
</code></pre>
</li>
<li><p>方程组 3</p>
<pre><code class="language-text">L =

[    1,     0,      0,       0,        0,         0,           0,            0,             0, 0]
[ -1/4,     1,      0,       0,        0,         0,           0,            0,             0, 0]
[    0, -4/15,      1,       0,        0,         0,           0,            0,             0, 0]
[    0,     0, -15/56,       1,        0,         0,           0,            0,             0, 0]
[    0,     0,      0, -56/209,        1,         0,           0,            0,             0, 0]
[    0,     0,      0,       0, -209/780,         1,           0,            0,             0, 0]
[    0,     0,      0,       0,        0, -780/2911,           1,            0,             0, 0]
[    0,     0,      0,       0,        0,         0, -2911/10864,            1,             0, 0]
[    0,     0,      0,       0,        0,         0,           0, -10864/40545,             1, 0]
[    0,     0,      0,       0,        0,         0,           0,            0, -40545/151316, 1]

U =

[ 4,   -1,     0,      0,       0,        0,          0,           0,            0,             0]
[ 0, 15/4,    -1,      0,       0,        0,          0,           0,            0,             0]
[ 0,    0, 56/15,     -1,       0,        0,          0,           0,            0,             0]
[ 0,    0,     0, 209/56,      -1,        0,          0,           0,            0,             0]
[ 0,    0,     0,      0, 780/209,       -1,          0,           0,            0,             0]
[ 0,    0,     0,      0,       0, 2911/780,         -1,           0,            0,             0]
[ 0,    0,     0,      0,       0,        0, 10864/2911,          -1,            0,             0]
[ 0,    0,     0,      0,       0,        0,          0, 40545/10864,           -1,             0]
[ 0,    0,     0,      0,       0,        0,          0,           0, 151316/40545,            -1]
[ 0,    0,     0,      0,       0,        0,          0,           0,            0, 564719/151316]
</code></pre>
</li>
</ul>
</li>
<li><p>耗时 (s)</p>
<p>|     | Gauss 顺序消去法 | Gauss 列主元消去法 | 平方根法 | 改进平方根法 | 追赶法 |
| --- | ---------------- | ------------------ | -------- | ------------ | ------ |
| 1   | 0.012            | 0.005              | -        | -            | -      |
| 2   | 0.004            | 0.006              | 0.015    | 0.013        | -      |
| 3   | 0.004            | 0.005              | 0.008    | 0.007        | 0.004  |</p>
</li>
</ul>
<h3>分析</h3>
<ul>
<li>Gauss 消元法的适用范围最广</li>
<li>平方根法只适用于对称正定矩阵</li>
<li>追赶法只适用于三对角矩阵</li>
<li>由于两种 Gauss 消元法均使用向量化编程, 故其运行效率较高</li>
</ul>
