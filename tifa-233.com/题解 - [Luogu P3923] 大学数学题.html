<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/luogu-p3923.md">仓库源文</a>，<a href="https://tifa-233.com/archives/luogu-p3923">站点原文</a></h2>
<p><a href="https://www.luogu.com.cn/problem/P3923">题目链接</a></p>
&lt;!-- more --&gt;

<h2>原始题面</h2>
<h3>题目背景</h3>
<p>琪露诺: 我知道了! 答案一定是 1!</p>
<p>露米娅: 什么鬼啊 (汗), 你还是再想想去吧... 我先把最后一道题给你, 这是一道大学数学题哦</p>
<h3>题目描述</h3>
<p>露米娅: 大妖精想构造一个 $n$ 元有限域, 元素用 $0 \sim n - 1$ 的整数表示 有限域需要满足以下条件</p>
<ol>
<li>有加法单位元 $o$, 满足对于任意元素 $a$, $o + a = a + o = a$</li>
<li>对于任意元素 $a$, 存在加法逆元 $a^{-1}$, 使得 $a + a^{-1} = a^{-1} + a = o$</li>
<li>有不同于加法单位元 $o$ 的乘法单位元 $i$, 满足对于任意元素 $a$, $i \times a = a \times i = a$</li>
<li>对于任意非加法单位元元素 $a$, 存在乘法逆元 $a^{-1}$, 使得 $a \times a^{-1} = a^{-1} \times a = i$</li>
<li>对于任意元素 $x$, $y$, 有加法交换律, 即 $x + y = y + x$</li>
<li>对于任意元素 $x$, $y$, 有乘法交换律, 即 $x \times y = y \times x$</li>
<li>对于任意元素 $x$, $y$, $z$, 有加法结合律, 即 $(x + y) + z = x + (y + z)$</li>
<li>对于任意元素 $x$, $y$, $z$, 有乘法结合律, 即 $(x \times y) \times z = x \times (y \times z)$</li>
<li>对于任意元素 $x$,$y$,$z$, 有乘法分配律, 即 $(x + y) \times z = x \times z + y \times z$</li>
</ol>
<p>大妖精当然会做啦, 但是他想考考你</p>
<p>在输出中加法单位元 $o$ 即为 $0$, 乘法单位元 $i$ 即为 $1$</p>
<h3>输入输出格式</h3>
<h4>输入格式</h4>
<p>一个正整数 $n$</p>
<p>$2 \leq n \leq 350$</p>
<h4>输出格式</h4>
<p>第一行输出一个正整数 $k$, 若存在 $n$ 元有限域则 $k = 0$, 否则 $k = -1$</p>
<p>若 $k = 0$ 则</p>
<ol>
<li>接下来 $n$ 行输出一个 $n$ 元有限域的加法表, 第 $i + 1$ 行第 $j + 1$ 列上的数代表有限域中 $i + j$ 的运算结果</li>
<li>接下来 $n$ 行输出一个 $n$ 元有限域的乘法表, 第 $i + 1$ 行第 $j + 1$ 列上的数代表有限域中 $i \times j$ 的运算结果</li>
</ol>
<p>共输出 $n \times 2 + 1$ 行</p>
<p>upd1:SPJ 非常严格, 请不要在行末输出多余空格</p>
<p>(答案文件末尾的换行还是会自动忽略的)</p>
<p>upd2:正解文件比较大, 洛谷可能会一直 judging...</p>
<p>如果遇到这种情况请直接提交源代码</p>
<h3>输入输出样例</h3>
<h4>输入样例 #1</h4>
<pre><code class="lang-input1">2
</code></pre>
<h4>输出样例 #1</h4>
<pre><code class="lang-output1">0
0 1
1 0
0 0
0 1
</code></pre>
<h3>说明</h3>
<table>
<thead><tr>
<th style="text-align:center">测试点</th>
<th style="text-align:center">[$n$ 的范围]</th>
<th style="text-align:center">特殊性质</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">[$n = 3$]</td>
<td style="text-align:center">$n$ 是质数</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">[$n = 4$]</td>
<td style="text-align:center">$n$ 是 2 的整数次方</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">[$n = 6$]</td>
<td style="text-align:center">无</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">[$n = 8$]</td>
<td style="text-align:center">$n$ 是 2 的整数次方</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">[$n = 9$]</td>
<td style="text-align:center">无</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">[$n = 19$]</td>
<td style="text-align:center">$n$ 是质数</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">[$n = 89$]</td>
<td style="text-align:center">$n$ 是质数</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">[$n = 181$]</td>
<td style="text-align:center">$n$ 是质数</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">[$n = 233$]</td>
<td style="text-align:center">$n$ 是质数</td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:center">[$n = 25$]</td>
<td style="text-align:center">$n$ 是质数的平方</td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:center">[$n = 121$]</td>
<td style="text-align:center">$n$ 是质数的平方</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:center">[$n = 169$]</td>
<td style="text-align:center">$n$ 是质数的平方</td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td style="text-align:center">[$n = 27$]</td>
<td style="text-align:center">无</td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:center">[$n = 143$]</td>
<td style="text-align:center">无</td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td style="text-align:center">[$n = 128$]</td>
<td style="text-align:center">$n$ 是 2 的整数次方</td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td style="text-align:center">[$n = 81$]</td>
<td style="text-align:center">无</td>
</tr>
<tr>
<td style="text-align:center">17</td>
<td style="text-align:center">[$n = 125$]</td>
<td style="text-align:center">无</td>
</tr>
<tr>
<td style="text-align:center">18</td>
<td style="text-align:center">[$n = 243$]</td>
<td style="text-align:center">无</td>
</tr>
<tr>
<td style="text-align:center">19</td>
<td style="text-align:center">[$n = 256$]</td>
<td style="text-align:center">$n$ 是 2 的整数次方</td>
</tr>
<tr>
<td style="text-align:center">20</td>
<td style="text-align:center">[$n = 343$]</td>
<td style="text-align:center">无</td>
</tr>
</tbody>
</table>
<h2>题意简述</h2>
<p>构造一个 $n$ 元有限域 $\mathbb{E}_n$, 不存在时输出 <code>-1</code></p>
<h2>解题思路</h2>
<p>抽代题是吧... 我直接进行一个定理的摆</p>
<p>我们称没有真子域的域为素域</p>
<p>首先域的特征要么为 $0$, 要么为素数 $p$, 进一步我们有</p>
<p>{% note success no-icon %}</p>
<p><strong>&lt;a id="th-1"&gt;定理 - 1&lt;/a&gt;</strong> 任意一个域 $\mathbb{F}$ 都含且仅含一个素域</p>
<ul>
<li>当 $\operatorname{char}(\mathbb{F})=0$ 时, $\mathbb{F}$ 的素域与 $\mathbb{Q}$ 同构</li>
<li>当 $\operatorname{char}(\mathbb{F})=p$ 时, $\mathbb{F}$ 的素域与 $\mathbb{Z}_p$ 同构</li>
</ul>
<p>进一步, 两个域的特征相同当且仅当其素域同构</p>
&lt;details open&gt;
&lt;summary&gt;证明&lt;/summary&gt;

令

$$
\{\mathbb{F}_i|\mathbb{F}_i\leqslant \mathbb{F},i\in I\}
$$

为 $\mathbb{F}$ 全体子域构成的集合, 显然其交集 $\mathbb{P}$ 非空,且

- $\mathbb{P}\leqslant\mathbb{F}$
- $\mathbb{P}$ 为 $\mathbb{F}$ 的唯一素域

我们构造如下映射

$$
\begin{aligned}
  \varphi:\mathbb{Z}&amp;\to\mathbb{P}\\
  m&amp;\mapsto me
\end{aligned}
$$

其中 $e$ 为 $\mathbb{F}$ 的幺元, 显然 $\varphi$ 为同态映射

- 若 $\operatorname{char}(\mathbb{F})=0$, 则 $\ker\varphi=\{0\}$, 令

  $$
  R_e:=\{me|m\in\mathbb{Z}\}
  $$

  由同态基本定理, $R_e\cong\mathbb{Z}$, $R_e$ 为一整环, 从而其分式域 $\mathbb{F}_e\cong\mathbb{Q}$

  显然

  - $\mathbb{F}_e\leqslant\mathbb{F}$
  - $\mathbb{F}$ 任一素域均包含 $\mathbb{F}_e$

  故 $\mathbb{F}_e$ 即为 $\mathbb{F}$ 同构于 $\mathbb{Q}$ 的素域

- 若 $\operatorname{char}(\mathbb{F})=p$, 则 $\ker\varphi=\{p\}$, 令

  $$
  R_e:=\{0,e,2e,...,(p-1)e\}
  $$

  由同态基本定理, $R_e\cong\mathbb{Z}_p$, 而 $\mathbb{Z}_p$ 显然为素域, 故 $R_e$ 即为 $\mathbb{F}$ 同构于 $\mathbb{Z}_p$ 的素域

&lt;/details&gt;<p>{% endnote %}</p>
<p>令 $n$ 元有限域为 $\mathbb{E}_n$, 显然其特征必为素数, 故 $n=6$ 和 $n=143$ 的情况直接输出 <code>-1</code> 即可</p>
<p>记 $\mathbb{E}_n$ 的素域为 $\mathbb{F}_p$, 其中 $p$ 为 $\mathbb{E}_n$ 的特征</p>
<p>{% note success no-icon %}</p>
<p><strong>&lt;a id="th-2"&gt;定理 - 2&lt;/a&gt;</strong> $\forall p\in\text{Prime}^+,m\in\mathbb{N}^+$, $p^m$ 阶有限域必存在且在 $\mathbb{F}_p$-同构意义下是唯一的</p>
&lt;details open&gt;
&lt;summary&gt;证明&lt;/summary&gt;

令 $f(x)=x^{p^m}-x\in\mathbb{F}_p[x]$, 作 $\mathbb{F}_p$ 关于 $f(x)$ 的分裂域

$$
\mathbb{E}=\mathbb{F}_p(\alpha_0,\alpha_1,\dots,\alpha_{p^m})
$$

其中 $\alpha_0,\alpha_1,\dots,\alpha_{p^m}$ 为 $f(x)$ 在 $\mathbb{E}$ 中的根

又由 $\operatorname{char}(\mathbb{F}_p)=p$ 知, $f'(x)=-1$, 从而 $(f(x),f'(x))=1$, 即 $f(x)$ 无重根

令 $\mathbb{L}=\{\alpha_0,\alpha_1,\dots,\alpha_{p^m}\}$, 则 $\forall\alpha_i,\alpha_j\in\mathbb{L}$

- $$
  (\alpha_i-\alpha_j)^{p^m}=\alpha_i-\alpha_j\in\mathbb{L}
  $$
- $$
  \left(\frac{\alpha_i}{\alpha_j}\right)^{p^m}=\frac{\alpha_i}{\alpha_j}\in\mathbb{L},~(\alpha_j\ne 0)
  $$

故 $\mathbb{L}\leqslant\mathbb{E}$

又 $\mathbb{F}_p\leqslant\mathbb{L}$, 故 $\mathbb{E}\leqslant\mathbb{L}$

从而 $\mathbb{E}=\mathbb{L}$, $|\mathbb{E}|=|\mathbb{L}|=p^m$

&lt;/details&gt;<p>{% endnote %}</p>
<p>故其他数据点均可以构造</p>
<p>首先, 我们知道, $\forall p\in\text{Prime}^+$, $(\mathbb{Z}_p,+,\cdot)$ 为一个域</p>
<p>接下来我们尝试构造素数幂次阶的有限域</p>
<p>{% note success no-icon %}</p>
<p><strong>&lt;a id="th-3"&gt;定理 - 3&lt;/a&gt;</strong> 令 $p(x)$ 为 $\mathbb{F}_p[x]$ 中一 $m$ 次首 1 不可约多项式 ($m\geqslant 1$), 则</p>
<p>$$
\mathbb{F}<em>p[x]/\lang p(x)\rang=\left{\sum</em>{i=0}^{m-1}a_ix^i+\lang p(x)\rang\bigg|a_i\in\mathbb{F}_p,~i=0,1,...m-1\right}
$$</p>
<p>为一阶为 $p^m$ 的有限域</p>
&lt;details open&gt;
&lt;summary&gt;证明&lt;/summary&gt;

易得 $\lang p(x)\rang$ 为 $\mathbb{F}_p[x]$ 的极大理想, 从而 $\mathbb{F}_p[x]/\lang p(x)\rang$ 为一域

由 $\mathbb{F}_p$ 为阶为 $p$ 的素域, 易得

$$
|\mathbb{F}_p[x]/\lang p(x)\rang|=p^m
$$

&lt;/details&gt;<p>{% endnote %}</p>
<p>我们将 $\mathbb{F}_p[x]/\lang p(x)\rang$ 中的多项式看作 $p$ 进制数, 不难发现这个操作是同构映射, 故这题我们就做完了</p>
<h2>代码参考</h2>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_py title:Luogu_P3923 Luogu/P3923/0.py %}

&lt;/details&gt;