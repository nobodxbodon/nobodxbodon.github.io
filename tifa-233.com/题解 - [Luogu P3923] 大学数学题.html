<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/luogu-p3923.md">仓库源文</a>，<a href="https://tifa-233.com/luogu-p3923">站点原文</a></h2>
<hr/>
<p>title: "题解 - [Luogu P3923] 大学数学题"
categories:</p>
<ul>
<li>算法竞赛</li>
<li>题解
tags:</li>
<li>算法竞赛</li>
<li>题解</li>
<li>洛谷</li>
<li>数学</li>
<li>构造</li>
<li>代数</li>
<li>抽象代数</li>
<li>特征</li>
<li>域</li>
<li>素域</li>
<li>有限域</li>
<li>分裂域</li>
<li>同态基本定理</li>
<li>理想</li>
<li>极大理想</li>
<li>多项式</li>
<li>卷积
date: 2021-11-17 13:38:14</li>
</ul>
<hr/>
<p><a href="https://www.luogu.com.cn/problem/P3923">题目链接</a></p>
<p>&lt;!-- more --&gt;</p>
<h2>原始题面</h2>
<h3>题目背景</h3>
<p>琪露诺: 我知道了! 答案一定是 1!</p>
<p>露米娅: 什么鬼啊 (汗), 你还是再想想去吧... 我先把最后一道题给你, 这是一道大学数学题哦</p>
<h3>题目描述</h3>
<p>露米娅: 大妖精想构造一个 $n$ 元有限域, 元素用 $0 \sim n - 1$ 的整数表示 有限域需要满足以下条件</p>
<ol>
<li>有加法单位元 $o$, 满足对于任意元素 $a$, $o + a = a + o = a$</li>
<li>对于任意元素 $a$, 存在加法逆元 $a^{-1}$, 使得 $a + a^{-1} = a^{-1} + a = o$</li>
<li>有不同于加法单位元 $o$ 的乘法单位元 $i$, 满足对于任意元素 $a$, $i \times a = a \times i = a$</li>
<li>对于任意非加法单位元元素 $a$, 存在乘法逆元 $a^{-1}$, 使得 $a \times a^{-1} = a^{-1} \times a = i$</li>
<li>对于任意元素 $x$, $y$, 有加法交换律, 即 $x + y = y + x$</li>
<li>对于任意元素 $x$, $y$, 有乘法交换律, 即 $x \times y = y \times x$</li>
<li>对于任意元素 $x$, $y$, $z$, 有加法结合律, 即 $(x + y) + z = x + (y + z)$</li>
<li>对于任意元素 $x$, $y$, $z$, 有乘法结合律, 即 $(x \times y) \times z = x \times (y \times z)$</li>
<li>对于任意元素 $x$,$y$,$z$, 有乘法分配律, 即 $(x + y) \times z = x \times z + y \times z$</li>
</ol>
<p>大妖精当然会做啦, 但是他想考考你</p>
<p>在输出中加法单位元 $o$ 即为 $0$, 乘法单位元 $i$ 即为 $1$</p>
<h3>输入输出格式</h3>
<h4>输入格式</h4>
<p>一个正整数 $n$</p>
<p>$2 \leq n \leq 350$</p>
<h4>输出格式</h4>
<p>第一行输出一个正整数 $k$, 若存在 $n$ 元有限域则 $k = 0$, 否则 $k = -1$</p>
<p>若 $k = 0$ 则</p>
<ol>
<li>接下来 $n$ 行输出一个 $n$ 元有限域的加法表, 第 $i + 1$ 行第 $j + 1$ 列上的数代表有限域中 $i + j$ 的运算结果</li>
<li>接下来 $n$ 行输出一个 $n$ 元有限域的乘法表, 第 $i + 1$ 行第 $j + 1$ 列上的数代表有限域中 $i \times j$ 的运算结果</li>
</ol>
<p>共输出 $n \times 2 + 1$ 行</p>
<p>upd1:SPJ 非常严格, 请不要在行末输出多余空格</p>
<p>(答案文件末尾的换行还是会自动忽略的)</p>
<p>upd2:正解文件比较大, 洛谷可能会一直 judging...</p>
<p>如果遇到这种情况请直接提交源代码</p>
<h3>输入输出样例</h3>
<h4>输入样例 #1</h4>
<pre><code class="language-input1">2
</code></pre>
<h4>输出样例 #1</h4>
<pre><code class="language-output1">0
0 1
1 0
0 0
0 1
</code></pre>
<h3>说明</h3>
<p>| 测试点 | [$n$ 的范围] |      特殊性质       |
| :----: | :----------: | :-----------------: |
|   1    |  [$n = 3$]   |     $n$ 是质数      |
|   2    |  [$n = 4$]   | $n$ 是 2 的整数次方 |
|   3    |  [$n = 6$]   |         无          |
|   4    |  [$n = 8$]   | $n$ 是 2 的整数次方 |
|   5    |  [$n = 9$]   |         无          |
|   6    |  [$n = 19$]  |     $n$ 是质数      |
|   7    |  [$n = 89$]  |     $n$ 是质数      |
|   8    | [$n = 181$]  |     $n$ 是质数      |
|   9    | [$n = 233$]  |     $n$ 是质数      |
|   10   |  [$n = 25$]  |  $n$ 是质数的平方   |
|   11   | [$n = 121$]  |  $n$ 是质数的平方   |
|   12   | [$n = 169$]  |  $n$ 是质数的平方   |
|   13   |  [$n = 27$]  |         无          |
|   14   | [$n = 143$]  |         无          |
|   15   | [$n = 128$]  | $n$ 是 2 的整数次方 |
|   16   |  [$n = 81$]  |         无          |
|   17   | [$n = 125$]  |         无          |
|   18   | [$n = 243$]  |         无          |
|   19   | [$n = 256$]  | $n$ 是 2 的整数次方 |
|   20   | [$n = 343$]  |         无          |</p>
<h2>题意简述</h2>
<p>构造一个 $n$ 元有限域 $\mathbb{E}_n$, 不存在时输出 <code>-1</code></p>
<h2>解题思路</h2>
<p>抽代题是吧... 我直接进行一个定理的摆</p>
<p>我们称没有真子域的域为素域</p>
<p>首先域的特征要么为 $0$, 要么为素数 $p$, 进一步我们有</p>
<p>{% note success no-icon %}</p>
<p><strong>&lt;a id="th-1"&gt;定理 - 1&lt;/a&gt;</strong> 任意一个域 $\mathbb{F}$ 都含且仅含一个素域</p>
<ul>
<li>当 $\operatorname{char}(\mathbb{F})=0$ 时, $\mathbb{F}$ 的素域与 $\mathbb{Q}$ 同构</li>
<li>当 $\operatorname{char}(\mathbb{F})=p$ 时, $\mathbb{F}$ 的素域与 $\mathbb{Z}_p$ 同构</li>
</ul>
<p>进一步, 两个域的特征相同当且仅当其素域同构</p>
<p>&lt;details open&gt;
&lt;summary&gt;证明&lt;/summary&gt;</p>
<p>令</p>
<p>$$
{\mathbb{F}_i|\mathbb{F}_i\leqslant \mathbb{F},i\in I}
$$</p>
<p>为 $\mathbb{F}$ 全体子域构成的集合, 显然其交集 $\mathbb{P}$ 非空,且</p>
<ul>
<li>$\mathbb{P}\leqslant\mathbb{F}$</li>
<li>$\mathbb{P}$ 为 $\mathbb{F}$ 的唯一素域</li>
</ul>
<p>我们构造如下映射</p>
<p>$$
\begin{aligned}
\varphi:\mathbb{Z}&amp;\to\mathbb{P}\
m&amp;\mapsto me
\end{aligned}
$$</p>
<p>其中 $e$ 为 $\mathbb{F}$ 的幺元, 显然 $\varphi$ 为同态映射</p>
<ul>
<li><p>若 $\operatorname{char}(\mathbb{F})=0$, 则 $\ker\varphi={0}$, 令</p>
<p>$$
R_e:={me|m\in\mathbb{Z}}
$$</p>
<p>由同态基本定理, $R_e\cong\mathbb{Z}$, $R_e$ 为一整环, 从而其分式域 $\mathbb{F}_e\cong\mathbb{Q}$</p>
<p>显然</p>
<ul>
<li>$\mathbb{F}_e\leqslant\mathbb{F}$</li>
<li>$\mathbb{F}$ 任一素域均包含 $\mathbb{F}_e$</li>
</ul>
<p>故 $\mathbb{F}_e$ 即为 $\mathbb{F}$ 同构于 $\mathbb{Q}$ 的素域</p>
</li>
<li><p>若 $\operatorname{char}(\mathbb{F})=p$, 则 $\ker\varphi={p}$, 令</p>
<p>$$
R_e:={0,e,2e,...,(p-1)e}
$$</p>
<p>由同态基本定理, $R_e\cong\mathbb{Z}_p$, 而 $\mathbb{Z}_p$ 显然为素域, 故 $R_e$ 即为 $\mathbb{F}$ 同构于 $\mathbb{Z}_p$ 的素域</p>
</li>
</ul>
<p>&lt;/details&gt;</p>
<p>{% endnote %}</p>
<p>令 $n$ 元有限域为 $\mathbb{E}_n$, 显然其特征必为素数, 故 $n=6$ 和 $n=143$ 的情况直接输出 <code>-1</code> 即可</p>
<p>记 $\mathbb{E}_n$ 的素域为 $\mathbb{F}_p$, 其中 $p$ 为 $\mathbb{E}_n$ 的特征</p>
<p>{% note success no-icon %}</p>
<p><strong>&lt;a id="th-2"&gt;定理 - 2&lt;/a&gt;</strong> $\forall p\in\text{Prime}^+,m\in\mathbb{N}^+$, $p^m$ 阶有限域必存在且在 $\mathbb{F}_p$-同构意义下是唯一的</p>
<p>&lt;details open&gt;
&lt;summary&gt;证明&lt;/summary&gt;</p>
<p>令 $f(x)=x^{p^m}-x\in\mathbb{F}_p[x]$, 作 $\mathbb{F}_p$ 关于 $f(x)$ 的分裂域</p>
<p>$$
\mathbb{E}=\mathbb{F}<em>p(\alpha_0,\alpha_1,\dots,\alpha</em>{p^m})
$$</p>
<p>其中 $\alpha_0,\alpha_1,\dots,\alpha_{p^m}$ 为 $f(x)$ 在 $\mathbb{E}$ 中的根</p>
<p>又由 $\operatorname{char}(\mathbb{F}_p)=p$ 知, $f'(x)=-1$, 从而 $(f(x),f'(x))=1$, 即 $f(x)$ 无重根</p>
<p>令 $\mathbb{L}={\alpha_0,\alpha_1,\dots,\alpha_{p^m}}$, 则 $\forall\alpha_i,\alpha_j\in\mathbb{L}$</p>
<ul>
<li>$$
(\alpha_i-\alpha_j)^{p^m}=\alpha_i-\alpha_j\in\mathbb{L}
$$</li>
<li>$$
\left(\frac{\alpha_i}{\alpha_j}\right)^{p^m}=\frac{\alpha_i}{\alpha_j}\in\mathbb{L},~(\alpha_j\ne 0)
$$</li>
</ul>
<p>故 $\mathbb{L}\leqslant\mathbb{E}$</p>
<p>又 $\mathbb{F}_p\leqslant\mathbb{L}$, 故 $\mathbb{E}\leqslant\mathbb{L}$</p>
<p>从而 $\mathbb{E}=\mathbb{L}$, $|\mathbb{E}|=|\mathbb{L}|=p^m$</p>
<p>&lt;/details&gt;</p>
<p>{% endnote %}</p>
<p>故其他数据点均可以构造</p>
<p>首先, 我们知道, $\forall p\in\text{Prime}^+$, $(\mathbb{Z}_p,+,\cdot)$ 为一个域</p>
<p>接下来我们尝试构造素数幂次阶的有限域</p>
<p>{% note success no-icon %}</p>
<p><strong>&lt;a id="th-3"&gt;定理 - 3&lt;/a&gt;</strong> 令 $p(x)$ 为 $\mathbb{F}_p[x]$ 中一 $m$ 次首 1 不可约多项式 ($m\geqslant 1$), 则</p>
<p>$$
\mathbb{F}<em>p[x]/\lang p(x)\rang=\left{\sum</em>{i=0}^{m-1}a_ix^i+\lang p(x)\rang\bigg|a_i\in\mathbb{F}_p,~i=0,1,...m-1\right}
$$</p>
<p>为一阶为 $p^m$ 的有限域</p>
<p>&lt;details open&gt;
&lt;summary&gt;证明&lt;/summary&gt;</p>
<p>易得 $\lang p(x)\rang$ 为 $\mathbb{F}_p[x]$ 的极大理想, 从而 $\mathbb{F}_p[x]/\lang p(x)\rang$ 为一域</p>
<p>由 $\mathbb{F}_p$ 为阶为 $p$ 的素域, 易得</p>
<p>$$
|\mathbb{F}_p[x]/\lang p(x)\rang|=p^m
$$</p>
<p>&lt;/details&gt;</p>
<p>{% endnote %}</p>
<p>我们将 $\mathbb{F}_p[x]/\lang p(x)\rang$ 中的多项式看作 $p$ 进制数, 不难发现这个操作是同构映射, 故这题我们就做完了</p>
<h2>代码参考</h2>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% icodeweb cpa_py title:Luogu_P3923 Luogu/P3923/0.py %}</p>
<p>&lt;/details&gt;</p>
