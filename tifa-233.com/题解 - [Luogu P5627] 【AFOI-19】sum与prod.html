<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/luogu-p5627.md">仓库源文</a>，<a href="https://tifa-233.com/archives/luogu-p5627">站点原文</a></h2>
<p><a href="https://www.luogu.com.cn/problem/P5627">题目链接</a></p>
&lt;!-- more --&gt;

<h2>原始题面</h2>
<h3>题目背景</h3>
<p>SY 终于整理好了她凌乱的被子, 刚来到教室的她就收到了 QM 传来的一张字条.</p>
<p>To: Dear SY</p>
<p>$~~~~$ 你看看我昨晚梦到的式子, 解出来给你糖吃</p>
<p>From: Your QM</p>
<p>SY 自然是无法拒绝 $C<em>{6}H</em>{12}O_{6}$ 的诱惑啦, 不过她看到字条背面花里胡哨的式子时傻眼了. . 但是 SY 还是很想吃糖</p>
<h3>题目描述</h3>
<p>求</p>
<p>$$
\sum<em>{i=1}^{2^{n}}\log</em>{2}{(\prod_{j = 1}^{i}lowbit(j))}
$$</p>
<p>的结果</p>
<p>其中 $lowbit(x)$ 意指<code>x&amp;(~x+1)</code>的结果</p>
<h3>输入格式</h3>
<p>一行, 一个整数 n</p>
<h3>输出格式</h3>
<p>一行, 一个整数, 为答案模 $10^9+7$ 的结果</p>
<h3>输入输出样例</h3>
<h4>输入 #1</h4>
<pre><code class="lang-input1">2
</code></pre>
<h4>输出 #1</h4>
<pre><code class="lang-output1">5
</code></pre>
<h4>输入 #2</h4>
<pre><code class="lang-input2">5
</code></pre>
<h4>输出 #2</h4>
<pre><code class="lang-output2">447
</code></pre>
<h3>说明/提示</h3>
<p>对于前 $20\%$ 的数据, 有 $\leq n \leq 60$</p>
<p>对于前 $50\%$ 的数据, 有 $\leq n \leq 10^4$</p>
<p>对于前 $100\%$ 的数据, 有 $\leq n \leq 2^{62}$</p>
<h2>解题思路</h2>
<p>容易得到, 原式即为</p>
<p>$$
\begin{aligned}
  &amp;+0\
  &amp;+0+1\
  &amp;+0+1+2\
  &amp;+0+1+2+2\
  &amp;...\
  &amp;+0+1+2+2+...+\underbrace{k+k+...+k}_{k}+...+\underbrace n_1\
\end{aligned}
$$</p>
<p>即 $n+(1+2^{n-1})(2^n-n-1)$</p>
<h2>代码参考</h2>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:Luogu_P5627 Luogu/P5627/0.cpp %}

&lt;/details&gt;