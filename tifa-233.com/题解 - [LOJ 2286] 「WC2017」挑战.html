<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/loj-2286.md">仓库源文</a>，<a href="https://tifa-233.com/archives/loj-2286">站点原文</a></h2>
<hr/>
<p>title: "题解 - [LOJ 2286] 「WC2017」挑战"
categories:</p>
<ul>
<li>算法竞赛</li>
<li>题解
tags:</li>
<li>算法竞赛</li>
<li>题解</li>
<li>LibreOJ</li>
<li>WC</li>
<li>暴力</li>
<li>DP</li>
<li>卡常数</li>
<li>计算机组成原理</li>
<li>循环展开
date: 2021-10-25 21:04:17</li>
</ul>
<hr/>
<p>知名毒瘤卡常题. 别去做, 浪费时间</p>
<p><a href="https://loj.ac/p/2286">题目链接</a></p>
&lt;!-- more --&gt;

<h2>原始题面</h2>
<h3>题目背景</h3>
<p>你和同学们找了三道题目用来练习.</p>
<p>这次练习的目标是写出能在时间限制里通过尽量大规模数据的代码.</p>
<p>同学们纷纷写出了优秀的代码. 现在, 他们向你发起了挑战, 他们对每个问题都设置了若干个测试数据, 这是他们能通过的最大规模的测试数据. 现在, 他们想看一看你写的代码究竟能超过多少同学的代码, 通过多大规模的测试数据.</p>
<p>本题分为 $3$ 个任务, 每个任务对应一道题和相应的若干个测试点, 你需要对于每个任务, 设计一个能通过尽量多测试点的程序.</p>
<h3>题目描述</h3>
<h4>任务一</h4>
<p>给定 $n$ 个 $32$ 位无符号整数, 将它们从小到大排序.</p>
<h4>任务二</h4>
<p>有 $2n$ 个人在玩 「石头剪刀布」 游戏. 他们排成两排, 每排 $n$ 个人. 每个人在每一局游戏都使用固定策略, 即对于第 $i (i \in 1, 2)$ 排的第 $j (0 \leq j &lt; n)$ 个人, 用一个整数 $a_{ij}$​​ 表示他的策略, 其中 $0$ 表示只出石头, $1$ 表示只出剪刀, $2$ 表示只出布.</p>
<p>现在有 $q$ 个询问, 每个询问给定三个整数 $x,y,l(0\leq x,y&lt;n,1\leq l\leq n-max(x,y))$, 问将第一排的第 $x∼x+l-1$ 个人和第二排的第 $y∼y+l-1$ 个人比赛之后, 第一排有多少个人会赢.</p>
<p>上文中 「比赛」 的意思是, 对于所有整数 $i$ 满足 $0\leq i&lt;l$,让第一排的第 $x+i$ 个人和 第二排的第 $y+i$ 个人进行 「石头剪刀布」 游戏.</p>
<h4>任务三</h4>
<p>我们称一个合法的括号串为: 只由左括号和右括号构成, 两种括号的数量相等, 且任意一个前缀的左括号数量不少于右括号数量的串. 现在给定一个由 <code>(</code>, <code>)</code> 和<code>?</code> 构成的串, 问有多少种不同的方案, 使得将每个 <code>?</code> 都替换成一个括号之后, 该串变成一 个合法的括号串. 两种方案不同, 当且仅当至少有一个位置的 <code>?</code> 被替换成了不同的括号.</p>
<h3>输入输出格式</h3>
<h4>输入格式</h4>
<p>此题提供了模板程序. 选手可以在此基础上编写自己的程序, 模板程序详见下文数据范围与提示.</p>
<p>第一行一个整数 $task_id(1\leq task_id\leq3)$, 表示任务编号. 接下来是每个具体任务的输入内容.</p>
<p>在输入的同一行中, 相邻的两个整数会被一个空格隔开.</p>
<p>对于任务一: 一行, 两个整数 $n,s$ . 令 $a_0=next_integer(s),a_i=next_integer(a_{i-1}),1\leq i&lt;n$, 则 $a_0,a<em>1,…,a</em>{n-1}$ 即为需要排序的 $n$ 个整数.</p>
<p>对于任务二: 第一行两个整数 $n,q$ . 第二行一个仅包含 $0, 1, 2$ 的长度为 $n$ 的字符串, 第 $i$ 个字符所代表的整数表示第一排第 $i$ 个人的策略（即 $a_{1i}$​​）. 第三行格式同第二行, 表示第二排各个人的策略.</p>
<p>对于任务三: 第一行一个整数 $n$, 表示给定的串的长度. 第二行一个字符串, 即为给定的串.</p>
<h4>输出格式</h4>
<p>对于任务 1: 令 $b$ 为已经排好序的数组, 调用 <code>output_arr(b, n * 4)</code> 即可.</p>
<p>对于任务 2: 将每个询问的答案依次存入 $32$ 位无符号整数数组 $b$ 中（即, 存入 $b_0,b<em>1,⋯,b</em>{q-1}$ 中）, 然后调用 <code>output_arr(b, q * 4)</code> 即可.</p>
<p>对于任务 3: 输出一个整数, 表示不同的方案数除以 $2^{32}$​​ 得到的余数.</p>
<h3>输入输出样例</h3>
<h4>输入样例 #1</h4>
<pre><code class="lang-input1">1
100000 2017012501
</code></pre>
<h4>输出样例 #1</h4>
<pre><code class="lang-output1">4275990336
</code></pre>
<h4>输入样例 #2</h4>
<pre><code class="lang-input2">2
6 6
200100
200211
5 1 3
2 0 1
2 0 3
2 0 2
2 3 4
0 1 3
</code></pre>
<h4>输出样例 #2</h4>
<pre><code class="lang-output2">3349208141
</code></pre>
<h4>输入样例 #3</h4>
<pre><code class="lang-input3">3
4
(???
</code></pre>
<h4>输出样例 #3</h4>
<pre><code class="lang-output3">2
</code></pre>
<h4>输入样例 #4</h4>
<pre><code class="lang-input4">3
4
)???
</code></pre>
<h4>输出样例 #4</h4>
<pre><code class="lang-output4">0
</code></pre>
<h3>说明</h3>
<h4>数据范围与提示</h4>
<table>
<thead><tr>
<th style="text-align:center">任务编号</th>
<th style="text-align:center">分值</th>
<th style="text-align:center">测试点编号</th>
<th style="text-align:center">数据范围与约定</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">5</td>
<td style="text-align:center">1</td>
<td style="text-align:center">$n=100000$</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">19</td>
<td style="text-align:center">2</td>
<td style="text-align:center">$n=10^8$</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">11</td>
<td style="text-align:center">3</td>
<td style="text-align:center">$n=2\times10^8$</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">7</td>
<td style="text-align:center">4</td>
<td style="text-align:center">$n=q=1000$</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">23</td>
<td style="text-align:center">5</td>
<td style="text-align:center">$n=q=300000$</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">9</td>
<td style="text-align:center">6</td>
<td style="text-align:center">$n=1000$</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">5</td>
<td style="text-align:center">7</td>
<td style="text-align:center">$n=120000$</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">7</td>
<td style="text-align:center">8</td>
<td style="text-align:center">$n=225000$</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">14</td>
<td style="text-align:center">9</td>
<td style="text-align:center">$n=266666$</td>
</tr>
</tbody>
</table>
<h4>模板程序</h4>
<h5>C++模板</h5>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb blog lang:cpp loj-2286/templ.cpp %}

&lt;/details&gt;<h5>C 模板</h5>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb blog lang:cpp loj-2286/templ.c %}

&lt;/details&gt;<h5>Pascal 模板</h5>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb blog lang:cpp loj-2286/templ.pas %}

&lt;/details&gt;<h2>解题思路</h2>
<h3>任务一</h3>
<p>基数排序, 桶要开小些以便卡入 L1 Cache</p>
<h3>任务二</h3>
<p>直接 $O(nq)$ 暴力, 使用 <code>popcount</code> 指令和循环展开卡常</p>
<h3>任务三</h3>
<p>$O(n^2)$ DP, 依旧是用循环展开卡常</p>
<h2>代码参考</h2>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:LibreOJ_2286 LibreOJ/2286/0.cpp %}

&lt;/details&gt;