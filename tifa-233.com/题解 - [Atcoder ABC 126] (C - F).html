<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/abc126.md">仓库源文</a>，<a href="https://tifa-233.com/archives/abc126">站点原文</a></h2>
<hr/>
<p>title: "题解 - [Atcoder ABC 126] (C - F)"
categories:</p>
<ul>
<li>算法竞赛</li>
<li>题解
tags:</li>
<li>算法竞赛</li>
<li>题解</li>
<li>AtCoder</li>
<li>数学</li>
<li>概率</li>
<li>期望</li>
<li>搜索</li>
<li>DFS</li>
<li>并查集</li>
<li>思维</li>
<li>构造</li>
<li>位运算</li>
<li>异或
date: 2021-02-02 12:06:09</li>
</ul>
<hr/>
<p><a href="https://atcoder.jp/contests/abc126">比赛链接</a></p>
<p>&lt;!-- more --&gt;</p>
<h2>C - Dice and Coin</h2>
<h3>Problem Statement</h3>
<p>Snuke has a fair $N$-sided die that shows the integers from $1$ to $N$ with equal probability and a fair coin. He will play the following game with them:</p>
<ol>
<li>Throw the die. The current score is the result of the die.</li>
<li>As long as the score is between $1$ and $K-1$ (inclusive), keep flipping the coin. The score is doubled each time the coin lands heads up, and the score becomes $0$ if the coin lands tails up.</li>
<li>The game ends when the score becomes $0$ or becomes $K$ or above. Snuke wins if the score is K or above, and loses if the score is $0$.</li>
</ol>
<p>You are given $N$ and $K$. Find the probability that Snuke wins the game.</p>
<h3>Constraints</h3>
<ul>
<li>$1≤N≤10^5$</li>
<li>$1≤K≤10^5$</li>
<li>All values in input are integers.</li>
</ul>
<h3>Input</h3>
<p>Input is given from Standard Input in the following format:</p>
<blockquote>
<p>$N\ K$</p>
</blockquote>
<h3>Output</h3>
<p>Print the probability that Snuke wins the game. The output is considered correct when the absolute or relative error is at most $10^{-9}$.</p>
<h3>Sample Input 1</h3>
<pre><code class="language-input1">3 10
</code></pre>
<h3>Sample Output 1</h3>
<pre><code class="language-output1">0.145833333333
</code></pre>
<ul>
<li>If the die shows $1$, Snuke needs to get four consecutive heads from four coin flips to obtain a score of 10 or above. The probability of this happening is $\frac{1}{3}×(\frac{1}{2})^4=\frac{1}{48}$.</li>
<li>If the die shows $2$, Snuke needs to get three consecutive heads from three coin flips to obtain a score of 10 or above. The probability of this happening is $\frac{1}{3}×(\frac{1}{2})^3=\frac{1}{24}$.</li>
<li>If the die shows $3$, Snuke needs to get two consecutive heads from two coin flips to obtain a score of 10 or above. The probability of this happening is $\frac{1}{3}×(\frac{1}{2})^2=\frac{1}{12}$.</li>
</ul>
<p>Thus, the probability that Snuke wins is $\frac{1}{48}+\frac{1}{24}+\frac{1}{12}=\frac{7}{48}≃0.1458333333$.</p>
<h3>Sample Input 2</h3>
<pre><code class="language-input2">100000 5
</code></pre>
<h3>Sample Output 2</h3>
<pre><code class="language-output2">0.999973749998
</code></pre>
<h3>解题思路</h3>
<p>式子还蛮好推的, 照着做就行</p>
<p>就是注意下精度, 本题要求到 <code>1e-9</code></p>
<blockquote>
<p>当然搞整除分块也不是不可以</p>
</blockquote>
<h3>代码参考</h3>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% icodeweb cpa_cpp title:AtCoder_abc126_c AtCoder/abc126_c/0.cpp %}</p>
<p>&lt;/details&gt;</p>
<h2>D - Even Relation</h2>
<h3>Problem Statement</h3>
<p>We have a tree with $N$ vertices numbered $1$ to $N$. The $i$-th edge in the tree connects Vertex ui and Vertex $v_i$, and its length is $w_i$. Your objective is to paint each vertex in the tree white or black (it is fine to paint all vertices the same color) so that the following condition is satisfied:</p>
<ul>
<li>For any two vertices painted in the same color, the distance between them is an even number.</li>
</ul>
<p>Find a coloring of the vertices that satisfies the condition and print it. It can be proved that at least one such coloring exists under the constraints of this problem.</p>
<h3>Constraints</h3>
<ul>
<li>All values in input are integers.</li>
<li>$1≤N≤10^5$</li>
<li>$1≤u_i&lt;v_i≤N$</li>
<li>$1≤w_i≤10^9$</li>
</ul>
<h3>Input</h3>
<p>Input is given from Standard Input in the following format:</p>
<blockquote>
<p>$\begin{matrix}
N\
u_1&amp;v_1&amp;w_1\
u_2&amp;v_2&amp;w_2\
\vdots\
u_{N-1}&amp;v_{N-1}&amp;w_{N-1}
\end{matrix}$</p>
</blockquote>
<h3>Output</h3>
<p>Print a coloring of the vertices that satisfies the condition, in $N$ lines. The $i$-th line should contain $0$ if Vertex $i$ is painted white and $1$ if it is painted black.</p>
<p>If there are multiple colorings that satisfy the condition, any of them will be accepted.</p>
<h3>Sample Input 1</h3>
<pre><code class="language-input1">3
1 2 2
2 3 1
</code></pre>
<h3>Sample Output 1</h3>
<pre><code class="language-output1">0
0
1
</code></pre>
<h3>Sample Input 2</h3>
<pre><code class="language-input2">5
2 5 2
2 3 10
1 3 8
3 4 2
</code></pre>
<h3>Sample Output 2</h3>
<pre><code class="language-output2">1
0
1
0
1
</code></pre>
<h3>解题思路</h3>
<p>如果边权为偶数, 则两端点同色; 如果边权为奇数, 则两端点异色</p>
<h3>代码参考</h3>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% icodeweb cpa_cpp title:AtCoder_abc126_d AtCoder/abc126_d/0.cpp %}</p>
<p>&lt;/details&gt;</p>
<h2>E - 1 or 2</h2>
<h3>Problem Statement</h3>
<p>There are $N$ cards placed face down in a row. On each card, an integer $1$ or $2$ is written.</p>
<p>Let $A_i$ be the integer written on the $i$-th card.</p>
<p>Your objective is to guess $A_1,A_2,...,A_N$ correctly.</p>
<p>You know the following facts:</p>
<ul>
<li>For each $i=1,2,...,M$, the value $A_{X_i}+A_{Y_i}+Z_i$ is an even number.</li>
</ul>
<p>You are a magician and can use the following magic any number of times:</p>
<p><strong>Magic</strong>: Choose one card and know the integer $A_i$ written on it. The cost of using this magic is $1$.</p>
<p>What is the minimum cost required to determine all of $A_1,A_2,...,A_N$?</p>
<p>It is guaranteed that there is no contradiction in given input.</p>
<h3>Constraints</h3>
<ul>
<li>All values in input are integers.</li>
<li>$2≤N≤10^5$</li>
<li>$1≤M≤10^5$</li>
<li>$1≤X_i&lt;Y_i≤N$</li>
<li>$1≤Z_i≤100$</li>
<li>The pairs $(X_i,Y_i)$ are distinct.</li>
<li>There is no contradiction in input. (That is, there exist integers $A_1,A_2,...,A_N$ that satisfy the conditions.)</li>
</ul>
<h3>Input</h3>
<p>Input is given from Standard Input in the following format:</p>
<blockquote>
<p>$\begin{matrix}
N&amp;M\
X_1&amp;Y_1&amp;Z_1\
X_2&amp;Y_2&amp;Z_2\
\vdots\
X_M&amp;Y_M&amp;Z_M
\end{matrix}$</p>
</blockquote>
<h3>Output</h3>
<p>Print the minimum total cost required to determine all of $A_1,A_2,...,A_N$.</p>
<h3>Sample Input 1</h3>
<pre><code class="language-input1">3 1
1 2 1
</code></pre>
<h3>Sample Output 1</h3>
<pre><code class="language-output1">2
</code></pre>
<p>You can determine all of $A_1,A_2,A_3$ by using the magic for the first and third cards.</p>
<h3>Sample Input 2</h3>
<pre><code class="language-input2">6 5
1 2 1
2 3 2
1 3 3
4 5 4
5 6 5
</code></pre>
<h3>Sample Output 2</h3>
<pre><code class="language-output2">2
</code></pre>
<h3>Sample Input 3</h3>
<pre><code class="language-input3">100000 1
1 100000 100
</code></pre>
<h3>Sample Output 3</h3>
<pre><code class="language-output3">99999
</code></pre>
<h3>解题思路</h3>
<p>一眼并查集, 没啥好说的</p>
<h3>代码参考</h3>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% icodeweb cpa_cpp title:AtCoder_abc126_e AtCoder/abc126_e/0.cpp %}</p>
<p>&lt;/details&gt;</p>
<h2>F - XOR Matching</h2>
<h3>Problem Statement</h3>
<p>Construct a sequence $a= {a_1, a_2, ..., a_{2^{M+1}}}$ of length $2^{M+1}$ that satisfies the following conditions, if such a sequence exists.</p>
<ul>
<li>Each integer between $0$ and $2^M-1$ (inclusive) occurs twice in $a$.</li>
<li>For any $i$ and $j$ ($i&lt;j$) such that $a_i=a_j$, the formula $a_i\ xor\ a_{i+1}\ xor\ ...\ xor\ a_j=K$ holds.</li>
</ul>
<p>&lt;details open&gt;
&lt;summary&gt;What is xor (bitwise exclusive or)?&lt;/summary&gt;
The xor of integers $c_1,c_2,...,c_n$ is defined as follows:</p>
<ul>
<li>When $c_1\ xor\ c_2\ xor\ ...\ xor\ c_n$ is written in base two, the digit in the $2^k$'s place ($k≥0$) is 1 if the number of integers among $c_1,c_2,...c_m$ whose binary representations have $1$ in the $2^k$'s place is odd, and $0$ if that count is even.</li>
</ul>
<p>For example, $3\ xor\ 5=6$. (If we write it in base two: <code>011</code> $xor$ <code>101</code> = <code>110</code>.)</p>
<p>&lt;/details&gt;</p>
<h3>Constraints</h3>
<ul>
<li>All values in input are integers.</li>
<li>$0≤M≤17$</li>
<li>$0≤K≤10^9$</li>
</ul>
<h3>Input</h3>
<p>Input is given from Standard Input in the following format:</p>
<blockquote>
<p>$M\ K$</p>
</blockquote>
<h4>Output</h4>
<p>If there is no sequence $a$ that satisfies the condition, print <code>-1</code>.</p>
<p>If there exists such a sequence $a$, print the elements of one such sequence $a$ with spaces in between.</p>
<p>If there are multiple sequences that satisfies the condition, any of them will be accepted.</p>
<h3>Sample Input 1</h3>
<pre><code class="language-input1">1 0
</code></pre>
<h3>Sample Output 1</h3>
<pre><code class="language-output1">0 0 1 1
</code></pre>
<p>For this case, there are multiple sequences that satisfy the condition.</p>
<p>For example, when $a = {0,0,1,1}$, there are two pairs $(i, j) (i&lt;j)$ such that $a_i=a_j$: $(1,2)$ and $(3,4)$. Since $a_1\ xor\ a_2=0$ and $a_3\ xor\ a_4=0$, this sequence $a$ satisfies the condition.</p>
<h3>Sample Input 2</h3>
<pre><code class="language-input2">1 1
</code></pre>
<h3>Sample Output 2</h3>
<pre><code class="language-output2">-1
</code></pre>
<p>No sequence satisfies the condition.</p>
<h3>Sample Input 3</h3>
<pre><code class="language-input3">5 58
</code></pre>
<h3>Sample Output 3</h3>
<pre><code class="language-output3">-1
</code></pre>
<p>No sequence satisfies the condition.</p>
<h3>解题思路</h3>
<p>首先我们注意到</p>
<p>$$
\forall k\in\mathbb{N}^+,\bigoplus_{i=0}^{2^k-1}i=0
$$</p>
<p>用数学归纳法证明即可, 或者考虑 Sierpinski 三角形</p>
<p>其次我们知道异或的逆运算是异或, 所以我们可以这样构造:</p>
<ul>
<li><p>若 $K\geqslant 2^M$, 则一定无解</p>
</li>
<li><p>若 $M=1$, 则 $K=0$ 有解, $K=1$ 无解</p>
</li>
<li><p>其余情况我们可以这样构造</p>
<p><code>0 1 ... K-1 K+1 ... 2^M-2 2^M-1 K 2^M-1 2^M-2 ... K+1 K-1 ... 1 0 K</code></p>
</li>
</ul>
<h3>代码参考</h3>
<p>&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;</p>
<p>{% icodeweb cpa_cpp title:AtCoder_abc126_f AtCoder/abc126_f/0.cpp %}</p>
<p>&lt;/details&gt;</p>
