<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/namomo2022s1-week12.md">仓库源文</a>，<a href="https://tifa-233.com/archives/namomo2022s1-week12">站点原文</a></h2>
<p>Namomo Spring Camp 2022 Div1 每日一题记录 (2022.05.14-2022.05.20)</p>
&lt;!-- more --&gt;

<h2>GCD</h2>
<p><a href="https://oj.daimayuan.top/problem/871">题目链接</a></p>
<p>3 s, 1024 MB</p>
<h3>题目描述</h3>
<p>给定整数 $a$ 和 $m$,计算整数 $x$ 的数量,满足 $0\le x&lt; m$ 同时 $gcd(a,m)= gcd(a+x,m)$</p>
<h3>输入格式</h3>
<p>第一行一个数字 $T$</p>
<p>接下来 $T$ 行 $2$ 个整数 $a,m$</p>
<h3>输出格式</h3>
<p>T 行, 每行一个数, 表示答案</p>
<h3>样例输入</h3>
<pre><code class="lang-input1">3
4 9
5 10
42 9999999967
</code></pre>
<h3>样例输出</h3>
<pre><code class="lang-output1">6
1
9999999966
</code></pre>
<h3>数据规模</h3>
<p>所有数据保证 $1\le T\le 50,1\le a&lt; m\le 1e10$</p>
<h3>解题思路</h3>
<h3>复杂度</h3>
<h3>代码参考</h3>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

&lt;/details&gt;<h2>最大连边数量 (<a href="http://www.usaco.org/index.php?page=viewproblem2&amp;cpid=721">USACO2017FEB Why Did the Cow Cross the Road II</a>, 洛谷 P3657)</h2>
<p><a href="https://oj.daimayuan.top/problem/916">题目链接</a></p>
<p>5 s, 128 MB</p>
<h3>题目描述</h3>
<p>有两个长度为 $n$ 的排列 $A、B$</p>
<p>其中数的范围均为 $1 - n$. 若 $abs(A[i] - B[j]) \le 4$, 则 $A[i]$ 与 $B[j]$ 间可以连一条边</p>
<p>现要求在边与边不相交的情况下的最大的连边数量</p>
<p>例如样例中: 如果 $a_1$ 和 $b_2$ 连边 且 $a_2$ 和 $b_1$ 连边, 则这两条边相交</p>
<p>数据保证 $A,B$ 都是一个排列</p>
<h3>输入格式</h3>
<p>第一行一个整数 $n$</p>
<p>接下来 $n$ 行, 每行一个数字 $a_i$</p>
<p>接下来 $n$ 行, 每行一个数字 $b_i$</p>
<h3>样例输入</h3>
<pre><code class="lang-input1">6
1
2
3
4
5
6
6
5
4
3
2
1
</code></pre>
<h3>样例输出</h3>
<pre><code class="lang-output1">5
</code></pre>
<h3>数据范围</h3>
<p>$1 \le n \le 10^5$</p>
<h3>解题思路</h3>
<blockquote><p>树状数组优化 LCS</p>
</blockquote>
<p>设 $f(i,j)$ 表示左边 $[1,i]$, 右边 $[1,j]$ 范围内的最大值, 显然是个 LCS 类型的 DP, 有</p>
<p>$$
f(i,j)=\max{f(i,j-1),f(i-1,j),f(i-1,j-1)+[|a_i-b_j|\leq 4]}
$$</p>
<p>然后用树状数组维护前缀最值优化即可</p>
<h3>复杂度</h3>
<p>$O(n\log n)$</p>
<h3>代码参考</h3>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:Luogu_P3657 Luogu/P3657/0.cpp %}

&lt;/details&gt;<h2>序列中位数</h2>
<p><a href="https://oj.daimayuan.top/problem/877">题目链接</a></p>
<p>1 s, 1024 MB</p>
<h3>题目描述</h3>
<p>给定正整数 $N$, 求出 $1 \sim N - 1$ 中所有与 $N$ 互质的数构成的序列 的中位数</p>
<p>我们定义 : 一个长度为 $K$ 的序列的中位数是序列中第 $\lfloor\frac{K + 1}{2}\rfloor$ 大的数字. 且两个正整数 $a$ 与 $b$ 互质当且仅当 $gcd(a, b) = 1$</p>
<h3>输入格式</h3>
<p>第一行一个正整数 $T$, 表示数据组数</p>
<p>对于每组数据, 一行输入一个正整数 $N$</p>
<p>对于所有数据, 满足 $1 \leq T \leq 100$,$2 \leq N \leq 10^{18}$</p>
<h3>输出格式</h3>
<p>对于每组测试数据, 输出一行一个正整数, 表示答案</p>
<h3>样例输入</h3>
<pre><code class="lang-input1">3
6
10
19
</code></pre>
<h3>样例输出</h3>
<pre><code class="lang-output1">1
3
9
</code></pre>
<h3>解题思路</h3>
<h3>复杂度</h3>
<h3>代码参考</h3>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

&lt;/details&gt;<h2>选元素 (数据加强版)</h2>
<p><a href="https://oj.daimayuan.top/problem/875">题目链接</a></p>
<p>1 s, 1024 MB</p>
<h3>题目描述</h3>
<p>给定一个长度为 $n$ 的整数序列 $a_1,a_2,…,a_n$</p>
<p>请你从中挑选 $x$ 个元素, 要求:</p>
<ol>
<li>原序列中的每一个长度为 $k$ 的连续子序列都至少包含一个被选中的元素</li>
<li>满足条件 $1$ 的前提下, 所选 $x$ 个元素的相加之和应尽可能大. 输出最大可能和</li>
</ol>
<h3>输入格式</h3>
<p>第一行包含三个整数 $n,k,x$</p>
<p>第二行包含 $n$ 个整数 $a_1,a_2,…,a_n$</p>
<h3>输出格式</h3>
<p>如果无法满足题目要求, 则输出 $−1$</p>
<p>否则, 输出一个整数, 表示所选元素的最大可能和</p>
<h3>数据范围</h3>
<p>所有测试点满足 $1≤k,x≤n≤2500, 1≤a_i≤10^9$</p>
<h3>输入样例 1</h3>
<pre><code class="lang-input1">5 2 3
5 1 3 10 1
</code></pre>
<h3>输出样例 1</h3>
<pre><code class="lang-output1">18
</code></pre>
<h3>输入样例 2</h3>
<pre><code class="lang-input2">6 1 5
10 30 30 70 10 10
</code></pre>
<h3>输出样例 2</h3>
<pre><code class="lang-output2">-1
</code></pre>
<h3>输入样例 3</h3>
<pre><code class="lang-input3">4 3 1
1 100 1 1
</code></pre>
<h3>输出样例 3</h3>
<pre><code class="lang-output3">100
</code></pre>
<h3>解题思路</h3>
<h3>复杂度</h3>
<h3>代码参考</h3>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

&lt;/details&gt;<h2>最长上升子序列计数 (Bonus)</h2>
<p><a href="https://oj.daimayuan.top/problem/884">题目链接</a></p>
<p>1 s, 1024 MB</p>
<p>本题是 <a href="http://oj.daimayuan.top/problem/326">http://oj.daimayuan.top/problem/326</a> 的加强版, 差别仅在于 $n$ 与 $a_i$ 的取值</p>
<h3>题目描述</h3>
<p>求最长上升子序列及其长度的问题已经相当普及, 本题希望你求解 最长上升子序列的个数</p>
<p>只要有序元组有一个值不同, 就称不同. 如 $[1, {\color{green}3},{\color{red}3}, 0, 4]$ 中 $[1, {\color{green}3}, 4], [1,{\color{red}3}, 4]$ 算作两个答案</p>
<h3>输入格式</h3>
<p>输入包含两行, 第一行有一个整数 $n$, 表示序列 ${a}$ 的大小</p>
<p>接下来一行包含 $n$ 个用空格分隔的整数, 依次表示 $a_1, a_2, \cdots, a_n$</p>
<h3>输出格式</h3>
<p>输出最长上升子序列的个数</p>
<p>由于这个值可能很大, 你只需要输出其模余 $10^9 + 7$ 的结果</p>
<h3>数据规模</h3>
<p>-$1 \le n \le 4 \times 10 ^ 5$ -$a_i \in [-10 ^ 8, 10 ^ 8]$</p>
<h3>样例 1 输入</h3>
<pre><code class="lang-input1">5
1 3 3 0 4
</code></pre>
<h3>样例 1 输出</h3>
<pre><code class="lang-output1">2
</code></pre>
<h3>样例 2 输入</h3>
<pre><code class="lang-input2">8
1 2 4 2 4 7 3 4
</code></pre>
<h3>样例 2 输出</h3>
<pre><code class="lang-output2">5
</code></pre>
<h3>解释</h3>
<p>共包含:</p>
<p>$[1, 2, 4, 7] \times 3$</p>
<p>$[1, 2, 3, 4] \times 2$</p>
<h3>解题思路</h3>
<h3>复杂度</h3>
<h3>代码参考</h3>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

&lt;/details&gt;<h2>LCM 与 GCD (CF1499D)</h2>
<p><a href="https://oj.daimayuan.top/problem/953">题目链接</a></p>
<p>3 s, 1024 MB</p>
<h3>题目描述</h3>
<p>给定三个正整数 $x,y,k$, 求满足 $x \times lcm(a,b) - y \times gcd(a,b) = k$ 的数对 $(a,b)$ 的数量 , 其中 $lcm(a,b)$ 是 $a,b$ 的最小公倍数 ,$gcd(a,b)$ 是 $a,b$ 的最大公约数</p>
<p>若 $a \neq b$ 那么 $(a,b)$ 与 $(b,a)$ 是两个不同的数对</p>
<h3>输入格式</h3>
<p>第一行一个整数 $t$, 表示数据组数.$(1 \leq t \leq 10^3)$</p>
<p>接下来 $t$ 行, 每行输入三个整数 $x,y,k$, 含义如题面所示.$( 1 \leq x,y,k \leq 10^7 )$</p>
<h3>输出格式</h3>
<p>输出 $t$ 行, 每行一个整数, 表示满足要求二元对的数量</p>
<h3>样例输入</h3>
<pre><code class="lang-input1">4
1 1 3
4 2 6
3 3 7
2 7 25
</code></pre>
<h3>样例输出</h3>
<pre><code class="lang-output1">4
3
0
8
</code></pre>
<h3>解题思路</h3>
<blockquote><p>简单数论</p>
</blockquote>
<p>显然有</p>
<p>$$
\alpha (xpq-y)=k
$$</p>
<p>其中 $p,q$ 互质</p>
<p>然后枚举 $k$ 的因子之后计算 $p,q$ 的对数即可</p>
<h3>复杂度</h3>
<p>$O(2K+t\sqrt{2k})$, 其中 $K=10^7$</p>
<h3>代码参考</h3>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:CodeForces_1499D CodeForces/1499D/0.cpp %}

&lt;/details&gt;<h2>前缀集 (AtCoder abc250e)</h2>
<p><a href="https://oj.daimayuan.top/problem/930">题目链接</a></p>
<p>2 s, 512 MB</p>
<h3>题目描述</h3>
<p>定义序列 $a$ 的前缀集 $S(a, i)$ 为 <code>a[1]..a[i]</code> 这 i 个元素构成的集合</p>
<p>给定两个长为 $n$ 的序列 $a, b$</p>
<p>$m$ 次询问, 每次询问两个位置 i, j</p>
<p>请你判断 $a$ 的前缀集 $S(a, i)$ 和 $b$ 的前缀集 $S(b, i)$ 是否相同</p>
<h3>输入描述</h3>
<p>一行一个整数 $n(n\leq 5\times 10^5)$</p>
<p>两行, 一行 $n$ 个整数, 分别描述 $a, b(1\leq a_i,b_i\leq 10^9)$</p>
<p>一行一个整数 $m(m\leq 5\times 10^5)$</p>
<p>$m$ 行, 每行两个数 $i(1\leq i\leq n)$, $j(1\leq j \leq n)$, 表示询问 $S(a, i)$ 和 $S(b, j)$</p>
<h3>输出描述</h3>
<p>m 行, 如果相同输出 Y, 否则输出 N</p>
<h3>样例输入</h3>
<pre><code class="lang-input1">5
1 2 3 4 5
1 2 2 4 3
7
1 1
2 2
2 3
3 3
4 4
4 5
5 5
</code></pre>
<h3>样例输出</h3>
<pre><code class="lang-output1">Y
Y
Y
N
N
Y
N
</code></pre>
<h3>原题链接</h3>
<p><a href="https://atcoder.jp/contests/abc250/tasks/abc250_e">戳我</a></p>
<h3>解题思路</h3>
<blockquote><p>Hash / Set</p>
</blockquote>
<p>取 $S_A(i)=|{a_1,a_2,...,a_i}|$, 那么 $S(a,i)=S(b,j)\implies S_A(i)=S_B(j)$</p>
<p>若 $S_A(i)=S_B(j)$, 只需事先计算出来 $a,b$ 去重后当 $S_A(i)$ 取哪些值时才会相同即可</p>
<h3>复杂度</h3>
<p>$O(n+q)$</p>
<h3>代码参考</h3>
&lt;details open&gt;
&lt;summary&gt;&lt;font color='orange'&gt;Show code&lt;/font&gt;&lt;/summary&gt;

{% icodeweb cpa_cpp title:AtCoder_abc250e AtCoder/abc250_e/0.cpp %}

&lt;/details&gt;