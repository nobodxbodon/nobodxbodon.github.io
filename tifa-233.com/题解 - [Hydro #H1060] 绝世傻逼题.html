<p>版权声明： 本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！</p>
<h2><a href="https://github.com/Tiphereth-A/Tiphereth-A.github.io/blob/master/source/_posts/hydro-h1060.md">仓库源文</a>，<a href="https://tifa-233.com/archives/hydro-h1060">站点原文</a></h2>
<p>雀食</p>
<p><a href="https://hydro.ac/p/H1060">题目链接</a></p>
&lt;!-- more --&gt;

<h2>原始题面</h2>
<h3>题目描述</h3>
<p>给定 $D,R,E,A,M$ 求:</p>
<p>$$
\newcommand{\lcm}{\operatorname{lcm}}\sum<em>{d=1}^D\sum</em>{r=1}^R\sum<em>{e=1}^E\sum</em>{a=1}^A\sum_{m=1}^M\frac{\begin{matrix}\gcd(d,r,e)\gcd(d,r,a)\gcd(d,r,m)\gcd(d,e,a)\gcd(d,e,m)\\gcd(d,a,m)\gcd(r,e,a)\gcd(r,e,m)\gcd(r,a,m)\gcd(e,a,m)\end{matrix}}{\begin{matrix}\gcd(\lcm(d,r),\lcm(d,e),\lcm(d,a),\lcm(d,m),\\lcm(r,e),\lcm(r,a),\lcm(r,m),\lcm(e,a),\lcm(e,m),\\lcm(a,m))^3\gcd(\lcm(d,r,e),\lcm(d,r,a),\lcm(d,r,m),\\lcm(d,e,a),\lcm(d,e,m),\lcm(d,a,m),\lcm(r,e,a),\\lcm(r,e,m),\lcm(r,a,m),\lcm(e,a,m))\end{matrix}}
$$</p>
<p>答案对 $10^9+7$ 取模</p>
<h3>输入格式</h3>
<blockquote><p><strong>本题输入含有多组数据</strong></p>
</blockquote>
<p>第一行一个正整数 $T$, 代表数据组数量.</p>
<p>接下来 $T$ 行, 每行五个正整数, 分别代表 $D,R,E,A,M$</p>
<h3>输出格式</h3>
<p>输出 $T$ 个正整数, 代表对应数据组答案</p>
<h3>输入输出样例</h3>
<h4>输入 #1</h4>
<pre><code class="lang-input1">3
1 1 1 1 1
5 6 7 8 9
5642228 7263010 8833976 5087685 6171346
</code></pre>
<h4>输出 #1</h4>
<pre><code class="lang-output1">1
82488
510550839
</code></pre>
<h3>说明/提示</h3>
<p>数据规模与约定</p>
<blockquote><p><strong>本题采用捆绑测试</strong></p>
</blockquote>
<p>Subtask 1 (2 pts): $D,R,E,A,M\le10$</p>
<p>Subtask 2 (41 pts): $D,R,E,A,M\le100$</p>
<p>Subtask 3 (57 pts): 没有特殊限制</p>
<p>对于所有数据, $1\le T\le2000$, $1\le D,R,E,A,M\le5\times10^7$</p>
<h2>题意简述</h2>
<p>求</p>
<p>$$
\sum<em>{(d,r,e,a,m)\in S}{\prod</em>{c}(\alpha,\beta)\over\gcd<em>{c}{}^3{[\alpha,\beta]}\gcd</em>{c}{[\alpha,\beta,\gamma]}}
$$</p>
<p>其中</p>
<ul>
<li>$S=[1,D]\times[1,R]\times[1,E]\times[1,A]\times[1,M]$</li>
<li>下标的 $c$ 代表该算子枚举的是所有组合</li>
</ul>
<h2>解题思路</h2>
<p>原题式子是真的丑, 用唯一分解定理算算就能得出是</p>
<p>$$
\sum_{(d,r,e,a,m)\in S}\gcd{}^6{d,r,e,a,m}
$$</p>
<p>然后就是经典套路变形</p>
<p>设</p>
<ul>
<li>$n=\min{D,R,E,A,M}$</li>
<li>$\def\f#1{\lfloor\frac{ #1}{x}\rfloor}F(x)=\f{D}\f{R}\f{E}\f{A}\f{M}$</li>
</ul>
<p>则所求为</p>
<p>$$
\sum_{d=1}^nF(d)({n^6}*\mu)(d)
$$</p>
<p>然后大力数论分块搞搞就行了</p>
<p>另外注意常数, 我卡了半天常才过</p>
<p><del>std 的速度比我的快了一倍多, 不知道怎么写的, 反正卡过了就完事了</del></p>
<h2>复杂度</h2>
<p>$O(N+T\sqrt N)$, 其中 $N=\max{D,R,E,A,M}$</p>
<h2>代码参考</h2>
<p>{% icodeweb cpa_cpp title:Hydro_H1060 Hydro/H1060/0.cpp %}</p>
