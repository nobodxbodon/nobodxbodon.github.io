<h2><a href="https://github.com/vivaxyblog/vivaxyblog.github.io/blob/master/_posts/2017-02-02-webpack-2-x.md">仓库源文</a>，<a href="https://vivaxyblog.github.io/2017/02/02/webpack-2-x">站点原文</a></h2>
<hr/>
<h2>layout: post
title: webpack 2.x 迁移
tags: [tools]</h2>
<p>截止至目前，在 webpack <a href="http://webpack.github.io/docs/">官网</a> 上已经有说明：webpack v1 已经废弃了，在 npm 上 latest 的 tag 已经指向了 2.2.1。</p>
<p>需要做的改动如下：</p>
<ul>
<li><code>module.loaders</code> 改名为 <code>module.rules</code>，<code>loaders</code> 参数变成了 <code>use</code>，<code>query</code> 参数变成了 <code>options</code></li>
<li>loader 名称中的 <code>-loader</code> 需要手动添加</li>
<li>不再需要 <code>json-loader</code></li>
<li>webpack.optimize.UglifyJsPlugin 默认不生成 sourcemap，需要手动开启</li>
<li>不再需要 webpack.optimize.DedupePlugin</li>
<li>webpack.optimize.OccurrenceOrderPlugin 默认开启，所以不再需要</li>
<li>ExtractTextWebpackPlugin 需要使用 2.x 版本，并且修改了 api</li>
<li>支持动态 import 了，可以写 <code>import(\</code>./routes/${path}/route`)`</li>
<li>支持解析 <code>import</code> 和 <code>exports</code> 关键字了，不再需要 babel 对上面两个关键字进行编译。在 .babelrc 中关闭</li>
</ul>
<pre><code class="language-json">{
    "presets": [
        [
            "es2015",
            {
                "modules": false
            }
        ],
        "react",
        "stage-0"
    ]
}
</code></pre>
<ul>
<li>webpack-dev-server 不再接受 contentBase 参数，换成了 proxy</li>
<li>postcss-loader 的参数需要写到 loader 的 options 中</li>
<li>webpack.NoErrorsPlugin 被替换成了 webpack.NoEmitOnErrorsPlugin</li>
<li>升级 html-webpack-plugin 到最新版，v2.27.0 修复了 wepback@2.x 中 chunksorter 的问题</li>
</ul>
<p>其他兼容的变更，不需要改动：</p>
<ul>
<li>require 中支持 es6 template string</li>
<li>webpack.config.js 支持异步配置</li>
<li>webpack.config.js 不再接受不能识别的配置参数</li>
<li>webpack-dev-server 的控制台输出更少信息</li>
</ul>
<h2>参考资料</h2>
<ul>
<li><a href="https://webpack.js.org/guides/migrating/">Migrating from v1 to v2</a></li>
<li><a href="https://medium.com/webpack/whats-new-in-webpack-dev-server-2-0-a66848c3679#.tmf07opox">What’s new in webpack dev server 2.0</a></li>
<li><a href="https://github.com/postcss/postcss-loader">postcss-loader</a></li>
<li><a href="https://github.com/gaearon/react-hot-loader/issues/354">Hot reload not working with webpack2 and react-hot-loader3</a></li>
</ul>
<h2>后记</h2>
<p>webpack@2 已经兼容了 webpack@1 的大部分配置，你可能已经不再需要做本文中提到的那些修改了。</p>
