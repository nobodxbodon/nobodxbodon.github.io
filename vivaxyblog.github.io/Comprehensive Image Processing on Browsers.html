<h2>原文：<a href="https://vivaxyblog.github.io/2019/11/06/comprehensive-image-processing-on-browsers">Comprehensive Image Processing on Browsers</a></h2>
<hr/>
<h2>layout: post
title: Comprehensive Image Processing on Browsers
tags: [image, browser, file, blob, data urls, http urls, object urls, typedarray, buffer, dataview, arraybuffer]</h2>
<p>Images can be represented in different types. They can be summarized as 5 types: DOM, URL, <code>File</code>, <code>ImageData</code> and Buffer.</p>
<h2>Image Data Types</h2>
<h3>DOM</h3>
<h4><code>&lt;img&gt;</code></h4>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img"><code>&lt;img&gt;</code></a> elements load images from URL(e.g. Data URLs, HTTP URLs or Object URLs).</p>
<h4><code>&lt;canvas&gt;</code></h4>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/canvas"><code>&lt;canvas&gt;</code></a> elements draw images by canvas API <a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/drawImage"><code>drawImage</code></a> from <code>&lt;img&gt;</code> elements.</p>
<h3>URL</h3>
<h4>Data URLs</h4>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs">Data URLs</a> carries base64 encoded image data. Image binary can be decoded from Data URLs. Data URL image file size is a little larger than the original binary data.</p>
<h4>HTTP URLs</h4>
<p><a href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_is_a_URL">HTTP URLs</a> represent images stored on servers. HTTP URLs are used to fetch image data from servers.</p>
<h4>Object URLs</h4>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL">Object URLs</a> represent the <code>File</code> or <code>Blob</code> object. Object URLs can be created by <code>createObjectURL</code> API, and released by <code>revokeObjectURL</code> API. The object is stored in browser memory and can be accessed by a short Object URL.</p>
<h3>File</h3>
<h4><code>Blob</code></h4>
<p>A <a href="https://developer.mozilla.org/en-US/docs/Web/API/Blob"><code>Blob</code></a> object represents a file-like object of binary data. It contains a readyonly <code>size</code> property and a readyonly <code>type</code> property. You can retrieve the binary data by <code>slice</code>, <code>stream</code>, <code>text</code> and <code>arrayBuffer</code> methods.</p>
<h4><code>File</code></h4>
<p>A <a href="https://developer.mozilla.org/en-US/docs/Web/API/File"><code>File</code></a> object is a special <code>Blob</code> object. In addtion to the <code>Blob</code> properties and methods, the <code>File</code> object contains <code>lastModified</code>, <code>name</code> properties.</p>
<h3><code>ImageData</code></h3>
<p>A <a href="https://developer.mozilla.org/en-US/docs/Web/API/ImageData"><code>ImageData</code></a> object is a JavaScript object containing <code>width</code>, <code>height</code> and <code>data</code> properties, represents the image width, height and pixel data. <code>data</code> property is an one-dimensional array, containing data like <code>[R, G, B, A, R, G, B, A]</code>. Each <code>[R, G, B, A]</code> represents a pixel. You can create a <code>ImageData</code> by <code>&lt;canvas&gt;</code> API <a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/createImageData"><code>createImageData</code></a> or the <code>ImageData</code> constructor.</p>
<h3>Buffer</h3>
<h4><code>ArrayBuffer</code></h4>
<p>There is only one way of accessing the binary data on browsers <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer"><code>ArrayBuffer</code></a>. An <code>ArrayBuffer</code> represents a raw binary data buffer of the image. <code>ArrayBuffer</code> cannot be read and written. You can only convert an <code>ArrayBuffer</code> to <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView"><code>DataView</code></a> or <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray">TypedArray</a> to read and write binary data.</p>
<h4><code>Buffer</code></h4>
<p>In Node.js, <a href="https://nodejs.org/api/buffer.html"><code>Buffer</code></a> is a special <code>Uint8Array</code> with some optimizations.</p>
<h2>Convert within <code>ArrayBuffer</code>, <code>DataView</code>, TypedArray and <code>Buffer</code></h2>
<p><img alt="How to convert within ArrayBuffer, DataView, TypedArray and Buffer" src="/assets/2019-11-06-comprehensive-image-processing-on-browsers/ArrayBuffer-TypedArray-Buffer-DataView.svg"/></p>
<h2>Conver within DOM, URL, File, <code>ImageData</code> and Buffer</h2>
<p><img alt="How to conver within DOM, URL, File, ImageData and Buffer" src="/assets/2019-11-06-comprehensive-image-processing-on-browsers/DOM-URL-File-Data.svg"/></p>
<h2>Reference</h2>
<ul>
<li><a href="https://github.com/WangYuLue/image-conversion">WangYuLue/image-conversion</a></li>
</ul>
