<h2><a href="https://github.com/imjiaoyuan/imjiaoyuan.github.io/blob/master/content/p/accept-not-compromise.md">仓库源文</a>，<a href="https://yuanj.top/accept-not-compromise">站点原文</a></h2>
<p>Windows11 在 2021 年就出了，当时我还第一批升级了预览版，但是从那以后再也没有用过，因为体验实在不怎么样。</p>
&lt;!--more--&gt;

<p>手里这台 Thinkbook 14+ 2024 的 CPU 是 ultra7，我拿到手之后也是刷回了 Windows10 LTSC 2021，用了也快有小一年的时间了，但是会有异常发热、显卡驱动不兼容导致异常黑屏等等问题，加上之前 WSL2 的网络更新只有 Windows11 支持，所以这次我也索性装了 Windows11，反正迟早也得换😂（Windows11 上的表情是真的丑啊）。</p>
<h2>安装</h2>
<p>我安装的是简体中文版的 Windows11 LTSC 2024，是从 LTSC 2021 覆盖升级来的，使用 KEU KMS 激活的 LTSC 2021 会被自动转换为 ioT LTSC 版本，因此如果你直接覆盖升级的话会显示系统版本不一致，无法保留应用和设置，这时候其实只需要通过安装密钥转为原先的 LTSC 版本即可：</p>
<pre><code class="lang-powershell">slmgr /ipk M7XTQ-FN8P6-TTKYV-9D4CC-J462D
slmgr /ato
</code></pre>
<p>这里只需要密钥安装成功即可，有时候会显示激活不成功，这是不影响的，反正我们也只是为了转换版本。</p>
<p>然后在 <a href="https://massgrave.dev/windows_ltsc_links">MAS</a> 下载简体中文的镜像，覆盖安装就行了。全新安装的话，用 ventoy 做一个启动盘，把镜像拖进去直接安装就行。</p>
<p>LTSC 版本的 Windows11 是不会强制性 OOBE 联网的，所以可以直接跳过联网，创建本地用户。</p>
<h2>系统设置</h2>
<p>设置里面主要是关掉开始菜单里面的建议项，然后在组策略的计算机配置-&gt;管理模板-&gt;“开始“菜单和任务栏，启用关闭建议相关的策略即可。</p>
<p>然而，没什么卵用，重启几次之后居然就恢复了 ... 所以我直接用 StartAllBack，开始菜单放到左下角，幸亏 LTSC 没有垃圾小组件。</p>
<p><img alt="" src="/i/20250731103222.jpg"/></p>
<p>然后就是所有的隐私项和传递优化，统统关掉。</p>
<p>接下来便是困扰绝大多数 Windows11 用户的一个问题——右键菜单，真的，你很难想象，微软的程序员感觉是小脑有问题，原先的右键菜单好好的，他非要给你折叠起来，放几个没用的，其他的折叠起来，这是为了刷 KPI？？用 DISM++就可以很方便的还原右键菜单，然后去掉一些不需要的项。</p>
<p><img alt="" src="/i/20250731104130.jpg"/></p>
<p>幸亏 LTSC 版本没有微软管家之类的，edge 和 webview 也可以直接删掉，不然又少不了一顿折腾。</p>
<p>之前在使用 bypy 的时候，bypy 返回一个 warning，就是说，我的系统默认编码不是 UTF-8，这时候我才反应过来 ... Windows 默认是 GBK，在区域设置中启用 UTF-8 支持。（再喷一句，这个设置似乎从 Windows10 1903 就支持了，现在都 24h2 了，还是 beta？）</p>
<p><img alt="" src="/i/20250731104634.jpg"/></p>
<p>组策略里面可以关闭很多数据收集设置和微软所谓的云优化内容，我的组策略配置如下：</p>
&lt;details&gt;
&lt;summary&gt;点击展开完整组策略配置&lt;/summary&gt;

计算机配置

管理模板/“开始”菜单和任务栏：
  不保留最近打开文档的历史：已启用
  从“开始”菜单的“建议”部分中删除个性化网站建议：已启用
  从“开始”菜单中删除“建议”部分：已启用
  从“开始”菜单中删除“最近添加”列表：已启用
  从“开始”菜单中删除常用程序列表：已启用

管理模板/Windows 组件/Internet Explorer:
  阻止绕过 SmartScreen 筛选器警告：已禁用

管理模板/Windows 组件/Microsoft Edge:
  配置 Windows Defender SmartScreen: 已禁用
  阻止绕过 Windows Defender SmartScreen 站点提示：已禁用

管理模板/Windows 组件/RSS 源：
  打开 HTTP 基本源验证：已禁用
  关闭源和网页快讯的后台同步：已启用
  阻止订阅或删除源或网页快讯：已启用
  阻止访问源列表：已启用
  阻止下载附件：已启用
  阻止自动发现源和网页快讯：已启用

管理模板/Windows 组件/Windows AI:
  关闭保存快照以用于回顾的功能：已启用
  禁用“单击以执行”: 已启用
  允许启用回顾：已禁用

管理模板/Windows 组件/Windows Defender SmartScreen/Microsoft Edge:
  配置 Windows Defender SmartScreen: 已禁用
  阻止绕过 Windows Defender SmartScreen 站点提示：已禁用

管理模板/Windows 组件/Windows Defender SmartScreen/增强网络钓鱼防护：
  服务已启用：已禁用
  通知不安全的应用：已禁用
  通知恶意：已禁用
  通知密码重用：已禁用
  自动数据收集：已禁用

管理模板/Windows 组件/Windows Defender SmartScreen/资源管理器：
  配置应用安装控制：已启用 （关闭应用建议）

管理模板/Windows 组件/Windows Messenger:
  不允许运行 Windows Messenger: 已启用
  初始化时不自动启动 Windows Messenger: 已启用

管理模板/Windows 组件/Windows 错误报告：
  不发送额外的数据：已启用
  不限制额外的数据：已禁用
  禁用 Windows 错误报告：已启用
  配置错误报告：已启用
  使用电池电源时发送额外数据：已禁用
  自动发送操作系统所生成错误报告的内存转储：已禁用

管理模板/Windows 组件/Windows 媒体播放器：
  不显示首次使用对话框：已启用
  阻止创建桌面快捷方式：已启用
  阻止自动更新：已启用

管理模板/Windows 组件/Windows 日历：
  关闭 Windows 日历：已启用

管理模板/Windows 组件/查找我的设备：
  启用/关闭“查找我的设备”: 已禁用

管理模板/Windows 组件/地图：
  关闭“脱机地图”设置页上未经请求的网络流量：已启用
  关闭地图数据的自动下载和更新：已启用

管理模板/Windows 组件/家庭组：
  阻止计算机加入家庭组：已启用

管理模板/Windows 组件/联机帮助：
  关闭活动帮助：已启用

管理模板/Windows 组件/聊天：
  配置任务栏上的"聊天"图标：已禁用

管理模板/Windows 组件/数据收集和预览版本：
  禁用诊断数据查看器。: 已启用
  限制可选的桌面分析诊断数据：已禁用
  允许 WUfB 云处理：已禁用
  允许发送 Windows 诊断数据中的设备名称：已禁用
  允许进行更新合规性处理：已禁用
  允许进行桌面分析处理：已禁用
  允许商业数据管道：已禁用
  允许诊断数据：已禁用

管理模板/Windows 组件/数字保险箱：
  不允许运行数字保险箱：已启用

管理模板/Windows 组件/搜索：
  不允许 Web 搜索：已启用
  请勿在 Web 中搜索或在“搜索”中显示 Web 结果：已启用
  允许加密文件的索引：已禁用
  允许使用 Cortana: 已禁用
  允许搜索和 Cortana 使用位置：已禁用
  允许搜索要点：已禁用
  允许云搜索：已禁用
  允许在锁屏界面上方使用 Cortana: 已禁用

管理模板/Windows 组件/同步你的设置：
  不同步：已启用 （不允许用户启用同步）
  不同步辅助功能设置：已启用 （不允许用户启用“辅助功能”同步）
  不同步个性化：已启用 （不允许用户启用“个性化”同步）
  不同步开始设置：已启用 （不允许用户启用“开始布局”同步）
  不同步浏览器设置：已启用 （不允许用户打开“浏览器”同步）
  不同步密码：已启用 （不允许用户启用“密码”同步）
  不同步其他 Windows 设置：已启用 （不允许用户启用“其他 Windows 设置”同步）
  不同步应用：已启用 （不允许用户启用“AppSync”同步）
  不同步应用设置：已启用 （不允许用户启用“应用设置”同步）
  不同步语言首选项设置：已启用 （不允许用户启用“语言首选项”同步）
  不同步桌面个性化：已启用 （不允许用户启用“桌面个性化”同步）
  不在按流量计费的连接上同步：已启用
  启用 Windows 备份：已禁用

管理模板/Windows 组件/位置和传感器：
  关闭位置脚本：已启用

管理模板/Windows 组件/文件历史记录：
  关闭文件历史记录：已启用

管理模板/Windows 组件/文件资源管理器：
  关闭资源管理器的数据执行保护：已启用
  配置 Windows Defender SmartScreen: 已禁用

管理模板/Windows 组件/消息：
  允许消息服务云同步：已禁用

管理模板/Windows 组件/应用程序兼容性：
  关闭 SwitchBack 兼容性引擎：已启用
  关闭程序兼容性助理：已启用
  关闭问题步骤记录器：已启用
  关闭应用程序兼容性引擎：已启用
  关闭应用程序遥测：已启用
  禁用清单收集器：已启用

管理模板/Windows 组件/语音：
  允许语音数据的自动更新：已禁用

管理模板/Windows 组件/云内容：
  不显示 Windows 使用技巧：已启用
  关闭 Microsoft 用户体验：已启用
  关闭云消费者帐户状态内容：已启用
  关闭云优化内容：已启用

管理模板/Windows 组件/自动播放策略：
  关闭自动播放：已启用 （所有驱动器）
  设置自动运行的默认行为：已启用 （不执行任何自动运行命令）

管理模板/系统/关机选项：
  关闭会阻止或取消关机的应用程序的自动终止功能：已禁用

特别的注册表设置：
  Software\Policies\Microsoft\Windows\Windows Feeds\EnableFeeds:0

用户配置

管理模板/“开始”菜单和任务栏：
  不保留最近打开文档的历史：已启用
  不搜索 Internet: 已启用
  不搜索通信：已启用
  不搜索文件：已启用
  从“开始”菜单的“建议”部分中删除个性化网站建议：已启用
  从“开始”菜单中删除“建议”部分：已启用
  从“开始”菜单中删除“最近使用的项目”菜单：已启用
  从“开始”菜单中删除“最近添加”列表：已启用
  从任务栏中删除"人脉"栏：已启用
  关闭用户跟踪：已启用
  退出系统时清除最近打开的文档的历史：已启用
  为新用户清除最近的程序列表：已启用

管理模板/Windows 组件/Windows 媒体播放器/播放：
  允许运行屏幕保护程序：已禁用

管理模板/Windows 组件/数据收集和预览版本：
  配置浏览数据集合以便桌面分析使用：已启用 （不允许发送 Intranet 或 Internet 历史记录）
  允许诊断数据：已禁用

管理模板/Windows 组件/云内容：
  不要将诊断数据用于量身定制的体验：已启用
  关闭“欢迎使用 Windows”体验：已启用
  关闭所有 Windows 聚焦功能：已启用
  请勿在 Windows 聚焦中建议第三方内容：已启用
  在“设置”中关闭 Windows 聚焦：已启用
  在操作中心关闭 Windows 聚焦：已启用
  在锁屏界面上配置 Windows 聚焦：已禁用
  在桌面上关闭聚焦图集：已启用

管理模板/网络/网络连接：
  删除所有用户远程访问连接：已启用

&lt;/details&gt;<h2>软件列表</h2>
<ul>
<li>终端：Windows Terminal（Windows 下最好用）</li>
<li>包管理器：scoop</li>
<li>代码编辑器：VScode（跟了我好多年了，一直不离不弃~）</li>
<li>文本编辑器：notepad++（打开大文件很快，正则表达式很好用）</li>
<li>浏览器：Chrome</li>
<li>代理：Clash Verge</li>
<li>软件卸载：Hibit-Uninstaller</li>
<li>截图：snipaste</li>
<li>图片查看：imagine</li>
<li>多媒体播放器：VLC</li>
<li>PDF 查看：sumatraPDF（丝滑体验）</li>
<li>服务器连接：Xshell（应该没有比这个更好用的了）</li>
<li>远程控制：Todesk（天下乌鸦一般黑，没一个好用的）</li>
</ul>
<h2>Hyper-V</h2>
<p>之前我遇到了一个问题，我要连接广西的一个集群做分析，但是需要登录 VPN 才能连接的上，而这个 VPN 就是 easy Connect，开了它之后，电脑上其他的软件全部都会断网  ... 于是我想到装一个虚拟机，最初是想用 VMware 的，但是想着，都用 WSL 了，不如索性试一试 Hyper-V？于是就开了 Hyper-V 然后装了一个 Windows ltsc 2019，分了 2GB 内存和 2 核心，结果异常好用，不说多么流畅，起码不卡顿，占用也不大，文件和剪贴板可以直接与宿主机互通，可以和宿主机之间直接复制粘贴文件，很方便了。从此以后，所有的这类 VPN 软件我都装在虚拟机，毕竟垃圾就该呆在垃圾桶里。</p>
<p><img alt="" src="/i/20250731120812.jpg"/></p>
<p>WSL 下的 docker 有点一言难尽，systemd 更新了这么久还是不好用，所以我又在 Hyper-V 里装了一个 Debian Testing 专门来跑 docker。</p>
<h2>WSL update</h2>
<p>Windows11 下 WSL 最重要的一个特性之一就是镜像网络。在有镜像网络之前，网络模式默认为 NAT 模式，WSL2 如果想使用宿主机的代理设置，就需要在终端环境变量里面写入：</p>
<pre><code class="lang-bash">export hostip=$(cat /etc/resolv.conf |grep -oP '(?&lt;=nameserver\ ).*')
export https_proxy="http://${hostip}:7897"
export http_proxy="http://${hostip}:7897"
</code></pre>
<p>然后在代理软件例如 Clash 里面开启局域网连接 or 使用 TUN 模式，再调整 Windows 防火墙设置，允许 Clash 的核心，例如 Clash Verge 的内核 verge-mihomo.exe，通过防火墙，这样 WSL2 才能顺利使用代理。</p>
<p>现在这些都不需要了，只需要在 .wslconfig 里面配置镜像网络，例如我的 wsl 配置是：</p>
<pre><code class="lang-txt">[wsl2]
processors=2
memory=4GB
swap=4GB
networkingMode=mirrored # 启用镜像网络
guiApplications = false
[experimental]
autoMemoryReclaim=dropcache
sparseVhd=true
</code></pre>
<p>启用镜像网络后，WSL 的网络堆栈被直接“镜像”到了 Windows 的网络适配器上，这样 WSL 就可以直接使用宿主机 Windows 的代理设置。除此之外，很多 WSL 下的 web 应用也不需要专门去转发端口，宿主机与 WSL 的 IP 是共享的，在 WSL 里启动的任何服务，都可以直接通过宿主机的局域网 IP 被网络内的任何设备访问，就像它是一个原生的 Windows 应用一样。这个特性彻底铲平了 WSL 与 Windows 之间的网络鸿沟，让它的网络体验不再像一个被隔离的虚拟机。</p>
<h2>终于到了该喷的时候</h2>
<p>实际上，当第一天拿到这台机子的时候，我就删了自带的 Windows11，掏出我用了两年半的 arch 启动盘准备安上我心爱的 Arch，但是问题很多，网卡、电池、休眠、触控板、声卡等等问题太多了，我只能先装了 Windows10，打算观望一下。随后发现了如下帖子：</p>
<ul>
<li><a href="https://v2ex.com/t/1017956">有购买 Thinkbook 14+ 2024 成功安装 Linux 的大佬吗？</a></li>
<li><a href="https://bbs.archlinuxcn.org/viewtopic.php?id=14053&amp;p=6">Thinkbook 14+ 2024 的兼容性问题：触控板不识别 &amp; Wayland 合盖关机 &amp; 声卡不工作</a></li>
</ul>
<p>根据帖子里的解决方法，触控板打上补丁就好了，声卡虽然有点问题但是也可以凑合用。然后大的来了！这台设备的无线网卡是 intel 的 AX211，在 2021 年推出，然后 <a href="https://www.intel.cn/content/www/cn/zh/download/824804/intel-wireless-wi-fi-drivers-for-linux.html">Intel 官网</a>显示在目前最新的 Linux 内核 6.16 才支持 ... 看 V2EX 有人说早就支持了，只是协议不支持，自己下载协议然后 cp 到 firmware 目录即可，但是我这样做了还是不行。</p>
<p>还有就是大小核 ... 无力吐槽了，目前的大小核处理方式实在不怎么好。无论 Windows 还是 Linux ，Windows 有目共睹，Win10 的大小核调度实在非常差（微调电源管理设置项可以解决，比较麻烦），Win11 才优化了不少。至于 Linux ，优化适配 Path 一次又一次地更新，反正还没稳定下来。看起来，x86 的大小核调度并不能照抄 ARM 的方式。</p>
<p>然后是 Windows11，真的，不理解为什么要把那么多原本很好用的功能去掉，新功能没几个好用的 ... 那个多标签页文件管理器，只能自己手动添加新标签页，重复打开 explorer.exe 只会弹出新的窗口，而且旧的资源管理器居然还存在！？在控制面板任意点击回退就会出现。</p>
<p><img alt="" src="/i/20250731223315.jpg"/></p>
<p>曾经很好用的 WSA 也被砍掉了，LTSC 以外的其他版本随处可见的广告（CN 特供版更多） ...</p>
