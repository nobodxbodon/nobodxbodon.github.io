<h2><a href="https://github.com/jasonkayzk/jasonkayzk.github.io/blob/master/source/_posts/AppleScript介绍与简单实战.md">仓库源文</a>，<a href="https://jasonkayzk.github.io/2025/07/15/AppleScript介绍与简单实战">站点原文</a></h2>
<p>AppleScript是macOS内置的脚本语言，可以自动化操作应用程序。本文介绍了AppleScript的基本概念、语法和一个简单实战示例。</p>
<p>&lt;br/&gt;</p>
&lt;!--more--&gt;

<h1><strong>AppleScript介绍与简单实战</strong></h1>
<h2><strong>一、什么是AppleScript</strong></h2>
<p>AppleScript是苹果公司推出的一种脚本语言，内置于macOS中，可以直接操作和控制macOS及其应用程序。它是一个实现macOS自动化的强大工具，AppleScript的前身是HyperCard所使用的脚本语言HyperTalk。</p>
<p>与其他脚本语言如Python和JavaScript相比，AppleScript最显著的特点是能够控制其他macOS上的应用程序。通过AppleScript，我们可以完成一些繁琐重复的工作。其语法简单，接近自然语言，就像在和系统对话一样。此外，系统提供了语法查询字典，方便查询语法。</p>
<p>&lt;br/&gt;</p>
<h2><strong>二、基础语法</strong></h2>
<p>按照惯例，用AppleScript写一个Hello World：</p>
<pre><code class="lang-applescript">display dialog "Hello, world!"
</code></pre>
<p>命令行执行：</p>
<pre><code class="lang-bash">osascript -e 'display dialog "Hello, world!"'
</code></pre>
<p>运行后，系统会弹出“Hello, world!”的弹窗。</p>
<p>&lt;br/&gt;</p>
<p>下面介绍几种常用语法：</p>
<h3><strong>1、告诉应用做某事</strong></h3>
<p>AppleScript的语法接近自然语言，例如：</p>
<pre><code class="lang-applescript">tell application "Safari"
    activate
    open location "https://qq.com/"
end tell
</code></pre>
<p>这告诉Safari启动并打开指定网址。</p>
<h3><strong>2、设置变量</strong></h3>
<pre><code class="lang-applescript">set qq to "https://qq.com/"
tell application "Safari"
    activate
    open location qq
end tell
</code></pre>
<p>&lt;br/&gt;</p>
<h3><strong>3、条件语句</strong></h3>
<pre><code class="lang-applescript">if num &gt; 2 then
    // ...
else
    // ...
end if
</code></pre>
<p>&lt;br/&gt;</p>
<h3><strong>4、循环语句</strong></h3>
<pre><code class="lang-applescript">repeat with num in {1, 2, 3}
    display dialog "hello, world"
end repeat
</code></pre>
<p>&lt;br/&gt;</p>
<h3><strong>5、模拟点击和输入</strong></h3>
<p>可以使用<code>click</code>命令模拟点击，或<code>keystroke</code>输入文本。</p>
<p>&lt;br/&gt;</p>
<h2><strong>三、简单实战：命令完成后显示通知</strong></h2>
<p>执行以下命令可以展示一条通知：</p>
<pre><code class="lang-bash">osascript -e 'display notification "The command finished" with title "Success"'
</code></pre>
<p>在.zshrc中定义一个函数：</p>
<pre><code class="lang-bash">function notifyResult () {
  if [ $? -eq 0 ]; then
    osascript -e 'display notification "The command finished" with title "Success"'
  else
    osascript -e 'display notification "The command failed" with title "Failed"'
  fi
}
</code></pre>
<p>运行长时间命令时：</p>
<pre><code class="lang-bash">some_program; notifyResult
</code></pre>
<p>执行完后会收到通知是否执行成功！</p>
<blockquote><p>可以设置通知音效：</p>
<ul>
<li><a href="https://strdr4605.com/mac-os-notify-when-the-terminal-command-is-finished">MacOS: notify when the terminal command is finished</a></li>
</ul>
</blockquote>
<p>&lt;br/&gt;</p>
<h2><strong>四、一些常用脚本</strong></h2>
<h3><strong>1、通过参数发送系统通知</strong></h3>
<blockquote><p>源代码：</p>
<ul>
<li><a href="https://gist.github.com/JasonkayZK/c32cc4af8582b12d785619f6c999999f">https://gist.github.com/JasonkayZK/c32cc4af8582b12d785619f6c999999f</a></li>
</ul>
</blockquote>
<p>代码如下：</p>
<p>sys-notify</p>
<pre><code class="lang-bash">#!/bin/bash

# 帮助函数
show_help() {
    echo "Usage: $0 [Option] [message]"
    echo "Show system notification"
    echo
    echo "Option:"
    echo "  -h, --help         Show help info"
    echo "  -t, --title TITLE  Set notification title (Default: Notify)"
    exit 0
}

# 默认值
title="Notify"

# 解析命令行参数
while [[ $# -gt 0 ]]; do
    case "$1" in
        -h|--help)
            show_help
            ;;
        -t|--title)
            if [[ -z "$2" ]]; then
                echo "错误: --title 需要一个参数" &gt;&amp;2
                exit 1
            fi
            title="$2"
            shift 2
            ;;
        *)
            # 第一个非选项参数视为消息内容
            message="$1"
            shift
            break
            ;;
    esac
done

# 如果没有提供消息内容，则从标准输入读取
if [[ -z "$message" ]]; then
    if [[ -t 0 ]]; then
        echo "错误: 没有提供消息内容" &gt;&amp;2
        show_help
        exit 1
    else
        message=$(cat)
    fi
fi

# 发送通知
case "$(uname -s)" in
    Darwin)
        # macOS 使用 AppleScript
        osascript -e "display notification \"$message\" with title \"$title\""
        ;;
    Linux)
        # Linux 使用 notify-send (libnotify)
        if command -v notify-send &amp;&gt;/dev/null; then
            notify-send "$title" "$message"
        else
            echo "错误: 未找到 notify-send 命令。请安装 libnotify 包。" &gt;&amp;2
            exit 1
        fi
        ;;
    *)
        echo "错误: 不支持的操作系统" &gt;&amp;2
        exit 1
        ;;
esac
</code></pre>
<p>准备：</p>
<ul>
<li>编写 <code>sys-notify</code>；</li>
<li>增加可执行权限 <code>chmod +x sys-notify</code>；</li>
<li>加入到 PATH 环境变量；</li>
</ul>
<p>使用方法：</p>
<ul>
<li>基本用法：<code>sys-notify "操作已完成"</code></li>
<li>自定义标题：<code>sys-notify -t "操作结果" "操作已完成"</code></li>
<li>从标准输入读取内容：<code>echo "操作已完成" | sys-notify -t "操作结果"</code></li>
</ul>
<p>&lt;br/&gt;</p>
<h3><strong>2、命令完成后展示结果</strong></h3>
<blockquote><p>源代码：</p>
<ul>
<li><a href="https://gist.github.com/JasonkayZK/d5c4e3adadf3478ded5896becf01f08c">https://gist.github.com/JasonkayZK/d5c4e3adadf3478ded5896becf01f08c</a></li>
</ul>
</blockquote>
<pre><code class="lang-bash">function notifyResult () {
  if [ $? -eq 0 ]; then
    osascript -e 'display notification "The command finished" with title "Success"'
  else
    osascript -e 'display notification "The command failed" with title "Failed"'
  fi
}
</code></pre>
<p>在运行某些需要比较长时间的程序时，执行以下命令：</p>
<pre><code class="lang-node-repl">some_program; notifyResult
</code></pre>
<p>&lt;br/&gt;</p>
<h2><strong>五、后记</strong></h2>
<p>AppleScript是一个简单而强大的工具，能自动化macOS操作；</p>
<p>更多内容可参考附录链接；</p>
<p>&lt;br/&gt;</p>
<h1><strong>附录</strong></h1>
<p>源代码：</p>
<ul>
<li><a href="https://gist.github.com/JasonkayZK/c32cc4af8582b12d785619f6c999999f">https://gist.github.com/JasonkayZK/c32cc4af8582b12d785619f6c999999f</a></li>
<li><a href="https://gist.github.com/JasonkayZK/d5c4e3adadf3478ded5896becf01f08c">https://gist.github.com/JasonkayZK/d5c4e3adadf3478ded5896becf01f08c</a></li>
</ul>
<p>官方文档：</p>
<ul>
<li><a href="https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html">https://developer.apple.com/library/archive/documentation/AppleScript/Conceptual/AppleScriptLangGuide/introduction/ASLR_intro.html</a></li>
</ul>
<p>参考文章：</p>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/149893274">https://zhuanlan.zhihu.com/p/149893274</a></li>
<li><a href="https://ameow.xyz/archives/display-notification-after-command-finishes-macos">https://ameow.xyz/archives/display-notification-after-command-finishes-macos</a></li>
</ul>
<p>&lt;br/&gt;</p>
