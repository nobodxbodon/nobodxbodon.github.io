<h2><a href="https://github.com/forecho/hugo-blog/blob/master/content/posts/php-mysql-yii-geng-xin-shu-ju-ku-shi-zi-duan-zhi-zi-zeng.md">仓库源文</a>，<a href="https://blog.forecho.com/php-mysql-yii-geng-xin-shu-ju-ku-shi-zi-duan-zhi-zi-zeng.html">站点原文</a></h2>
<hr/>
<h2>title: "PHP MySQL Yii更新数据库时 字段值自增"
date: 2013-07-30T09:30:00+08:00
categories:
draft: false
toc: true</h2>
<p>PHP MySQL的实现方法是：</p>
<pre><code>update tablename set fieldname = fieldname*2 where ...</code></pre>
<p>Yii基本上有三种实现方法： 一、用save()方法。</p>
<pre><code>//登录一次加5点
$user=User::model()-&gt;findByPk(Yii::app()-&gt;user-&gt;id);
$user-&gt;reputation=$user-&gt;reputation+'5';
$user-&gt;save(); // 将更改保存到数据库</code></pre>
<p>二、用saveCounters方法。（要实现自减，只需把数值改成负数即可）</p>
<pre><code>$postRecord=User::model()-&gt;findByPk(Yii::app()-&gt;user-&gt;id);
$postRecord-&gt;saveCounters(array('reputation'=&gt;5));</code></pre>
<p>三、用updateCounters？这个还没有成功，报错貌似是编码问题，待解。   参考资料：<a href="http://www.yiiframework.com/wiki/282/using-counters-with-activerecord/">http://www.yiiframework.com/wiki/282/using-counters-with-activerecord/</a></p>
