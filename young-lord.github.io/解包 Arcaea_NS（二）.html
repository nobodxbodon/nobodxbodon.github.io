<h2>原文：<a href="https://young-lord.github.io/posts/arcaea-ns-depack-2">解包 Arcaea_NS（二）</a></h2>
<hr/>
<p>tags: [Arcaea, 逆向]
title: 解包 Arcaea_NS（二）
last_modified_at: 2023-3-18
slug: arcaea-ns-depack-2
redirect_from:</p>
<ul>
<li>/posts/解包Arcaea_NS（二）</li>
<li>/posts/解包Arcaea_NS-二</li>
</ul>
<hr/>
<p><strong>免责声明：本博文相关内容已涉及 lowiro 的实际利益。本博文内容仅用于个人软件安全研究与学习。请勿将博文内容用于商业或者非法用途，如果阁下愿意继续阅读，请您承诺将为自己的全部行为负责。</strong></p>
<p>&lt;small&gt;&lt;del&gt;[出处](https://wlt.tql.moe)&lt;/del&gt;&lt;/small&gt;</p>
<h3>引入</h3>
<p><a href="posts/arcaea-ns-depack">上一篇博文</a>中，我介绍了解包Arcaea本体的教程</p>
<p>然而，不久后Lowiro就以Update的形式发布了更新，解包Update的方式也略有变化。&lt;del&gt;又能水一篇博文了&lt;/del&gt;</p>
<h3>开始解包</h3>
<h4>NSP/XCI（本体） -&gt; TIK</h4>
<p>首先，你需要将本体解包，并将其中的TIK文件提取备用，此处参见上一篇博文</p>
<h4>NSP/XCI -&gt; NCA</h4>
<p>接下来，你需要将Update或包含Update及本体的NSP/XCI文件解包，得到许多NCA文件</p>
<p><img alt="多个文件名为十六进制字符串，大小不等的NCA文件" src="https://i.loli.net/2021/11/06/vwoPJGrhngUxqaA.png"/></p>
<h4>NCA+TIK -&gt; JSON+PACK</h4>
<p>再次运行<code>解包工具整合版.bat</code>，选择1（<code>选择NCA文件</code>），然后选择3（<code>更新 (本体 + 补丁)</code>），再选2（<code>转换为 Romfs 文件夹</code>），然后先拖入最大的nca文件（如图中841MB的）（按照上一篇博文提取到的也可以），再拖入第二大的nca文件（如图中169MB的），再拖入第一步得到的的tik文件（md5:<code>547f644e44dd734ba3498a0ff5e4a7d7</code>）</p>
<p><img alt="输出Saving xxx/arc_0.json, Saving xxx/arc_0.data, Saving xxx/arc_1.json等多行" src="https://i.loli.net/2021/11/06/nBTIgmAhQitusFY.png"/></p>
<p>完成后，<code>NCA-NSP-XCI_TO extract</code>文件夹内会出现一个叫<code>Updated_LayeredFS</code>的文件夹，此文件夹内的<code>romfs</code>文件夹内会有多个文件，分别是<code>arc_?.json</code>和<code>arc_?.pack</code>，其中<code>?</code>为由0开始递增的数字</p>
<p>你需要分别看每个json文件是不是乱码，如果是就把对应的json和pack文件都删掉，把所留下的不是乱码的文件分别执行下一步（可能执行多次）</p>
<h4>JSON+PACK -&gt; 原始文件</h4>
<p>将剩下的每组文件分别使用<code>arc_pack_extract.py</code>提取，完事。</p>
