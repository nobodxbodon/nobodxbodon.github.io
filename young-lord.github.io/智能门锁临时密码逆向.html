<h2>原文：<a href="https://young-lord.github.io/posts/smart-lock-temporary-password-reverse">智能门锁临时密码逆向</a></h2>
<hr/>
<p>tags: [微信小程序, 智能门锁, 逆向, Python, 网络安全]
title: 智能门锁临时密码逆向
slug: smart-lock-temporary-password-reverse
redirect_from:</p>
<ul>
<li>/posts/智能门锁临时密码逆向</li>
</ul>
<hr/>
<blockquote>
<p>逆，都可以逆</p>
</blockquote>
<h2>起因</h2>
<p>对最近安装的智能门锁的临时密码生成协议比较好奇，再加上对微信的不信任，故去深挖了一下</p>
<h2>正文</h2>
<p>打开小程序后前往<code>/data/data/com.tencent.mm/MicroMsg/{id}/appbrand/pkg</code>，根据修改时间找到相关程序包</p>
<p>使用<a href="https://gist.github.com/Integ/bcac5c21de5ea35b63b3db2c725f07ad">这个脚本</a>解包</p>
<p><code>npm install -g js-beautify</code>，随后<code>js-beautify app-service.js</code></p>
<p>很容易就能找到相关生成逻辑（开发者甚至贴心的留下了<code>console.log</code></p>
<p>（吐槽一下，你们开发者是对着压缩后的版本调试的吗…… log里的变量名全部是压缩后的）</p>
<p>把逻辑相关代码复制出来，将<code>\</code>转义为<code>\\</code>，丢到 Python 的一个多行变量里</p>
<p>通过<code>js2py</code>执行 JS 代码，在 Python 中得到返回值，使用<code>termux-api</code>显示出来</p>
<h2>参考资料</h2>
<p><a href="https://misakikata.github.io/2021/03/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%A7%A3%E5%8C%85/">微信小程序解包</a></p>
