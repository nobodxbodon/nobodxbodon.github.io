<h2><a href="https://github.com/Young-Lord/Young-Lord.github.io/blob/master/_posts/2022-07-31-智能门锁临时密码逆向.md">仓库源文</a>，<a href="https://young-lord.github.io/posts/smart-lock-temporary-password-reverse">站点原文</a></h2>
<blockquote><p>逆，都可以逆</p>
</blockquote>
<h2>起因</h2>
<p>对最近安装的智能门锁的临时密码生成协议比较好奇，再加上对微信的不信任，故去深挖了一下</p>
<h2>正文</h2>
<p>打开小程序后前往<code>/data/data/com.tencent.mm/MicroMsg/{id}/appbrand/pkg</code>，根据修改时间找到相关程序包</p>
<p>使用<a href="https://gist.github.com/Integ/bcac5c21de5ea35b63b3db2c725f07ad">这个脚本</a>解包</p>
<p><code>npm install -g js-beautify</code>，随后<code>js-beautify app-service.js</code></p>
<p>很容易就能找到相关生成逻辑（开发者甚至贴心的留下了<code>console.log</code></p>
<p>（吐槽一下，你们开发者是对着压缩后的版本调试的吗…… log里的变量名全部是压缩后的）</p>
<p>把逻辑相关代码复制出来，将<code>\</code>转义为<code>\\</code>，丢到 Python 的一个多行变量里</p>
<p>通过<code>js2py</code>执行 JS 代码，在 Python 中得到返回值，使用<code>termux-api</code>显示出来</p>
<h2>参考资料</h2>
<p><a href="https://misakikata.github.io/2021/03/微信小程序解包/">微信小程序解包</a></p>
<div class="license">
  <p>本文遵守 <a itemprop="license" rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA-4.0</a> 许可协议。<a href="https://github.com/Young-Lord/Young-Lord.github.io/blob/master/README.md#%E5%A3%B0%E6%98%8E">（不允许转载至简书或 CSDN）</a>
    <a rel="license" aria-label="详细了解协议内容" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<!--        <img alt="CC BY-NC-SA-4.0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" />-->
    </a>
  </p>
</div>