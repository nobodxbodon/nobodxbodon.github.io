<h2><a href="https://github.com/conge/conge.github.io/blob/master/_posts/2019/2019-01-12-ML4T-01-06-Histograms-and-scatterplots.md">仓库源文</a>，<a href="https://conge.livingwithfcs.org/2019/01/12/ML4T-01-06-Histograms-and-scatterplots">站点原文</a></h2>
<hr/>
<h2>layout: post
title: "ML4T笔记 | 01-06 Histograms and scatterplots"
date: "2019-01-12 01:12:12"
categories: 计算机科学
auth: conge
tags: Machine_Learning Trading OMSCS</h2>
<ul>
<li>content
{:toc}</li>
</ul>
<h1>01 - Histograms and scatterplots</h1>
<p><img alt="" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-4c6c90f4c6b14a50.png"/></p>
<ul>
<li>One of the most informative ways to consider <strong>daily returns</strong> is when we compare the returns of one stock with another.</li>
</ul>
<blockquote>
<p>Time: 00:00:19</p>
</blockquote>
<p>02 - A closer look at daily returns<br/>
<img alt="" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-18dd4c3d2936f90d.png"/></p>
<ul>
<li>starting with a price time series.</li>
<li>we build daily returns, this daily return data is not too revealing as time-series.</li>
</ul>
<h3>histograms</h3>
<ul>
<li>A histogram is a kind of bar chart where we plot the number of occurrences of each item versus the value.</li>
<li>split up the range of data into lots of little bins.</li>
<li>and count up how many times the data matches the range across that bin.</li>
<li>a bar of the appropriate height in the histogram that represents how many times the data matched that value.</li>
</ul>
<blockquote>
<p>Time: 00:02:12</p>
</blockquote>
<h1>03 - Quiz What would it look like</h1>
<p>What the histogram of S&amp;P 500 daily return over many years look like?</p>
<p><img alt="" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-260977e235a04b82.png"/></p>
<p>The correct answer:  <strong>bell curve</strong>.</p>
<blockquote>
<p>Time: 00:00:16</p>
</blockquote>
<h1>04 - Histogram of daily returns</h1>
<p><img alt="" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-5dcdc06a634943cb.png"/></p>
<p>Statistics we can run on it to characterize histograms.</p>
<ul>
<li>mean.</li>
<li>standard deviation: how far do individual measurements deviate from the mean.</li>
<li>Kurtosis (means curved or arching): it tells us about the tails of the distribution.
The measure of kurtosis tells us how much different our histogram from that traditional Gaussian distribution.<ul>
<li>Positive Kurtosiswe indicate fat tails, Meaning that there are more occurrences out in these tails than would be expected if it were a normal distribution.</li>
</ul>
</li>
<li>Negative kurtosis indicates <strong>skinnytails</strong>, meaning that there are many fewer occurrences than would be expected if it were a normal distribution on the tails.</li>
</ul>
<blockquote>
<p>Time: 00:02:25</p>
</blockquote>
<h1>05 - How to plot a histogram</h1>
<p><img alt="" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-20e7aacec2612fe2.png"/></p>
<p><code>daily_returns.hist(bin=20)</code> will plot daily_return as histogram with 20 bins. the default <code>bin</code> parameter is 10.</p>
<p><img alt="" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-0386b3e4c251372b.png"/></p>
<blockquote>
<p>Time: 00:02:03</p>
</blockquote>
<h1>06 - Computing histogram statistics</h1>
<p><img alt="" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-3024d695a287e94c.png"/>
Calculate mea and deviation and kurtosis:</p>
<pre><code>mean = daily_returns['SPY'].mean()
std = daily_returns['SPY'].std()
kurtosis = daily_returns.kurtosis()
</code></pre>
<p>Plot mean and diviation using <code>axvline()</code> in the Matplotlib library .</p>
<pre><code>plt.axvline(mean, color='w', linestyle='dashed', linewidth=2)
plt.axvline(std, color='r', linestyle='dashed', linewidth=2)
plt.axvline(-std, color='r', linestyle='dashed', linewidth=2)
plt.show()
</code></pre>
<p><img alt="image.png" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-1c584ae2a2816b49.png"/></p>
<ul>
<li><p>positive kurtosis for the SPY stock, which means we have fat tails.</p>
</li>
<li><p>Note: <code>bincounts()</code> using <code>numpy.histogram</code> function.</p>
</li>
</ul>
<blockquote>
<p>Time: 00:02:11</p>
</blockquote>
<h1>07 - quiz: Compare two histograms</h1>
<p><img alt=" " src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-d49221b1274875d2.png"/></p>
<p><strong>Quiz: Select the option that best describes the relationship between XYZ and SPY.</strong></p>
<p>Note:</p>
<ul>
<li>These are histograms of daily return values, i.e. X-axis is +/- change (%), and Y-axis is the number of occurrences.</li>
<li>We are considering two general properties indicated by the histogram for each stock: <em>return</em> and <em>volatility</em> (or risk).</li>
</ul>
<p><strong>correct answer</strong>: XYZ has a lower return and higher volatility than SPY.</p>
<ul>
<li>mean of XYZ, is lower than the mean of SPY.</li>
<li>XYZ got a larger standard deviation (broader shoulders), therefore, higher volatility.</li>
</ul>
<h1>8 - Plot two histograms together</h1>
<p><img alt="" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-d4d870aeb7817418.png"/></p>
<p>Since the daily_returns data frame has data for two stocks, <code>daily_returns.hist(bin=20)</code> will plot the data in two subplots.</p>
<p><img alt="" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-a7b95e14e1ecbd17.png"/></p>
<pre><code>daily_returns['SPY'].hist(bin=20,label="SPY")
daily_returns['XOM'].hist(bin=20,label="XOM")
...
</code></pre>
<ul>
<li>To get two histograms on the same x and y axis, call the histogram functions separately on each of the stocks daily return values.</li>
<li>also add the label parameter so that we can differentiate between the histogram of the SPY and XOM.</li>
</ul>
<blockquote>
<p>Time: 00:01:31</p>
</blockquote>
<h1>9 - Scatterplots</h1>
<p><img alt=" " src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-c5f4d817d9d44a64.png"/></p>
<p>A scatterplot is another way to visualize the differences between daily returns of individual stocks. The left graph is daily return of two stocks. S&amp;P 500 and XYZ.</p>
<ul>
<li>On a scatterplot, there are a number of individual points or dots represents the daily returns of two stocks that happened on a particular day.</li>
<li>the dots are somewhat scattered. They don't form a perfect line.</li>
</ul>
<blockquote>
<p>Time: 00:02:02</p>
</blockquote>
<h1>10 - Fitting a line to data points</h1>
<p><img alt=" " src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-0b01cbbb89cba079.png"/></p>
<ul>
<li><p>we can fit a line to it using linear regression.</p>
</li>
<li><p>slope, in financial terminology, is usually referred to as <strong>beta</strong> which means is how reactive is the stock to the market.</p>
<ul>
<li>e.g. Beta = 1 then on average, when the market goes up 1%, that particular stock also goes up 1%.</li>
<li>if beta = 2, then if the market were to go up 1%, we'd expect on average for that stock to go up 2%.</li>
</ul>
</li>
<li><p>intercepts, also called alpha. Positive alpha means that this stock is actually on average performing a little bit better than the S&amp;P 500 every day. If it's negative, it means on average it's returning a little bit less than the market overall.</p>
</li>
</ul>
<blockquote>
<p>Time: 00:01:53</p>
</blockquote>
<h1>11 - Slope does not equal correlation</h1>
<p><img alt="" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-e4fab13dcca23841.png"/></p>
<ul>
<li>The slope is no correlation.</li>
<li>Correlation is a measure of how tightly do these individual points fit that line. the range of correlation is from 0 to 1.</li>
</ul>
<blockquote>
<p>Time: 00:01:15</p>
</blockquote>
<h1>12 - Quiz: Correlation vs slope</h1>
<p><img alt="quiz" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-6eec18602a51c640.png"/></p>
<p>Select the option that best compares ABC against XYZ, in terms of beta (slope of linear fit) and correlation with the market (represented by SPY).</p>
<h1>13 - Scatterplots in python</h1>
<p><img alt="" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-d8d4e4750d6836a2.png"/>
Key codes</p>
<pre><code>daily_returns.plot(kind='scattr',x='SPY', y='XOM') # scatterplot 
beta_XOM,alpha_XOM=np.polyfit(daily_returns['SPY'],daily_returns['XOM'], 1)
plt.plot(daily_returns['SPY'],beta_XOM*daily_returns['SPY'] + alpha_XOM, '-',color='r')
plt.show()
</code></pre>
<ul>
<li>Kind parameter of the plot function of the data frame will help us plot scatterplots.</li>
<li>NumPy's <code>ployfit()</code> function can fit a line to scatterplots and get alpha and beta of the regression line. the parameter "1" means the fitting is linear, y = mx + b.Here m is the coefficient and b is the intercept.</li>
</ul>
<p><img alt="" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-d413408850c7c16e.png"/></p>
<ul>
<li>beta values for the XOM is greater as compared to that of GLD so that XOM is more reactive to market as compared to GLD.</li>
<li>the alpha values denote how well it performs with respect to SPY and Numbers indicate that GLD performed better.</li>
</ul>
<p>One last thing is to find the correlation yet again.</p>
<p><code>daily_returns.corr(method='pearson')</code> will output in the correlation matrix with the correlation of each column with each other column.</p>
<ul>
<li>high correlation means the dots fit the line closely.</li>
</ul>
<blockquote>
<p>Time: 00:04:45</p>
</blockquote>
<h1>14 - Real world use of kurtosis</h1>
<p><img alt="" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-61f7060c0091a351.png"/></p>
<ul>
<li>the distribution of daily returns for stocks and the market looks very similar to a Gaussian.</li>
<li>but it is dangerous to assume that financial returns are normal distributions because it ignores kurtosis or the probability in the tails.</li>
<li>In the early 2000s investment banks built bonds based on mortgages and assumed that the distribution of returns for these mortgages was normally distributed.</li>
<li>Their model failed because of the assumption of normal distribution</li>
</ul>
<blockquote>
<p>Time: 00:01:06</p>
</blockquote>
<blockquote>
<p>Total Time: 00:24:11</p>
</blockquote>
<pre><code>2019-01-12 初稿
</code></pre>
