<h2>原文：<a href="https://conge.livingwithfcs.org/2019/01/28/ML4T-03-03-Assessing-a-learning-algorithm">ML4T笔记 | 03-03 Assessing a learning algorithm</a></h2>
<hr/>
<h2>layout: post
title: "ML4T笔记 | 03-03 Assessing a learning algorithm"
date: "2019-01-28 01:28:28"
categories: 计算机科学
auth: conge
tags: Machine_Learning Trading ML4T OMSCS</h2>
<ul>
<li>content
{:toc}</li>
</ul>
<h1>01 - Overview</h1>
<p><img alt="image.png" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-7f5aeeaa1331c52d.png"/></p>
<p>In this lesson, we'll learn methods for assessing those algorithms.</p>
<blockquote>
<p>Time: 00:00:25</p>
</blockquote>
<h1>02 - A closer look at KNN solutions</h1>
<p><img alt="KNN" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-09d131bd3ee4ec20.png"/></p>
<ul>
<li>If we query with X values using 3-NN, for example, as the X moves along the X-axis, the members of the KNN change, thus the resulted Y line (in red) will have small jumps.</li>
<li>but the beginning and the end of the data, there are parts of the lines are flat (query gives the same value).</li>
<li>Good thing: it's not overfitting the data.</li>
<li>Negative aspect: the model is not able to extrapolate when data is not available.</li>
</ul>
<blockquote>
<p>Time: 00:01:59</p>
</blockquote>
<h1>03 - What Happens as K Varies Quiz</h1>
<p><img alt=" " src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-e92d89af64667b40.png"/></p>
<p><strong>what happens to the model when we change the value of k?</strong></p>
<ul>
<li>maching K and graph and anwner when is KNN are more likely to overfit.</li>
</ul>
<p>So we've got three k nearest neighbor models here.</p>
<ul>
<li><p>overfitting is: An overfit model strives really hard to match the dataset exactly.</p>
</li>
<li><p>When k=N, the model will be the mean of all the data.</p>
</li>
<li><p>When K=1 the model is going to tag each point exactly, because, when we're at that data point, we'll have exactly that value. This overfits.</p>
</li>
<li><p>K=3, is our example above.</p>
</li>
</ul>
<blockquote>
<p>Time: 00:01:07</p>
</blockquote>
<h1>04 - What Happens as D Varies Quiz</h1>
<p><img alt="" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-6fdf7235c8d83f77.png"/></p>
<p>Given a polynomial model of degree d.</p>
<ol>
<li><strong>what happens to the model when we change the value of d?</strong></li>
<li>True or false, as we increase d we are more likely to overfit.</li>
</ol>
<p>Answer: 1) d=1, a linear model. (C)
2) d=2, a parabola.
3)</p>
<ul>
<li>Now as you notice, as we increase from order one to order two to order three, we're gradually getting closer and closer to tagging the actual data. So we get to this question, as we increase d we are more likely to overfit.</li>
<li>Note: parametric models can extrapolate in the direction the data seem to be going.</li>
</ul>
<blockquote>
<p>Time: 00:01:37</p>
</blockquote>
<h1>05 - Metric 1: RMS Error</h1>
<p><img alt=" " src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-e0c6cb69c4888e76.png"/></p>
<ul>
<li>an error is the difference between the real data and estimated data.</li>
<li>A standard way to measure error is called RMS error.</li>
<li><code>RMS = sqrt((Y_real - Y_predict)&lt;sup&gt;2&lt;/sup&gt; / N)</code></li>
<li>RMS is a great representation of mean of error, but it emphasize the large error more.</li>
</ul>
<blockquote>
<p>Time: 00:01:32</p>
</blockquote>
<h1>06 - In Sample vs out of sample</h1>
<p><img alt=" " src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-7009fe2a52c74677.png"/></p>
<ul>
<li>The error of this linear model against our original training data (Green dots) is important.</li>
<li>But the more important measure is the <strong>error out of sample</strong>.</li>
<li><strong>out of sample</strong> means training on our training set, but testing on a separate <strong>testing set</strong> of data.</li>
</ul>
<blockquote>
<p>Time: 00:00:56</p>
</blockquote>
<h1>07 - Quiz: Which is worse</h1>
<p><img alt="Which sort of error would you expect to be larger?" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-689bae0da218b0c6.png"/></p>
<p><strong>Which sort of error would you expect to be larger?</strong></p>
<ul>
<li>In sample error, in which we measure the accuracy of our model against the set it was trained on?</li>
<li>Or out of sample error, where we measure the error of the model against a new test set that it hasn't seen before?</li>
</ul>
<p>The answer is: out of sample error is expected to be worse</p>
<blockquote>
<p>Time: 00:00:07</p>
</blockquote>
<h1>08 - Cross-validation</h1>
<p><img alt=" " src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-e8b29753b7df85fd.png"/></p>
<ul>
<li><strong>Cross-validation</strong>: evaluating a learning algorithm, they split their data into a training chunk (60%), and a testing chunk(40%).</li>
<li>one trial = train once and test once. (measure out of sample root means square error to assess your algorithm).</li>
</ul>
<p><img alt="." src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-43f023746498e628.png"/></p>
<ul>
<li>One way to analyze algorithm with limited data: slicing the data up and running more trials.</li>
<li>slice our data into five different chunks, run <strong>five trials</strong> with one of the chunks as testing data and the rest 4 as training data.</li>
</ul>
<blockquote>
<p>Time: 00:01:09</p>
</blockquote>
<h1>09- Roll forward cross-validation</h1>
<p><img alt=" " src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-85a468bd94e78edb.png"/></p>
<ul>
<li>The typical usage of Cross validation doesn't fit financial data applications well because it can permit peeking into the future when the training data is after the test data. we need to avoid "peeking into the future ".</li>
<li>Roll forward cross-validation is a way of doing it. That means our training data is always before our testing data.</li>
</ul>
<blockquote>
<p>Time: 00:00:47</p>
</blockquote>
<h1>10 - Metric 2 correlation</h1>
<p><img alt=" " src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-3224387743d89d3d.png"/></p>
<ul>
<li>Y_predict = f(X_test), and f(x) is the model</li>
<li>the correlation between Y_predict and Y_test can be used to evaluate model <em>f(x)</em>.</li>
<li>correlation value (<em>r</em>) range is [-1, 1]. when <em>r</em> is close to 0, the correlation is low. when <em>r</em> is close to 1, the correlation is positively strong; when <em>r</em> is close to -1, the correlation is still strong but the variables are inversely correlated.;</li>
<li><code>np.corrcoef()</code> to measure the correlation between Ytest and Ypredict.</li>
<li>visualization:<ul>
<li>High correlation means the line and dots are well aligned as a nice oval that fits close to that line,</li>
<li>If it's a big round thing we've got poor correlation.</li>
</ul>
</li>
</ul>
<blockquote>
<p>Time: 00:02:14</p>
</blockquote>
<h1>11 - Correlation and RMS error</h1>
<p><img alt=" " src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-aead9bc1982d1920.png"/></p>
<p>My answer is: when error decreases, the correlaion become stronger. But the value could go both ways as correlation becomes stronger. E.g.: Negative correlation is stronger when the <em>r</em> value decreases, but when correlation is positive, it is stronger when the <em>r</em> value increase.&gt; Time: 00:00:30</p>
<h1>12 - Overfitting</h1>
<p><img alt=" " src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-5962f4a4166bd161.png"/></p>
<p>In the graph:</p>
<p>Example: parameterized polynomial models where we can add additional factors, like x, x squared, x cubed, x to the fourth, and so on.</p>
<ul>
<li>then measure error as we increase d (degree of freedom, which is related to the number of factors) on our training set.</li>
<li>The in-sample error will start high can decrease to 0</li>
<li>The out of sample error will also start high, decrease as d increases and eventually start increasing again.</li>
<li>the expected out of sample error is always be greater than or equal to in-sample error.</li>
</ul>
<p>__ As we increase degrees of freedom, our in sample error is decreasing, but our out of sample error is increasing. And that's how we define overfitting.__</p>
<blockquote>
<p>Time: 00:02:14</p>
</blockquote>
<h1>13 - Overfitting Quiz</h1>
<p><img alt="image.png" src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-d9a7001a9deb876e.png"/></p>
<p><strong>overfitting in KNN</strong></p>
<p>As K increases, how the in-sample error and out-sample error will look like?</p>
<p><strong>Overfitting Solution</strong></p>
<p>The answer is b.</p>
<ul>
<li>When k = 1, the model fits the training data perfectly, therefore the in-sample error is low (ideally, zero).  The out-of-sample error can be quite high.</li>
<li>As K increases, the model becomes more generalized, thus out-of-sample error decreases at the cost of slightly increasing in-sample error.</li>
</ul>
<blockquote>
<p>Time: 00:00:57</p>
</blockquote>
<h1>14 - A Few Other Considerations Quiz</h1>
<p><img alt=" " src="/media/wwww/share/study/聚聚/源数据/博客聚合/conge.livingwithfcs.org/assets/images/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/118382-402776dfddff884a.png"/>
<strong>Which are better?</strong></p>
<p>Solution:</p>
<ol>
<li>Linear regression does not need much to save the model but KNN requires all the data to be saved.</li>
<li>Compute time to train. KNN takes zero time to train KNN. Linear regression has to take all that data, compute over it, to find those parameters.</li>
<li>Compute time to query. LinReg wins. KNN requires time to query  across all the data.</li>
<li>Ease to add new data. KNN wins that because all you gotta do is just plop it in there, no re-calculation. With linear regression, you have to add the new data and then recompute the factors.</li>
</ol>
<blockquote>
<p>Time: 00:01:14</p>
</blockquote>
<blockquote>
<p>Total Time: 00:21:10</p>
</blockquote>
<pre><code>2019-01-28 初稿
</code></pre>
