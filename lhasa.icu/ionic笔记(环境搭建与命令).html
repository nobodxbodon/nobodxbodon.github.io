<h2><a href="https://github.com/achuanya/lhasa.github.io/blob/master/_posts/2019-05-06-ionic.md">仓库源文</a>，<a href="https://lhasa.icu/ionic">站点原文</a></h2>
<p> 昨天下午项目经理让我学习 ionic，我就折腾了一下，经过一番折腾我挺喜欢 ionic 和 node.js，不过我也是在折腾的道路上越走越远，别看这偏博客上就那么点东西，可我这小白操作，真的非常难受...中途遇到各种问题...哎...&lt;br&gt;</p>
<h2>在项目中用到的环境依赖：&lt;br&gt;</h2>
<ul>
<li>Node.js</li>
<li>Android SDK</li>
<li>Java JDK</li>
<li>Gradle</li>
<li>ionic</li>
</ul>
<h2>下载安装Node.js</h2>
<ul>
<li>微云链接：<a href="https://share.weiyun.com/5afO4Pd?achuan.io" title="阿川的 Node.js 微云下载链接">https://share.weiyun.com/5afO4Pd?achuan.io</a>&lt;br&gt;</li>
<li>密码：<code>achuan</code>&lt;br&gt;</li>
</ul>
<p>安装的时候把环境变量默认勾选所以不用我们手动配置</p>
<pre><code class="lang-bash"># 查看的当前的Node版本
$ node -v 
v10.15.3
</code></pre>
<h3>更换源</h3>
<pre><code class="lang-bash"># 临时
$ npm --registry https://registry.npm.taobao.org install express

# 永久
$ npm config set registry https://registry.npm.taobao.org

# 验证是否更换成功
$ npm config get registry
https://registry.npm.taobao.org/
</code></pre>
<h2>第一个Node.js程序！</h2>
<pre><code class="lang-bash">achuan@DESKTOP-CL4MMTQ MINGW64 /h/Node.js
$ vi HiNodeJs.js

    console.log("Hello World!");

achuan@DESKTOP-CL4MMTQ MINGW64 /h/Node.js
$ node HiNodeJs.js
Hello World!
</code></pre>
<h3>交互模式</h3>
<p>用终端 <code>node</code> 进入交互模式，可以直接执行遇见并显示结果</p>
<pre><code class="lang-bash">achuan@DESKTOP-CL4MMTQ MINGW64 /h/Node.js  
$ node  
&gt; console.log("Hello World!");  
Hello World!  
undefined
</code></pre>
<h2>下载安装 Android SDK</h2>
<ul>
<li>微云链接：<a href="https://share.weiyun.com/5ybFh0k?achuan.io" title="阿川的 Android SDK 微云下载链接">https://share.weiyun.com/5ybFh0k?achuan.io</a>&lt;br&gt;</li>
<li>密码：<code>achuan</code>&lt;br&gt;</li>
</ul>
<h3>配置环境变量</h3>
<pre><code class="lang-bash">ANDROID_HOME
ANDROID_SDK_ROOT
H:\environment\Android\android-sdk

我也不是很理解，明明一样还要声明俩？但是少一个就报错，说 ANDROID_HOME 已经弃用......

# 在用户变量找"PATH"并新建环境变量
%ANDROID_HOME%\tools

# android 命令帮助，出现内容即环境配置成功
$ android -h
</code></pre>
<h3>配置 Android SDK Manager</h3>
<p>在<code>Android SDK Manager</code>找到下面这些勾选上，然后点击<code>Install packages</code>按钮进行下载</p>
<pre><code>Tools
    # 工具包自带的Tools
    Aondroid SDK Tools

    # Android公用平台工具
    Aondroid SDK Plaform-tools

    # Android构建工具
    Aondroid SDK BUild-tools

# 必须安装，至少需要安装一个版本的API工具包！
Android 9 (API 28)
    # 开发app平台依赖和调试工具
    SDK Platform

    # 模拟器镜像
    Intel x86 Atom_64 System Image

    # API源码
    Sources for Android SDK

Extras
    # 安卓兼容库
    Android Support Repository

    # 加速 Intel 体系的安卓模拟器
    Intel x86 Emulator Accelerator (HAXM install)
</code></pre>
<h3>创建、配置并运行 avd 模拟器</h3>
<pre><code class="lang-bash"># 创建 avd 模拟器，执行后会有个对话框，右侧有创建按钮根据需要去配置模拟器配置
$ android avd

# 运行 avd 模拟器
$ emulator -avd [avdName]
</code></pre>
<h2>下载安装 Java JDK</h2>
<p>在官网下载真是死慢，我下载后放在微云了</p>
<ul>
<li>微云链接：<a href="https://share.weiyun.com/54nkkob?achuan.io" title="阿川的 Java JDK 微云下载链接">https://share.weiyun.com/54nkkob?achuan.io</a>&lt;br&gt;</li>
<li>密码：<code>achuan</code>&lt;br&gt;</li>
</ul>
<h3>配置环境变量</h3>
<p>在安装 Java JDK 点被环境变量出现问题，需要自己手动配置一下</p>
<pre><code>JAVA_HOME
H:\environment\Java\jdk1.8.0_211

# 在用户变量找"PATH"并新建环境变量
%JAVA_HOME%\bin
</code></pre>
<p>在系统环境变量"Path"里找下面这条删掉它&lt;br&gt;
<code>C:\Program Files (x86)\Common Files\Oracle\Java\javapath</code></p>
<h2>下载安装 Gradle</h2>
<ul>
<li>微云链接：<a href="https://share.weiyun.com/5AuD53j?achuan.io" title="阿川的 Gradle 微云下载链接">https://share.weiyun.com/5AuD53j?achuan.io</a>&lt;br&gt;</li>
<li>密码：<code>achuan</code>&lt;br&gt;</li>
</ul>
<p>安装完毕后查看一下版本，成功忽略下一步，我点背。&lt;br&gt;</p>
<pre><code class="lang-bash">$ gradle -v
</code></pre>
<h3>配置环境变量</h3>
<pre><code>GRADLE_HOME
H:\environment\gradle-4.10.3

# 在用户变量找"PATH"并新建环境变量
%GRADLE_HOME%\bin
</code></pre>
<h2>安装ionic</h2>
<p>这下轮到我们的猪脚"ionic"登场!<code>npm install -g cordova ionic</code></p>
<pre><code class="lang-bash">achuan@DESKTOP-CL4MMTQ MINGW64 /h/Node.js
$ npm install -g cordova ionic
C:\Users\achuan\AppData\Roaming\npm\cordova -&gt; C:\Users\achuan\AppData\Roaming\npm\node_modules\cordov
a\bin\cordova
C:\Users\achuan\AppData\Roaming\npm\ionic -&gt; C:\Users\achuan\AppData\Roaming\npm\node_modules\ionic\bi
n\ionic
+ ionic@4.12.0
+ cordova@9.0.0
added 718 packages from 390 contributors in 658.274s
</code></pre>
<h2>第一个ionic应用！</h2>
<pre><code class="lang-bash"># 创建一个空应用 myApp
$ ionic start myApp tabs

# 添加对 android 平台的支持 
$ ionic cordova platform add android

    # 参数可选
    [android] or [ios]

# 编译项目 apk
$ ionic cordova build android [可填选参数]

    # 压缩编译项目 apk
    --prod

    # 编译发行版 apk
    --release

    # 编译压缩发行版 apk
    --release --prod

生成的 apk 文件在  `[项目名]\platforms\android\app\build\outputs\apk\debug\`
</code></pre>
<h2>运行项目进行调试</h2>
<pre><code class="lang-bash"># 用默认浏览器运行调试，默认端口`8100`，`127.0.0.1:8100`。
$ ionic serve

# 在 AVD 模拟器中运行调试 [android] or [ios]
$ ionic cordova emulate android
</code></pre>
<h3>遇到的问题</h3>
<p> 看着终端依赖疯狂报错......心好累......忽然觉得我这辈子最让我难受的不是电脑卡、网速慢这都是死问题能搞好。而这软件框架在win运行真是各种奇葩环境依赖Bug......它能把我逼疯......</p>
<ul>
<li><strong>缺少 Android SDK</strong>&lt;br&gt;</li>
</ul>
<pre><code>You have been opted out of telemetry. To change this, run: cordova telemetry on.
Failed to find 'ANDROID_HOME' environment variable. Try setting it manually.
Failed to find 'android' command in your 'PATH'. Try update your 'PATH' to include path to valid SDK directory.
[ERROR] An error occurred while running subprocess cordova.

        cordova build android exited with exit code 1.

        Re-running this command with the --verbose flag may provide more information.
</code></pre>
<ul>
<li><strong>Java JDK 版本过低</strong>&lt;br&gt;
这玩意有个对 Java JDK 版本要求，<code>不能低于1.7</code>正好被我踩个准正好1.7.....</li>
</ul>
<pre><code>Checking Java JDK and Android SDK versions
Requirements check failed for JDK 8 ('1.8.*')! Detected version: 1.7.0
Check your ANDROID_SDK_ROOT / JAVA_HOME / PATH environment variables.
ANDROID_SDK_ROOT=undefined (recommended setting)
ANDROID_HOME=H:\environment\Android\android-sdk (DEPRECATED)
[ERROR] An error occurred while running subprocess cordova.

    cordova build android exited with exit code 1.

    Re-running this command with the --verbose flag may provide more information.
</code></pre>
<ul>
<li><strong>Gradle 版本过高导致不兼容</strong>&lt;br&gt;
这玩意跟 Java JDK "搞双簧？"版本过高导致不兼容。
以前是我单独装的<code>Gradle 5.4.1 all</code>报错后不知道怎么了，自动修复给下载了<code>Gradle 4.10.3 all</code></li>
</ul>
<pre><code>Using cordova-fetch for andrid
Failed to fetch platform andrid
Probably this is either a connection problem, or platform spec is incorrect.
Check your connection and platform name/version/URL.
Error: npm: Command failed with exit code 1 Error output:
npm ERR! code E404
npm ERR! 404 Not Found: andrid@latest

npm ERR! A complete log of this run can be found in:
npm ERR! C:\Users\achuan\AppData\Roaming\npm-cache\_logs\2019-05-07T05_31_11_192Z-debug.log
[ERROR] An error occurred while running subprocess cordova.

    cordova platform add andrid --save exited with exit code 1.

    Re-running this command with the --verbose flag may provide more information.
</code></pre>
<h2>常用命令</h2>
<pre><code class="lang-bash"># 查看 Node.js 版本
$ npm -v

# 安装 ionic
$ nmp install -g ionic

# 安装 Cordova 
$ nmp install -g cordova

# 更新 ionic cordova
$ nmp update -g ionic cordova

# 查看 ionic 版本
$ ionic -v

# 查看 ionic 环境信息
$ ionic info

# 查看 ionic 信息
$ ionic -info

# 移除 [android] or [ios] 平台的支持
$ ionic cordova platform remove android

# 用浏览器进行本地调试
$ ionic serve

# 在模拟器中运行调试 [android] or [ios]
$ ionic cordova emulate android

# 显示系统中全部 android 平台
$ android list targets

# 显示系统中全部 avd 模拟器
$ android list avd

# 删除 avd 模拟器
$ android delete avd -n [avdName]
</code></pre>
