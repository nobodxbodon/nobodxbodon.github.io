<h2>原文：<a href="https://zsqk.github.io/2020/03/29/request-has-been-deprecated">Node.js 生态中的流行包 request 正式被弃用</a></h2>
<hr/>
<h2>title: Node.js 生态中的流行包 request 正式被弃用
categories: [nodejs]</h2>
<p>在 2019 年 3 月份, 作者就创建了<a href="https://github.com/request/request/issues/3142">相关 issue</a> 讨论逐步让 request 进入历史.</p>
<p>最近, <a href="https://github.com/request/request/commit/aded7e4f8e57f6f33cf39d65634bfb822bfcb2c8">作者正式宣布弃用该包</a>.</p>
<p>关于弃用的原因, 主要是历史比较久远, 核心代码已经跟不上 Node.js 的发展.</p>
<p>我倾向标准库强大的语言. Go 从设计之初就拥有强大的标准库, Node.js 则是随着
ECMAScript 的进步, 逐渐通过语法来完善与丰富自己.</p>
<h2>替代</h2>
<p>关于 request 的替代品可以参考<a href="https://github.com/request/request/issues/3143">这个 issue</a>.</p>
<h2>经验</h2>
<p>其实我们并没有使用过 request, 在 Node.js 中只是用 node-fetch 和 axios.</p>
<p>在最初进入 Node.js 的时候, 我们关注到了 request, 但语法并没有打动我们,
所以我们转向了 node-fetch.</p>
<p>因为我们同时会写前后端, 在前端标准化的 fetch 让我们能尽快入手.
但正是由于我们前后端同时在写, 我们发现 node-fetch 的语法并不完全等同 fetch.
这让我们更容易因为忽略了差异项而出错.</p>
<p>之后我们再次寻找替代品, 发现了 r2. r2 代码的体积很小, 我们就看看源代码,
发现只是简单调用了 node-fetch.</p>
<p>在最近的项目中, 我们才开始用当时还流行的 axios.</p>
<p>我不太喜欢 axios 的语法, 有些过度了. 但基于流行原则我们还是在继续使用.</p>
<p>现在来看, request 作者的新包 <a href="https://github.com/mikeal/bent">bent</a> 才是我们在 Node.js 中更应该做的选择.</p>
<h2>bent</h2>
<p>bent 是一个同时支持浏览器与 Node.js 的 HTTP client.</p>
<p>在 Node.js 环境中, 进行了 Promise 化和流的支持.</p>
<p>在浏览器端, 对 fetch 进行了简单封装以符合 bent 的 API.</p>
<p>源代码很小, 依赖也不多. API 简洁实用. 是我们理想的选择.</p>
<p>但在浏览器端, bent 的封装对我们帮助不大, 我们还是会选择 fetch 然后自己封装.</p>
