<h2><a href="https://github.com/zsqk/news/blob/master/_posts/2020-04-08-nullish-coalescing-operator.md">仓库源文</a>，<a href="https://zsqk.github.io/2020/04/08/nullish-coalescing-operator">站点原文</a></h2>
<blockquote><p>:bulb: 目前 <code>??</code> 和 <code>??=</code> 已经是 ECMAScript 正式标准了.</p>
</blockquote>
<h2><code>??</code></h2>
<p><code>??</code> 是空值合并运算符 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing_operator">nullish coalescing operator</a>, 现在已经是正式标准了.</p>
<p>听名字就挺好理解的, 主要为了替代 <code>||</code> 的部分功能.</p>
<p><code>??</code> 与 <code>||</code> 的区别在于, <code>||</code> 判断真值, 而 <code>??</code> 只会判断非空值, 比如:</p>
<ol>
<li><code>null || 1</code> 结果为 <code>1</code>, <code>0 || 1</code> 结果也为 <code>1</code>.</li>
<li><code>null ?? 1</code> 结果为 <code>1</code>, <code>0 ?? 1</code> 结果为 <code>0</code>.</li>
</ol>
<p><del>空值合并运算符是 Finished Proposals(Stage 4). 将来大家都可以用到.</del>
<del>在浏览器中的支持情况已经很好了, 主流浏览器的最新版本都支持. 最新的 V8 已经支持,</del>
<del>但目前 Node.js 还不支持.</del></p>
<p><code>??</code> 是一个有用的语法糖, 推荐大家使用.</p>
<h2><code>??=</code></h2>
<p><code>??=</code> 是逻辑空值赋值运算符, 也是 Finished Proposals(Stage 4).</p>
<p><del>最近 <a href="https://github.com/tc39/proposals/commit/943bf8956b7d25032075e4789c1e351fdf2ae9ec">Logical Assignment Operators 提案到了 Stage 3</a>.</del></p>
<p>以前没有关注过<a href="https://github.com/tc39/proposal-logical-assignment">这一提案</a>, 今天特意看了一下.</p>
<p>提案中说道, 在 ECMAScript 规范中, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Assignment_Operators">有许多数学的赋值运算符</a>,
但却没有逻辑的赋值运算符.</p>
<p>普通的赋值运算符就是 <code>=</code>. 数学的赋值运算符比如 <code>+=</code> 是加法的赋值运算符,
<code>-=</code> 是减法的赋值运算符.</p>
<p>所有的特殊赋值运算符目的都是为了简洁, 只是一种语法糖.</p>
<p>不过既然我们都有了数学的赋值运算符, 那就是认可了这种语法糖, 提案者据此提出了
逻辑的赋值运算符.</p>
<p>当然也是借鉴了其他语言, 如 Ruby.</p>
<pre><code class="lang-js">let opts = { foo: 'foo' };

// 传统写法
if (opts.foo === null || opts.foo === undefined) {
    opts.foo = 'bar';
}

// 使用空值合并运算符的简写方式
// 注意：这种写法会总是触发赋值操作
opts.foo = opts.foo ?? 'bar';

// 使用括号来避免不必要的赋值
// 只有在 opts.foo 为 null 或 undefined 时才会执行赋值
opts.foo ?? (opts.foo = 'bar');

// 使用逻辑空值赋值运算符的最简写法
// 效果同上，更加简洁直观
opts.foo ??= 'bar';
</code></pre>
