<h2><a href="https://github.com/jerkwin/jerkwin.github.io//blob/master/_posts/2017-02-25-pdf文件标签管理工具Taggie.md">仓库源文</a>，<a href="https://jerkwin.github.io/2017/02/25/pdf文件标签管理工具Taggie">站点原文</a></h2>
<hr/>
<p>layout: post
 title: pdf文件标签管理工具Taggie
 categories:</p>
<ul>
<li>科
tags:</li>
<li>编程</li>
<li>ahk</li>
</ul>
<hr/>
<ul>
<li>2017年02月25日 20:02:23 整理: 文博; 补充: 李继存</li>
</ul>
<p>以前的时候开发过一个<a href="http://jerkwin.github.io/2014/10/07/Taggie-%E5%9F%BA%E4%BA%8E%E6%A0%87%E7%AD%BE%E7%9A%84%E6%A1%8C%E9%9D%A2%E6%90%9C%E7%B4%A2%E5%B7%A5%E5%85%B7/">基于标签的桌面搜索工具 Taggie</a>, 虽然可用, 但性能不够好, 所以就没有发布. 现在基于Everything将这个工具重新改写了一下, 性能没问题了, 但只能用于pdf文件, 尤其适用于科学论文pdf文件的整理和搜索. 毕竟, 对做科研的人来说, 阅读这种文件最多, 有时候在成千上百的pdf中找到需要的那一篇, 还真不容易.</p>
<h2>初始设置</h2>
<p>Taggie暂时只支持pdf文件, 且需配合Everything, Chrome, PDF-XChangeViewer使用.</p>
<ul>
<li><p>默认浏览器: 谷歌Chrome, 暂不支持其他浏览器(IE, 火狐之类). Chrome虽然有点大, 但性能好, 且自带了pdf查看功能, 方便直接查看pdf文件.</p>
</li>
<li><p>默认pdf查看器: PDF-XChangeViewer 2.5, 暂不支持其他pdf软件. 除编辑功能外, PDF-XChangeViewer基本能满足所有需要, 且程序小巧, 启动速度快.</p>
</li>
</ul>
<p>点击<a href="/prog/PDF-XChangeViewer.zip">这里</a>下载PDF-XChangeViewer. 解压后, 需要将其菜单项<code>复制完整文件名称</code>对应的快捷键设为<code>Alt+n</code>. 因为Taggie需要借助于此快捷键获取已打开pdf文件的完整路径, 否则无法定位打开的pdf文件. 具体方法如下:</p>
<p>在工具栏点击鼠标右键打开<code>自定义</code>.</p>
<p><strong>注意</strong> 若在工具栏右键时只出现<code>锁定/解锁所有命令栏</code></p>
<p><img alt="" src="https://jerkwin.github.io/pic/taggie_1.png"/></p>
<p>请先点击<code>锁定/解锁所有命令栏</code>, 将工具栏解锁. 这样再次在工具栏右键就会出现需要的菜单项了.</p>
<p><img alt="" src="https://jerkwin.github.io/pic/taggie_2.png"/></p>
<p>选中<code>自定义</code>, 在其<code>命令</code>选项卡下, 依次点击<code>文件 | 复制完整文件名称 | 属性</code>, 将其<code>快捷键</code>设为<code>Alt+n</code>.</p>
<p><img alt="" src="https://jerkwin.github.io/pic/taggie_3.png"/></p>
<p><img alt="" src="https://jerkwin.github.io/pic/taggie_4.png"/></p>
<h2>使用方法</h2>
<p>下载 <a href="/prog/Taggie.zip">Windows7 64位 Taggie</a> 或 <a href="/prog/Taggie.win32.zip">Windows7 32位 Taggie</a>. 压缩包中包含了Taggie程序及其运行所需的Everything和其他程序. 如果你还不了解Everything程序, 请先了解下<a href="http://xbeta.info/everything-search-tool.htm">Everything: 速度最快的文件名搜索工具</a>.</p>
<p>解压后,</p>
<ol>
<li>双击运行<code>everything.exe</code>, 搜索全盘文件, 并建立索引, 为后面搜索做准备</li>
<li>双击运行<code>taggie.exe</code>. 程序会在后台运行.</li>
<li>打开<code>taggie.html</code>(默认应使用Chrome浏览器). 初始显示内容为最后一次的搜索结果.</li>
</ol>
<p><img alt="" src="https://jerkwin.github.io/pic/taggie_5.png"/></p>
<p>建议将Everything和Taggie设置为开机启动, 这样就不用每次手动运行它们了.</p>
<h3>搜索文件</h3>
<p>要进行新的搜索, 可在搜索框中输入关键词, 直接回车或点击右边的搜索按钮即可.</p>
<p>第一次启动搜索时, Chrome可能会提示<code>外部协议请求</code>,</p>
<p><img alt="" src="https://jerkwin.github.io/pic/taggie_6.png"/></p>
<p>请勾选<code>记住我对所有此类链接的选择</code>, 然后<code>启动应用</code>即可.</p>
<p>搜索完成后, 会自动打开一个新的Taggie页面, 显示所有搜索到的pdf文件.</p>
<ul>
<li>点击每个文件的标题可以直接使用Chrome浏览器查看文件</li>
<li>点击<code>默认程序打开</code>则使用默认的PDF-XChangeViewer查看文件</li>
<li>点击每个文对应的<code>目录</code>可调用资源管理器打开文件所在的目录, 并选中该文件</li>
<li>如果搜索结果的<code>文献</code>项中含有论文的DOI, 点击DOI链接会打开论文的原文网址.</li>
</ul>
<h3>编辑标签</h3>
<p>使用PDF-XChangeViewer打开pdf文件后, 按下快捷键<code>Alt+z</code>会弹出taggie窗口</p>
<p><img alt="" src="https://jerkwin.github.io/pic/taggie_7.png"/></p>
<p>在此窗口中可以设置当前pdf文件的标题, 作者, 杂志, DOI, 标签.</p>
<p>设置好后, 点击<code>根据以上设置重命名文件</code>, PDF-XChangeViewer会先关闭此pdf文件, 将其重命名为<code>【标签】;【作者】;【标题】;【杂志】;【DOI】.pdf</code>, 然后重新载入.</p>
<p>如果在<code>标签</code>文本框中输入待查询的关键词, 点击右面的<code>搜索已有标签</code>, taggie会自动搜索文件, 并使用浏览器显示结果. 效果等同于在Chrome的搜索框中输入关键词进行搜索.</p>
<p>如果科研论文对应的pdf文件中含有DOI号, 点击<code>自动获取</code>会自动提取文件中的DOI并联网查询标题等信息. 如果获取DOI失败, 你可以自己填写DOI并点击右面的<code>获取引用数据</code>. 此功能需要用户电脑已经连接到网络, 且通过网络查询数据需要一点时间, 所以可能不会立即显示结果.</p>
<h3>设置与使用简单演示</h3>
<p>感谢 文博 录制下图.</p>
<p><img alt="" src="https://jerkwin.github.io/pic/taggie_8.gif"/></p>
<h2>其他功能</h2>
<h3>快捷键</h3>
<p>为Chrome和PDF-XChangeViewer添加的快捷键</p>
<ul>
<li><code>Esc</code>: 关闭当前网页或pdf文档</li>
<li><code>F3</code>: 网页后退</li>
<li><code>F4</code>: 网页前进</li>
<li><code>中键</code>: 向下翻页</li>
<li><code>Shift+中键</code>: 向上翻页</li>
<li><code>Shift+空格键</code>: 向上翻页</li>
<li><code>Ctrl+g</code>: 使用 谷歌学术 搜索选中文字</li>
<li><code>Ctrl+x</code>: 使用 词博词典 搜索选中文字</li>
</ul>
<p>其他</p>
<ul>
<li><code>F1</code>: 另存, <code>Ctrl+s</code></li>
<li><code>F2</code>: 全选, <code>Ctrl+a</code></li>
<li><code>F5</code>: 复制, <code>Ctrl+c</code></li>
<li><code>F6</code>: 剪切, <code>Ctrl+x</code></li>
<li><code>F9</code>: 粘帖, <code>Ctrl+v</code></li>
<li><code>F11</code>: 打开<code>开始 | 运行</code>, <code>Win+r</code></li>
<li><code>Ctrl+E</code>: 追加复制, 即将选中文字追加到剪切板</li>
</ul>
<h2>说明建议</h2>
<ul>
<li>Windows 10以下版本文件名最多260字符, 所以当论文标题过长时会被截断. 据说Windows 10可以不限制文件名长度, 我没有测试.</li>
<li>实际搜索时, 只要文件的整个路径中含有指定关键词即可, 而不是只搜索设定的标签.</li>
<li>获取pdf文件的DOI时, 只将文件前两页转换为文本, 然后在其中搜索与DOI模式匹配的字符串. 速度不好, 但鉴于并非所有pdf文件的元数据中都含有DOI信息, 只能采用此法.</li>
<li>重命名文件有时会出现错误, 一个可能的原因是标题或作者中含有特殊字符. 若原因不易确定, 重新再试一次即可.</li>
<li>程序有时候会假死/崩溃, 可能是调用Everything等待时间过长, 或搜索到的文件过多.</li>
</ul>
<h2>评论</h2>
<ul>
<li>2017-02-27 23:06:02 <code>小明的用户</code> 32位系统的怎么办啊？</li>
<li>2017-02-28 09:25:59 <code>Jerkwin</code> 升级吧, 或者等我编译一个32位的, 可是我没有32位的机器测试, 不知道成不成.</li>
<li>2017-02-28 19:26:44 <code>小明的用户</code> 需要的，需要的，应该不只我一个人有需求的。~~试一下，我可以先尝试。</li>
<li>2017-02-28 23:20:47 <code>Jerkwin</code> 更新了32位的下载链接, 你试试吧. 我没有32位点机器, 没法测试.</li>
<li>2017-03-06 21:31:11 <code>小明</code> 下载了，说是有病毒。。</li>
<li><p>2017-03-06 22:00:43 <code>Jerkwin</code> 没有病毒, 只不过要改注册表, 杀毒软件会认为是病毒.</p>
</li>
<li><p>2017-04-30 22:30:27 <code>花心的洋葱</code> 真的很不错喔，不知道有没有考虑将这个软件开源。。
  我觉得方向上，可以进一步朝着通用性插件进行。
  比如在TC上，TC上是有ntfs stream插件的，可以很方便的编辑ntfs Stream。文件格式上，也可以不局限于pdf。
  对于有标签需求的人来说，pdf文献是大多数，有了已经很好了！
  只要是文件都可以编辑上标签。</p>
</li>
<li><p>2017-03-23 20:49:03 <code>小红的爸爸</code> 检索软件里，还有一个locate32也不错。不知道能不能嫁接上taggie.</p>
</li>
<li>2017-03-30 23:47:11 <code>Jerkwin</code> 那个是全文搜索到, 比价慢, 组合起来就没有优势了.</li>
<li>2017-05-01 21:06:53 <code>小红的爸爸</code> 不是，locate32就文件名的索引，事先索引好的。不像everything，会实时索引新文件，需要的权限比较高</li>
<li>2017-05-04 22:23:15 <code>Jerkwin</code> 根据我看到的资料, locate32优势不大, 且未必支持外挂, 所以我的程序暂时不会支持</li>
</ul>
