<h2>原文：<a href="https://jerkwin.github.io/2016/09/21/自动更新谷歌host文件的简单程序">自动更新谷歌host文件的简单程序</a></h2>
<hr/>
<p>layout: post
 title: 自动更新谷歌host文件的简单程序
 categories:</p>
<ul>
<li>科
tags:</li>
<li>ahk</li>
</ul>
<hr/>
<ul>
<li>2016-09-21 16:17:05</li>
<li>2016-11-17 00:33:05 更换地址, 原地址失效</li>
<li>2017-09-22 21:49:31 更换地址, 感谢 <a href="https://github.com/opumps">opumps</a> 提供补丁</li>
<li>2019-01-13 21:04:52 更换地址</li>
</ul>
<p>我以前就说过, <a href="http://jerkwin.github.io/2014/06/15/%E4%B8%AD%E5%9B%BD%E5%AD%A6%E6%9C%AF%E7%95%8C%E8%A6%81%E6%B1%82%E6%9C%80%E9%AB%98/">在中国做科研要求最高</a>, 各种技能都要有, 科学上网就是其中之一. google时不时会抽风, 无法预料. 解决方法很多种, 其中最简单的就是改host文件, 使用最新可用的google hosts文件. 网上一直有人在更新这种文件, 其中一个是<a href="https://github.com/racaljk/hosts">https://github.com/racaljk/hosts</a>. 这里提供的google host文件一般都能使用. 可每次手动更新文件有点麻烦, 所以我就写了一个非常简单的autohotkey脚本来做这件事, 只要双击一下就可以自动更新了. 不过, 现在我不大需要这个脚本了, 但考虑到它对其他人或许还有点用处, 所以还是放在这里吧. 你可以直接下载我编译好的可执行文件<a href="http://jerkwin.github.io/prog/gohost.zip">gohost.exe</a>, 以管理员权限运行, 然后打开<a href="https://www.google.com/ncr">https://www.google.com/ncr</a>进行测试. 其实, 更新的host文件中不仅包括了google, 还包括了其他一些网站, 如facebook, youtube之类. 需要的话, 你也可以试试.</p>
<p><img alt="" src="https://jerkwin.github.io/pic/gohost.png"/></p>
<p>相应的源代码如下, 需要的可以参考</p>
&lt;table class="highlighttable"&gt;&lt;th colspan="2" style="text-align:left"&gt;gohost.ahk&lt;/th&gt;&lt;tr&gt;&lt;td&gt;&lt;div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"&gt;&lt;pre style="line-height:125%"&gt;1
2
3
4
5
6
7
8
9&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight"&gt;&lt;pre style="line-height:125%"&gt;&lt;span&gt;&lt;/span&gt;whr &lt;span style="color: #666666"&gt;:=&lt;/span&gt; &lt;span style="color: #00A000"&gt;ComObjCreate&lt;/span&gt;(&lt;span style="color: #BB4444"&gt;"WinHttp.WinHttpRequest.5.1"&lt;/span&gt;)
whr&lt;span style="color: #666666"&gt;.&lt;/span&gt;Open(&lt;span style="color: #BB4444"&gt;"GET"&lt;/span&gt;, &lt;span style="color: #BB4444"&gt;"https://raw.githubusercontent.com/googlehosts/hosts/master/hosts-files/hosts"&lt;/span&gt;)

whr&lt;span style="color: #666666"&gt;.&lt;/span&gt;Send()
&lt;span style="color: #AA22FF"&gt;FileDelete&lt;/span&gt;, C&lt;span style="color: #666666"&gt;:&lt;/span&gt;\WINDOWS\system32\drivers\etc\hosts
&lt;span style="color: #AA22FF"&gt;FileAppend&lt;/span&gt;, &lt;span style="color: #666666"&gt;%&lt;/span&gt; whr&lt;span style="color: #666666"&gt;.&lt;/span&gt;ResponseText, C&lt;span style="color: #666666"&gt;:&lt;/span&gt;\WINDOWS\system32\drivers\etc\hosts
&lt;span style="color: #AA22FF"&gt;run&lt;/span&gt;, ipconfig &lt;span style="color: #666666"&gt;/&lt;/span&gt;flushdns, , Hide
&lt;span style="color: #AA22FF"&gt;msgbox&lt;/span&gt;, hosts&lt;span style="#FF0000"&gt;已经更新&lt;/span&gt;, &lt;span style="#FF0000"&gt;请使用&lt;/span&gt; https&lt;span style="color: #666666"&gt;://&lt;/span&gt;www&lt;span style="color: #666666"&gt;.&lt;/span&gt;google&lt;span style="color: #666666"&gt;.&lt;/span&gt;com&lt;span style="color: #666666"&gt;/&lt;/span&gt;ncr &lt;span style="#FF0000"&gt;打开谷歌测试&lt;/span&gt;
&lt;span style="color: #AA22FF"&gt;run&lt;/span&gt;, https&lt;span style="color: #666666"&gt;://&lt;/span&gt;www&lt;span style="color: #666666"&gt;.&lt;/span&gt;google&lt;span style="color: #666666"&gt;.&lt;/span&gt;com&lt;span style="color: #666666"&gt;/&lt;/span&gt;ncr&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;<p>另外, 使用google搜索得到的很多链接默认是http, 你有时可能无法打开. 如果这样的话, 建议你始终使用加密链接https, chrome浏览器和火狐浏览器都可以设置, 方法见<a href="https://laod.cn/hosts/suggestions-for-google-hosts-https-ssl.html">强制 Google.com 域名使用 HTTPS（SSL）</a>.</p>
<p>此外, 还有一些google的镜像网站可以试试, 当然也不知道它们能坚持多久, 且用切珍惜吧.</p>
<ul>
<li><a href="http://www.itechzero.com/google-mirror-sites-collect.html">Google 镜像站搜集</a></li>
<li><a href="http://scholar.glgoo.org/#userconsent#">Google 学术搜索</a></li>
<li><a href="http://www.liu16.com/g.html">Google 镜像搜索</a></li>
<li><a href="http://so.chongbuluo.com/">快搜</a></li>
</ul>
