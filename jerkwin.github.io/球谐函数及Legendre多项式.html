<h2><a href="https://github.com/jerkwin/jerkwin.github.io//blob/master/_posts/2013-08-10-%E7%90%83%E8%B0%90%E5%87%BD%E6%95%B0%E5%8F%8ALegendre%E5%A4%9A%E9%A1%B9%E5%BC%8F.md">仓库源文</a>，<a href="https://jerkwin.github.io/2013/08/10/%E7%90%83%E8%B0%90%E5%87%BD%E6%95%B0%E5%8F%8ALegendre%E5%A4%9A%E9%A1%B9%E5%BC%8F">站点原文</a></h2>
<hr/>
<p>layout: post
title: 球谐函数及Legendre多项式
categories:</p>
<ul>
<li>科
tags:</li>
<li>数理
math: true</li>
</ul>
<hr/>
<h2>2013-08-10 10:49:40</h2>
<p>球谐函数是一类特殊函数. 虽说被称为特殊函数, 其实它们并没有什么特殊的地方, 只不过比那些常见的指数函数、三角函数稍微复杂一些而已, 你一旦熟悉了它们的性质, 就不会再觉得它们有什么特殊了.</p>
<p>这类特殊函数之所以在物理、化学和计算机科学中都有着重要应用, 是因为它们的独特性质：</p>
<ol>
<li>构成一组正交基, 任何球面上的函数都可以展为球谐函数的线性组合</li>
<li>展开系数平方和具有旋转不变性</li>
</ol>
<p>由性质1, 我们可以把原子波函数的角度部分展开为球谐函数的线性组合. 化学物理中为人熟知的原子轨道的角度部分就是球谐函数, 常用的spdf轨道实际就是经过处理的几个球谐函数.</p>
<p>对性质2, 在计算机图形学的形状识别中有着重要应用, 许多识别算法就是基于球谐函数的旋转不变性.</p>
<p>定义：基于缔合Legendre多项式(Associated Legendre Polynomial)</p>
<p>$\mathrm Y_l^m = \sqrt{ {2l+1\over4\pi} {(l-m)!\over(l+m)!} } \mathrm P_l^m(\cos\theta) \mathrm e^{im\phi}, m \in Z, \theta \in [0,\pi], \phi \in [0,2\pi]$</p>
<p>此定义式对m正负无要求, 故</p>
<p>$\mathrm Y^{\bar m}_l = \sqrt{ {2l+1\over4\pi} {(l+m)!\over(l-m)!} }\mathrm P_l^{\bar m}(\cos\theta) \mathrm e^{-im\phi}$</p>
<p>缔合Legendre多项式</p>
<p>$\mathrm P_l^m(x) = (-1)^m (1-x^2)^{m/2} {\mathrm d^m \over \mathrm dx^m} \mathrm P_l(x), m&gt;0$</p>
<p>若m取负值时, 定义为</p>
<p>$\mathrm P_l^{\bar m} = (-1)^m {(l-m)! \over (l+m)!} \mathrm P_l^m(x)$</p>
<p>故</p>
<p>$\mathrm Y^{\bar m}_l = \sqrt{ {2l+1 \over 4\pi} {(l+m)! \over (l-m)!} } (-1)^m {(l-m)! \over (l+m)!} \mathrm P_l^m(\cos\theta)\mathrm e^{-im\phi} = \sqrt{ {2l+1 \over 4\pi} {(l-m)! \over (l+m)!} } (-1)^m \mathrm P_l^m(\cos\theta)\mathrm e^{-im\phi} =(-1)^m (\mathrm Y_l^m)^*$</p>
<p>$(-1)^m$ 项称为Condon-Shortley相因子, 有人会省略此项, Mathematica计算时会考虑此项.</p>
<p>此外, $\mathrm Y_l^m(-\theta, -\phi) = [\mathrm Y_l^m(\theta,\phi)]^*$</p>
<p>由于Legendre多项式归一化条件为</p>
<p>$$\int_{-1}^1 \mathrm P_l^m(x) \mathrm P_{l'}^m(x) dx = {2 \over 2l+1} {(l+m)! \over (l-m)!} \delta_{ll'}$$</p>
<p>$$\int_{-1}^1 \mathrm P_l^m(x) \mathrm P_{l'}^{\bar m}(x) dx = (-1)^m {2 \over 2l+1} \delta_{ll'}$$</p>
<p>故可定义归一化Legendre多项式为</p>
<p>$\hat {\mathrm P}_l^m(x) = \sqrt{ {2l+1 \over 2} {(l-m)! \over (l+m)!} } \mathrm P_l^m(x), m \in Z$</p>
<p>$\hat {\mathrm P}_l^{\bar m}(x) = (-1)^m \hat{\mathrm P}_l^m(x)$</p>
<p>其最大值为 $\mathrm P_l^0(\pm 1)=\sqrt{2l+1 \over 2}$
满足归一化条件</p>
<p>$\int_{-1}^1 \hat {\mathrm P}_l^m(x) \hat {\mathrm P}_l^m(x) dx = 1$</p>
<p>$\int_{-1}^1 \hat {\mathrm P}_l^m(x) \hat {\mathrm P}_l^{\bar m}(x) dx = (-1)^m$</p>
<p>利用归一化条件, 我们可以重新定义球谐函数为</p>
<p>$\mathrm Y_l^m = {1 \over \sqrt{2\pi}} \hat {\mathrm P}_l^m(\cos\theta) \mathrm e^{im\phi}$</p>
<p>$|\mathrm Y_l^m| = {1 \over \sqrt{2\pi}} \hat{\mathrm P}_l^m(\cos\theta)$</p>
<p>$\Re{\mathrm Y_l^m} = {1 \over \sqrt{2\pi}} \hat{\mathrm P}_l^m(\cos\theta) \cos m\phi$</p>
<p>$\Im{\mathrm Y_l^m} = {1 \over \sqrt{2\pi}} \hat{\mathrm P}_l^m(\cos\theta) \sin m\phi$</p>
<p>其中, $\hat{\mathrm P}_l^m$ 为归一化的Legendre多项式.</p>
<p>因此, 球谐函数归一化条件可写为</p>
<p>$$\int_0^{2\pi}d\phi \int_{-1}^{1} (\mathrm Y_l^m)^* \mathrm Y_l^m dx = \int_0^{2\pi}d\phi \int_{-1}^{1} {1 \over 2\pi} \hat{\mathrm P}_l^m(x) \hat {\mathrm P}_l^m(x) dx = 1$$</p>
<p>${\mathrm Y}_l^m$ 的计算实际上归结为计算缔合Legendre多项式 ${\mathrm P}_l^m$, 根据不同需要, 可适当采取下面几种方法：</p>
<ul>
<li>使用程序自带的库函数, 若其中包含Legendre多项式</li>
<li>使用Legendre多项式的显式公式, 若计算的阶数不是很大</li>
<li>利用如下递推关系进行计算, 最通用的方法
$$(l-m)\mathrm P_l^m=x(2l-1)\mathrm P_{l-1}^m-(l+m-1)\mathrm P_{l-2}^m$$<br/>
$$\mathrm P_m^m = (-1)^m(2m-1)!!(1-x^2)^{m/2}$$<br/>
$$\mathrm P_{m+1}^m = x(2m+1)\mathrm P_m^m$$<br/>
Numerical Recipes中有相应的源码, 不再赘述.</li>
</ul>
<p>计算 ${\mathrm Y}_l^m$ 时须计算 $\sin(m \phi), \cos(m\phi)$, 由于三角函数的计算较多项式为慢, 因此可利用三角公式将其展开为 $\sin\phi, cos\phi, \sin^2\phi, \cos^2\phi$ 的多项式. 下面是m到6时的公式：</p>
<p>$\sin2\phi=2\sin\phi \cos\phi, \cos2\phi=\cos^2\phi-\sin^2\phi$</p>
<p>$\sin3\phi=\sin\phi(-\sin^2\phi+3\cos^2\phi), \cos3\phi = \cos\phi(\cos^2\phi-3\sin^2\phi)$</p>
<p>$\sin4\phi=4\sin\phi \cos\phi(\cos^2\phi-\sin^2\phi), \cos4\phi = 1-8\sin^2\phi \cos^2\phi$</p>
<p>$\sin5\phi=\sin\phi[1+4\cos^2\phi(\cos^2\phi-3\sin^2\phi)], \cos5\phi = \cos\phi[1+4\sin^2\phi(\sin^2\phi-3\cos^2\phi)]$</p>
<p>$\sin6\phi=\sin\phi \cos\phi[6-32\sin^2\phi \cos^2\phi], \cos6\phi=(\cos^2\phi-\sin^2\phi)(1-16\sin^2\phi \cos^2\phi)$</p>
<p>当然, 这些优化方法只有你需要大量计算 ${\mathrm Y}_l^m$ 时才能提高点速度, 对于普通情况, 你很可能感觉不到计算速度的变化.</p>
<p>下面是一些相关函数的图像.</p>
<p><img alt="" src="https://jerkwin.github.io/pic/2013-08-10-%E7%90%83%E8%B0%90%E5%87%BD%E6%95%B0_1.png"/></p>
<p><img alt="" src="https://jerkwin.github.io/pic/2013-08-10-%E7%90%83%E8%B0%90%E5%87%BD%E6%95%B0_2.png"/></p>
<p><img alt="" src="https://jerkwin.github.io/pic/2013-08-10-%E7%90%83%E8%B0%90%E5%87%BD%E6%95%B0_3.png"/></p>
<p><img alt="" src="https://jerkwin.github.io/pic/2013-08-10-%E7%90%83%E8%B0%90%E5%87%BD%E6%95%B0_4.png"/></p>
<p>可以看出, $\mathrm P_l^0(x)$ 也就是通常所说的Legendre多项式, 为l阶多项式; $\mathrm P_l^m(x)$ 的奇偶性与l+m的奇偶一致.</p>
<p><strong>参考</strong></p>
<ol>
<li>中文wiki：<a href="http://zh.wikipedia.org/wiki/%E7%90%83%E8%B0%90%E5%87%BD%E6%95%B0">球谐函数</a></li>
<li>中文wiki：<a href="http://zh.wikipedia.org/wiki/%E7%90%83%E8%AB%A7%E5%87%BD%E6%95%B8%E8%A1%A8">球谐函数表</a></li>
<li><a href="http://www.chenkuantong.com/?p=1210">Rotation Invariant Spherical Harmonic of 3D Shape</a></li>
</ol>
