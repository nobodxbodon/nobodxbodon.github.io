<h2><a href="https://github.com/jerkwin/jerkwin.github.io//blob/master/_posts/2024-05-14-%E6%99%B6%E8%83%9E%E6%AD%A3%E6%96%B9%E5%8C%96.md">仓库源文</a>，<a href="https://jerkwin.github.io/2024/05/14/%E6%99%B6%E8%83%9E%E6%AD%A3%E6%96%B9%E5%8C%96">站点原文</a></h2>
<hr/>
<p>layout: post
title: 晶胞正方化
categories:</p>
<ul>
<li>科
tags:</li>
<li>数理
math: true</li>
</ul>
<hr/>
<ul>
<li>2024-05-14 22:42:26</li>
</ul>
<p>建模的时候, 出于方便或其他原因, 我们会希望晶胞底面的两个基本矢量$\hat a$, $\hat b$尽可能地相垂直, 且长度相等, 也就是底面尽可能地接近正方形. 这样看起来比较舒服, 在上面放置其他分子也方便设置边界距离. 可以称这种做法为(正)方化, 包含两方面: 正交(垂直)和等长.</p>
<h2>晶胞的正交化</h2>
<p>设晶胞底面矢量的长度为$a$, $b$, 矢量间的夹角为$γ$, 对应的晶胞矢量为</p>
<p>$$╤
\hat a &amp;=a(1, 0) \
\hat b &amp;= b(\cosγ, \sinγ)
╧$$</p>
<p>正交化是要找到一组新的晶胞矢量$\hat {a'}$, $\hat {b'}$, 它们相互垂直或夹角尽可能接近90°. 为保持对称性, 新的晶胞矢量必须是原晶胞矢量整数倍的线性组合, 且不能为零, 即</p>
<p>$$╤
\hat {a'}&amp;=m \hat a+n \hat b \
\hat {b'}&amp;=p\hat a+q\hat b \
&amp;m, n, p, q∈Z\
&amp;mn≠0, pq≠0
╧$$</p>
<p>现在计算新矢量之间的內积, 也即二者之间夹角$θ$的余弦值</p>
<p>$$╤
\cos θ &amp;= {(m \hat a+n \hat b)·(p\hat a+q\hat b)／|m \hat a+n \hat b| |p\hat a+q\hat b|} \
&amp;= {mpa²+nqb²+(mq+np)ab\cosγ／√{m²a²+n²b²+2mnab\cosγ} √{p²a²+q²b²+2pqab\cosγ} } \
&amp;= {mp+nqt²+(mq+np)t\cosγ／√{m²+n²t²+2mnt\cosγ} √{p²+q²t²+2pqt\cosγ}}, t={b／a}
╧$$</p>
<p>当新矢量相互垂直时, $\cos θ=0$, 因而</p>
<p>$$mp+nqt²+(mq+np)t\cosγ=0$$</p>
<p>恕我脑拙, 没看出$m, n, p, q$之间要满足的具体关系. 但考虑到上式为$t$的二次方程, 当$nq≠0$时, 若有大于零的实数解, 则需满足</p>
<p>$$Δ²=(mq+np)²\cos²γ-4mnpq≥0 \
{(mq+np)\cosγ／2nq}&lt;0 \
(mq+np)\cosγ &lt;0 \
(mq+np)²\cos²γ≥4mnpq
$$</p>
<p>利用这两个不等式, 在搜索解的时候或许可以减少些次数.</p>
<p>一般情况下, 我们只能取不同的$(m, n), (p, q)$组合, 计算角度, 查找最接近90度的组合. 这种组合未必唯一.</p>
<h3>特殊情况</h3>
<p>现在考虑两种特殊情况: $m=0$或$n=0$. 也就是新的晶胞矢量中有一个为原来的轴, 这样另一个轴无须再考虑原来的轴, 即$pq≠0$</p>
<p>$$╤
m&amp;=0, &amp;qt²+pt\cosγ&amp;=0, &amp;t²+{p／q}t\cosγ=0 \
n&amp;=0, &amp;p+qt\cosγ&amp;=0,  &amp;{p／q}+t\cosγ=0
╧$$</p>
<p>这样可求得$p/q$, 取其最接近的有理数即可.</p>
<p>举个例子, 对常见的六方晶胞, $a=b$, $γ=120°$, 则$t=1$, $\cos γ= -½$</p>
<p>$$╤
m&amp;=0, &amp;1+{p／q}\cosγ=0,;;□ &amp;{p／q}=2 \
n&amp;=0, &amp;{p／q}+\cosγ=0, ;;□ &amp;{p／q}={1／2}
╧$$</p>
<h2>晶胞的等长化</h2>
<p>晶胞的等长化简单得多, 因为不考虑新矢量的方向,</p>
<p>$$╤
\hat {a'}&amp;=u \hat a \
\hat {b'}&amp;=v \hat b \
&amp;u, v ∈Z, uv≠0
╧$$</p>
<p>等长时</p>
<p>$${u／v}={b／a}$$</p>
<h2>晶胞正方化</h2>
<p>在进行正方化时, 可以先正交再等长, 也可以先等长再正交. 这两种步骤对最终结果是否有影响, 我一时也说不明白, 有待来者.</p>
<p>如果我们在一个步骤中同时考虑正交等长两方面, 结果很可能异于分步进行的结果. 如果要将其转化为优化问题, 关键在于如何选取一个目标函数, 同时尽量满足垂直和等长的要求. 考虑到等长时$a'-b'=0$, 垂直时$\sinθ=1$, 我猜测一个可行的目标函数为</p>
<p>$$f=(L²-a'²-b'²)\sinθ$$</p>
<p>这里的$L$为两轴长度和的预设值.</p>
<p>可以将前面的式子代入求得$f$的具体表达式, 但有点麻烦, 这里就不给出了.</p>
