<h2>原文：<a href="https://jerkwin.github.io/2021/04/10/gnuplot：科技期刊调色板,_高级热图">gnuplot：科技期刊调色板, 高级热图</a></h2>
<hr/>
<p>layout: post
 title: gnuplot：科技期刊调色板, 高级热图
 categories:</p>
<ul>
<li>科
tags:</li>
<li>gnuplot</li>
</ul>
<hr/>
<ul>
<li>2021-04-10 22:12:53</li>
</ul>
<h2>调色板</h2>
<p>看到网上有人整理了一些著名期刊的绘图颜色设置, <a href="https://nanx.me/ggsci/articles/ggsci.html">Scientific Journal and Sci-Fi Themed Color Palettes for ggplot2</a>, 就将其中的一些添加到我的<a href="https://jerkwin.github.io/2018/08/20/%E7%A7%91%E6%8A%80%E7%BB%98%E5%9B%BE%E7%9A%84%E8%B0%83%E8%89%B2%E6%9D%BF/">科技绘图的调色板</a>中了, 也增加到自用的gnuplot初始化脚本中了.</p>
<p>下面其中几种颜色设置的效果图.</p>
<p><img alt="" src="https://jerkwin.github.io/pic/ggsci.png"/></p>
<h2>高级热图</h2>
<p>使用gnuplot绘制热图的方法我在<a href="https://jerkwin.github.io/2020/08/23/%E4%BD%BF%E7%94%A8gnuplot%E7%BB%98%E5%88%B6xpm%E6%96%87%E4%BB%B6%E5%AF%B9%E5%BA%94%E7%9A%84%E6%95%B0%E6%8D%AE/">使用gnuplot绘制xpm文件对应的数据</a>中说过, 更详细的可以看看<a href="https://towardsdatascience.com/all-about-heatmaps-bb7d97f099d7">All About Heatmaps: The Comprehensive Guide</a>, 讲得很全面, 用的主要是python库. 我对其中的相关图作法比较有兴趣, 它是用颜色和符号大小同时来表征数据. 这种方法在<a href="https://zhuanlan.zhihu.com/p/362258222">3种场景下的相关性计算方式，热力图优化展示</a>中也介绍过. 我看了一下, gnuplot也可以做出这种图. 关键的作图命令如下:</p>
&lt;div class="highlight"&gt;&lt;pre style="line-height:125%"&gt;&lt;span style="color:#A2F"&gt;plot&lt;/span&gt; 'FILE.xyz' u 1:2:(size($3)):3 w p pt 5 ps var lt pal t""&lt;/pre&gt;&lt;/div&gt;<p>其中的<code>size</code>是一个将数据转换为符号大小的自定义函数, 可以根据数据的实际范围来确定.</p>
<p>下面是两个示例, 一个来自<code>gmx mdmat</code>, 数据表示蛋白残基之间的最小距离, 一个来自<code>gmx covar</code>, 数据表示蛋白原子之间的协方差.</p>
<p><img alt="" src="https://jerkwin.github.io/pic/heatmap.png"/></p>
