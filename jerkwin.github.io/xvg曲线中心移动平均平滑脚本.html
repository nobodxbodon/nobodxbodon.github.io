<h2>原文：<a href="https://jerkwin.github.io/2017/05/10/xvg%E6%9B%B2%E7%BA%BF%E4%B8%AD%E5%BF%83%E7%A7%BB%E5%8A%A8%E5%B9%B3%E5%9D%87%E5%B9%B3%E6%BB%91%E8%84%9A%E6%9C%AC">xvg曲线中心移动平均平滑脚本</a></h2>
<hr/>
<p>layout: post
title: xvg曲线中心移动平均平滑脚本
categories:</p>
<ul>
<li>科
tags:</li>
<li>gmx</li>
<li>bash</li>
</ul>
<hr/>
<ul>
<li>2017年05月10日 18:25:47</li>
</ul>
<p>在查看GROMACS分析程序生成的xvg文件时, 有时候曲线不够平滑, 上下波动很厉害. 为美观或其他目的有时候需要对曲线进行平滑. 常见的绘图软件一般都支持曲线平滑, 可选方法也很多. 其中最简单的是移动平均算法(moving average). 但简单的移动平均算法平滑出来的曲线存在滞后性, 对于有峰和谷的曲线不适合. 一个解决方法是采用基于中心点的移动平均算法. 简单地说, 每个点的平滑值是其自身及前后若干点数值的平均值. 下面这段脚本专门用于xvg文件的平滑, 供需要的人参考.</p>
<p>&lt;table class="highlighttable"&gt;&lt;th colspan="2" style="text-align:left"&gt;gmx_smxvg.bsh&lt;/th&gt;&lt;tr&gt;&lt;td&gt;&lt;div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"&gt;&lt;pre style="line-height: 125%"&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;div class="highlight" style="background: #f8f8f8"&gt;&lt;pre style="line-height: 125%"&gt;&lt;span&gt;&lt;/span&gt;&lt;span style="color: #B8860B"&gt;usage&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;\&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #BB4444"&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;    &lt;/span&gt;&lt;span style="color: #BB4444"&gt;gmx_smxvg&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;      &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #BB4444"&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;    &lt;/span&gt;&lt;span style="color: #BB4444"&gt;Jicun&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;Li&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;       &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #BB4444"&gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;    &lt;/span&gt;&lt;span style="color: #BB4444"&gt;2017-05-10&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;14:44:21&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;    &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #BB4444"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;Usage:&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;gmx_smxvg&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;{-n&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;5}&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;{-col&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;2}&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;lt;File.xvg...&amp;gt;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #BB4444"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;    &lt;/span&gt;&lt;span style="color: #BB4444"&gt;-n:&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;Number&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;of&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;Points&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;to&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;Run&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;Smoothing&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;Average,&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;Shoule&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;be&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;ODD&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #BB4444"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;    &lt;/span&gt;&lt;span style="color: #BB4444"&gt;-c:&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;Column&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;Number&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;of&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;the&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;Data&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;to&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;Smooth&amp;quot;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #666666"&gt;[[&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;$#&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;-lt&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;1&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;]]&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;{&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #AA22FF"&gt;echo&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;&lt;/span&gt;&lt;span style="color: #B8860B"&gt;$usage&lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;&lt;/span&gt;;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;exit;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;}&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;</p>
<p>&lt;span style="color: #B8860B"&gt;pnt&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;5;&lt;span style="color: #bbbbbb"&gt;    &lt;/span&gt;&lt;span style="color: #B8860B"&gt;col&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;2&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #B8860B"&gt;opt&lt;/span&gt;&lt;span style="color: #666666"&gt;=(&lt;/span&gt;&lt;span style="color: #B8860B"&gt;$@&lt;/span&gt;&lt;span style="color: #666666"&gt;)&lt;/span&gt;;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;N&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #BB6688; font-weight: bold"&gt;${#&lt;/span&gt;&lt;span style="color: #B8860B"&gt;opt&lt;/span&gt;[@]&lt;span style="color: #BB6688; font-weight: bold"&gt;}&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #AA22FF; font-weight: bold"&gt;for&lt;/span&gt;&lt;span style="color: #666666"&gt;((&lt;/span&gt;&lt;span style="color: #B8860B"&gt;i&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;0;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;i&amp;lt;N;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;i++&lt;span style="color: #666666"&gt;))&lt;/span&gt;;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #AA22FF; font-weight: bold"&gt;do&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;  &lt;/span&gt;&lt;span style="color: #B8860B"&gt;arg&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #BB6688; font-weight: bold"&gt;${&lt;/span&gt;&lt;span style="color: #B8860B"&gt;opt&lt;/span&gt;[&lt;span style="color: #B8860B"&gt;$i&lt;/span&gt;]&lt;span style="color: #BB6688; font-weight: bold"&gt;}&lt;/span&gt;;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;j&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #AA22FF; font-weight: bold"&gt;$((&lt;/span&gt;i+1&lt;span style="color: #AA22FF; font-weight: bold"&gt;))&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;  &lt;/span&gt;&lt;span style="color: #666666"&gt;[[&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;$arg&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;~&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;-n&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;]]&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;{&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;pnt&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #BB6688; font-weight: bold"&gt;${&lt;/span&gt;&lt;span style="color: #B8860B"&gt;opt&lt;/span&gt;[&lt;span style="color: #B8860B"&gt;$j&lt;/span&gt;]&lt;span style="color: #BB6688; font-weight: bold"&gt;}&lt;/span&gt;;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;opt&lt;span style="color: #666666"&gt;[&lt;/span&gt;&lt;span style="color: #B8860B"&gt;$i&lt;/span&gt;&lt;span style="color: #666666"&gt;]=&lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;opt&lt;span style="color: #666666"&gt;[&lt;/span&gt;&lt;span style="color: #B8860B"&gt;$j&lt;/span&gt;&lt;span style="color: #666666"&gt;]=&lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;}&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;  &lt;/span&gt;&lt;span style="color: #666666"&gt;[[&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;$arg&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;~&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;-c&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;]]&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;{&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;col&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #BB6688; font-weight: bold"&gt;${&lt;/span&gt;&lt;span style="color: #B8860B"&gt;opt&lt;/span&gt;[&lt;span style="color: #B8860B"&gt;$j&lt;/span&gt;]&lt;span style="color: #BB6688; font-weight: bold"&gt;}&lt;/span&gt;;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;opt&lt;span style="color: #666666"&gt;[&lt;/span&gt;&lt;span style="color: #B8860B"&gt;$i&lt;/span&gt;&lt;span style="color: #666666"&gt;]=&lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;opt&lt;span style="color: #666666"&gt;[&lt;/span&gt;&lt;span style="color: #B8860B"&gt;$j&lt;/span&gt;&lt;span style="color: #666666"&gt;]=&lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;&amp;quot;&lt;/span&gt;;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;}&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #AA22FF; font-weight: bold"&gt;done&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;</p>
<p>&lt;span style="color: #666666"&gt;[[&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #AA22FF; font-weight: bold"&gt;$((&lt;/span&gt;pnt%2&lt;span style="color: #AA22FF; font-weight: bold"&gt;))&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;-eq&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;0&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;]]&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;{&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #AA22FF"&gt;echo&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;#39;&lt;/span&gt;ERROR!!!&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;Number&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;of&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;Points&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;should&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;be&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;ODD!&lt;span style="color: #BB4444"&gt;&amp;#39;&lt;/span&gt;;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;exit;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;}&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;</p>
<p>&lt;span style="color: #AA22FF; font-weight: bold"&gt;for&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;file&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;in&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB6688; font-weight: bold"&gt;${&lt;/span&gt;&lt;span style="color: #B8860B"&gt;opt&lt;/span&gt;[@]&lt;span style="color: #BB6688; font-weight: bold"&gt;}&lt;/span&gt;;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #AA22FF; font-weight: bold"&gt;do&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;  &lt;/span&gt;awk&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;-v&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;pnt&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #B8860B"&gt;$pnt&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;-v&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;col&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #B8860B"&gt;$col&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB6622; font-weight: bold"&gt;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;  &lt;/span&gt;/^&lt;span style="color: #666666"&gt;[&lt;/span&gt;&lt;span style="color: #008800; font-style: italic"&gt;#@]/&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;  &lt;/span&gt;&lt;span style="color: #008800; font-style: italic"&gt;{print;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #008800; font-style: italic"&gt;next}&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;  &lt;/span&gt;/^&lt;span style="color: #666666"&gt;[&lt;/span&gt;^#@&lt;span style="color: #666666"&gt;]&lt;/span&gt;/&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;{&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;    &lt;/span&gt;n++;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;j&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;n%pnt&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;    &lt;/span&gt;&lt;span style="color: #AA22FF; font-weight: bold"&gt;if&lt;/span&gt;&lt;span style="color: #666666"&gt;(&lt;/span&gt;n&amp;lt;pnt&lt;span style="color: #666666"&gt;)&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;{&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;      &lt;/span&gt;sma&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;+&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;$col&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;      &lt;/span&gt;&lt;span style="color: #AA22FF; font-weight: bold"&gt;if&lt;/span&gt;&lt;span style="color: #666666"&gt;(&lt;/span&gt;n&amp;lt;&lt;span style="color: #666666"&gt;(&lt;/span&gt;pnt+1&lt;span style="color: #666666"&gt;)&lt;/span&gt;/2&lt;span style="color: #666666"&gt;)&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;{&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;        &lt;/span&gt;&lt;span style="color: #AA22FF; font-weight: bold"&gt;for&lt;/span&gt;&lt;span style="color: #666666"&gt;(&lt;/span&gt;&lt;span style="color: #B8860B"&gt;i&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;1;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;i&amp;lt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;col;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;i++&lt;span style="color: #666666"&gt;)&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #AA22FF"&gt;printf&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;%12.6f&amp;quot;&lt;/span&gt;,&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;$i&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;        &lt;/span&gt;&lt;span style="color: #AA22FF"&gt;printf&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;%12.6f&amp;quot;&lt;/span&gt;,&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;sma/n&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;        &lt;/span&gt;&lt;span style="color: #AA22FF; font-weight: bold"&gt;for&lt;/span&gt;&lt;span style="color: #666666"&gt;(&lt;/span&gt;&lt;span style="color: #B8860B"&gt;i&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;col+1;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;i&amp;lt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;NF;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;i++&lt;span style="color: #666666"&gt;)&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #AA22FF"&gt;printf&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;%12.6f&amp;quot;&lt;/span&gt;,&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;$i&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;        &lt;/span&gt;print&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;      &lt;/span&gt;&lt;span style="color: #666666"&gt;}&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;    &lt;/span&gt;&lt;span style="color: #666666"&gt;}&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #AA22FF; font-weight: bold"&gt;else&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #666666"&gt;{&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;      &lt;/span&gt;sma&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;+&lt;span style="color: #666666"&gt;=&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;$col&lt;/span&gt;-f&lt;span style="color: #666666"&gt;[&lt;/span&gt;j&lt;span style="color: #666666"&gt;]&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;      &lt;/span&gt;&lt;span style="color: #B8860B"&gt;now&lt;/span&gt;&lt;span style="color: #666666"&gt;=(&lt;/span&gt;n-&lt;span style="color: #666666"&gt;(&lt;/span&gt;pnt-1&lt;span style="color: #666666"&gt;)&lt;/span&gt;/2&lt;span style="color: #666666"&gt;)&lt;/span&gt;%pnt&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;      &lt;/span&gt;split&lt;span style="color: #666666"&gt;(&lt;/span&gt;txt&lt;span style="color: #666666"&gt;[&lt;/span&gt;now&lt;span style="color: #666666"&gt;]&lt;/span&gt;,&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;dat&lt;span style="color: #666666"&gt;)&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;      &lt;/span&gt;&lt;span style="color: #AA22FF"&gt;printf&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;%12.6f&amp;quot;&lt;/span&gt;,&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;dat&lt;span style="color: #666666"&gt;[&lt;/span&gt;1&lt;span style="color: #666666"&gt;]&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;      &lt;/span&gt;&lt;span style="color: #AA22FF; font-weight: bold"&gt;for&lt;/span&gt;&lt;span style="color: #666666"&gt;(&lt;/span&gt;&lt;span style="color: #B8860B"&gt;i&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;2;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;i&amp;lt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;col;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;i++&lt;span style="color: #666666"&gt;)&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #AA22FF"&gt;printf&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;%12.6f&amp;quot;&lt;/span&gt;,&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;dat&lt;span style="color: #666666"&gt;[&lt;/span&gt;i&lt;span style="color: #666666"&gt;]&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;      &lt;/span&gt;&lt;span style="color: #AA22FF"&gt;printf&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;%12.6f&amp;quot;&lt;/span&gt;,&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;sma/pnt&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;      &lt;/span&gt;&lt;span style="color: #AA22FF; font-weight: bold"&gt;for&lt;/span&gt;&lt;span style="color: #666666"&gt;(&lt;/span&gt;&lt;span style="color: #B8860B"&gt;i&lt;/span&gt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;col+1;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;i&amp;lt;&lt;span style="color: #666666"&gt;=&lt;/span&gt;NF;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;i++&lt;span style="color: #666666"&gt;)&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #AA22FF"&gt;printf&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;%12.6f&amp;quot;&lt;/span&gt;,&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;dat&lt;span style="color: #666666"&gt;[&lt;/span&gt;i&lt;span style="color: #666666"&gt;]&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;      &lt;/span&gt;print&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;    &lt;/span&gt;&lt;span style="color: #666666"&gt;}&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;    &lt;/span&gt;f&lt;span style="color: #666666"&gt;[&lt;/span&gt;j&lt;span style="color: #666666"&gt;]=&lt;/span&gt;&lt;span style="color: #B8860B"&gt;$col&lt;/span&gt;;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;txt&lt;span style="color: #666666"&gt;[&lt;/span&gt;j&lt;span style="color: #666666"&gt;]=&lt;/span&gt;&lt;span style="color: #B8860B"&gt;$0&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;  &lt;/span&gt;&lt;span style="color: #666666"&gt;}&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #bbbbbb"&gt;  &lt;/span&gt;&lt;span style="color: #BB4444"&gt;&amp;#39;&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&lt;span style="color: #B8860B"&gt;$file&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt; &lt;/span&gt;&amp;gt;&lt;span style="color: #BB6688; font-weight: bold"&gt;${&lt;/span&gt;&lt;span style="color: #B8860B"&gt;file&lt;/span&gt;%.xvg&lt;span style="color: #BB6688; font-weight: bold"&gt;}&lt;/span&gt;~sm.xvg&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;span style="color: #AA22FF; font-weight: bold"&gt;done&lt;/span&gt;&lt;span style="color: #bbbbbb"&gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</p>
<p>&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;</p>
<p>脚本支持两个选项:</p>
<ul>
<li><p><code>-n</code>指定平滑时所用的点数, 必须是奇数. 默认为<code>-n 5</code>, 表示使用数据点及其前后两点的平均值作为平滑值. 点数越大, 平滑后曲线越光滑.</p>
</li>
<li><p><code>-c</code>指定平滑数据所在的列编号. 默认为<code>-c 2</code>, 表示平滑xvg文件的第2列数据.</p>
</li>
</ul>
<p>原始数据及其平滑后的数据会另写入<code>原文件名~sm.xvg</code>文件中. 其中第n列数据的平滑值会添加到n+1列中.</p>
<p>下图是一个简单的例子</p>
<p><img alt="" src="https://jerkwin.github.io/pic/smxvg.png"/></p>
