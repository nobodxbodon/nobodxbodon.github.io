<h2><a href="https://github.com/jerkwin/jerkwin.github.io//blob/master/_posts/2017-02-11-自动调整VMD窗口的位置和大小.md">仓库源文</a>，<a href="https://jerkwin.github.io/2017/02/11/自动调整VMD窗口的位置和大小">站点原文</a></h2>
<ul>
<li>2017-02-11 20:31:54</li>
<li>2018-10-30 16:12:18 修订脚本, 自动调整位置, 缩放</li>
<li>2019-11-04 16:45:27 更新至Windows 10, 推送到 <a href="https://jerkwin.github.io/gmxtools">https://jerkwin.github.io/gmxtools</a></li>
<li>2020-08-13 15:56:43 修订: 支持VMD命令行参数, 如 -xyz</li>
</ul>
<p>我不喜欢VMD的一点是其窗口过多(尽管也只有三个), 且窗口位置和大小需要自己调整, 使用很不方便. PyMOL在这点上做得稍好一点, 但也不足够好. VMD至少也要向PyMOL学习一下, 达到它的水平.</p>
<p>现实既然如此, 那就只能自己解决了. 利用AutoHotKey, 我们可以很容易地控制窗口的位置和大小. 所以我就写了几句简单的代码, 用来自动调整VMD窗口的大小和位置.</p>
<h2>原始版本</h2>
<p>&lt;del&gt;下载编译好的程序 [wvmd.exe](/prog/wvmd.zip). 仅适用于Win7 64位.&lt;/del&gt;</p>
<p>&lt;del&gt;双击运行`wvmd.exe`, 会在桌面的托盘区出现一个AHK的图标, 这就说明程序已经在后台运行了.&lt;/del&gt;</p>
<p>&lt;del&gt;运行VMD程序后, 会出现三个VMD窗口: 主窗口`VMD Main`, 命令窗口`vmd.exe`, 图形窗口`VMD 1.x OpenGL Display`. 将主窗口拖放到需要的位置, 按下快捷键`win+v`(即Windows徽标键和字母v), `wvmd.exe`会根据主窗口的位置和和大小自动调整另外两个窗口的位置和大小.&lt;/del&gt;</p>
<p>&lt;del&gt;另外, `wvmd.exe`还支持另一个快捷键: 在命令窗口中按下`Esc`会关闭当前的VMD程序.&lt;/del&gt;</p>
<p>&lt;del&gt;对实现有兴趣的, 可以参考下面的代码&lt;/del&gt;</p>
<h2>新版本</h2>
<p>上一个版本虽然可用, 但每次调整位置的时候需要按快捷键, 次数多了就觉得麻烦, 所以就改进了下脚本, 使得VMD的三个窗口自动吸附在一起, 位置和大小都可以自动调整, 更方便了.</p>
<ol>
<li>添加VMD目录到<code>path</code>环境变量</li>
<li>修改<code>vmd.rc</code>, 可参考<a href="https://jerkwin.github.io/2017/01/11/%E6%88%91%E4%BD%BF%E7%94%A8%E7%9A%84VMD%E5%88%9D%E5%A7%8B%E5%8C%96%E8%84%9A%E6%9C%AC/">我使用的VMD初始化脚本</a></li>
<li>启动<code>wvmd.exe</code></li>
<li>调整图形窗口位置和大小时, 其他两个窗口自动调整</li>
<li>命令窗口激活时按下<code>Esc</code>会关闭当前的VMD程序</li>
</ol>
<p>此外, 命令行中可以直接使用<code>wvmd conf.gro traj.xtc</code>来载入GROMACS轨迹.</p>
<p>对于xyz格式的轨迹, 如果文件扩展名为<code>.xyz</code>, 可以直接载入. 否则的话, 使用<code>wvmd -xyz file.traj</code>即可.</p>
<p>其他VMD可以使用的命令行参数, 直接使用即可.</p>
<p><img alt="" src="https://jerkwin.github.io/pic/wvmd.png"/></p>
<h2>评论</h2>
<ul>
<li>2017-03-09 17:00:53 <code>Neo</code> 李老师，wvmd是怎么编译出来的，下面你附的那个代码怎么用呢？</li>
<li><p>2017-03-09 20:06:40 <code>Jerkwin</code> 安装autohotkey, 然后将那段代码保存为wvmd.ahk, 就可以直接使用了. autohotkey有一个编译器, 可以将代码编译为exe.</p>
</li>
<li><p>2017-02-26 10:25:05 <code>.</code> 感谢老师！这个很方便！</p>
</li>
<li>2017-02-26 19:00:18 <code>Jerkwin</code> 有用就好.</li>
</ul>
